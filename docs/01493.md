# 使用 DeployHQ 自动化您的部署

> 原文:[https://www . site point . com/using-deploy HQ-automate-deployments/](https://www.sitepoint.com/using-deployhq-automate-deployments/)

![DeployHQ](../Images/37dc01b52fe48a46757277c6883dbe1e.png)

*本文是与 [SiteGround](https://www.siteground.com/sitepoint-recommended?afcode=97a975da3502771c04e59cbae092b1dd&campaign=deploy-hq) 合作创作的系列文章的一部分。感谢您对使 SitePoint 成为可能的合作伙伴的支持。*

## 问题:部署代码

所以你在 GitHub 中有你的项目，不管它们是什么——一个你和一个小团队一起工作的应用程序，一个小商业手册网站，一个电子商务平台。您已经决定对它们进行版本控制，但是您仍然没有适当的自动化流程，并且您仍然必须使用 FTP 手动更新您的每个环境—登台、生产等。或者你让他们从分行取出零钱。

如果您也部署到其他开发或临时服务器，或者您有一台负载平衡的生产机器需要多个同时部署，这种痛苦只会增加。这里您真正需要的是一个自动化的过程，既可以在代码发生变化时自动部署，也可以在按下按钮时准备好这样做。

## 解决方案:部署总部

[DeployHQ](https://www.deployhq.com/) 可以连接您的 Git 存储库和您的服务器，并为您进行部署。您可以使这些部署自动化(每次您提交到您的`staging`分支时，DeployHQ 会自动将这些更改部署到您的临时服务器上)。您还可以手动触发部署(从`production`分支部署到生产服务器需要您自己按下按钮)。这种灵活性允许最大限度的方便和自动化，而不会取消重要的保护措施，如合并到生产中的代码审查，或更新生产网站的时间表。

DeployHQ 似乎特别适合小型公司或开发人员，他们没有将所有的测试、构建、CI 等自动化到内聚的过程中，并且确实在寻找一种方法将代码以尽可能少的摩擦推向各种环境。

## 部署入门 HQ

当您注册您的 DeployHQ 帐户时，您将登录并到达欢迎屏幕。

![](../Images/0f1736d03d9708485751752a1de93c3d.png)

然后，您需要遵循一些步骤来启动和运行您的部署！

### 1.准备

在下面的配置示例中，GitHub 将被用作版本控制系统。所以，去 GitHub 吧，如果你脑子里还没有一个项目，那就创建一个资源库。理想情况下，存储库将有多个分支(即“暂存”、“生产”)，只是为了帮助演示 DeployHQ 中可用的功能。测试存储库的试运行和生产分支都将在这个演示中使用。你可以把它放在一个标签里，因为你需要回来。

### 2.创建新的 DeployHQ 项目

从欢迎屏幕上，点击“创建一个新项目”按钮。

![](../Images/ad40b5075cb47311a52491978776f488.png)

您需要为项目命名，并选择您正在使用的版本控制系统。对于这个例子，我们使用 GitHub。然后，点击“创建项目”！您将看到一个进度屏幕，然后，如果一切顺利，您将看到一个屏幕，要求您登录(或者如果已经登录，授权应用程序)以访问您的存储库。

一旦您授权 DeployHQ 访问您的 GitHub，您将被带到一个屏幕，显示您所连接的组织(以及您的个人存储库)以及这些存储库的列表。选择一个链接到您的项目，一旦完成，DeployHQ 将要求您提供服务器信息。

### 3.添加服务器

要添加服务器，您需要给它一个内部名称，然后选择您想要用来访问服务器的协议，比如`SSH/SFTP`。

![](../Images/99d0df2b773784db9525d0bcd8a3932b.png)

一旦你做出了选择，更多的选项将会打开，你可以填写关于你的网站托管的信息，如服务器的 IP 和证书，从 FTP 根目录到你的网站文件的路径等细节。

如果您在 DeployHQ 上有足够多的活动服务器需要对它们进行分组，您将能够为该服务器选择一个组。您还需要选择项目链接到的存储库的哪一个分支，以便从那里进行部署。选择`staging`意味着当代码被提交到 GitHub 中的`staging`分支时，DeployHQ 将会选择并使用它进行部署。

### 4.部署

现在您已经添加了您的服务器，单击 edit 按钮在 DeployHQ 中编辑服务器。您将在这里看到您已经为服务器选择的设置，以及其他一些设置，尤其是在右边栏。

#### 手动部署

可能有些东西你不希望*完全*自动部署。例如，您的生产分支可能需要在您将其投入使用之前接受审查或进行最终的测试运行，或者您可能必须按照计划这样做。没问题。只需在右侧的设置菜单中关闭此服务器的自动部署。

![](../Images/b171de9aeeae848c12ba27c5cff380eb.png)

然后，在将一些代码推送到适当的 GitHub 分支后，您将能够压缩到您的 DeployHQ 项目，并且只需单击一两下就可以手动部署它！

这个试验场开始时什么都没有。在用 starter `index.html`初始化 GitHub，然后点击 DeployHQ 上的“deploy”之后，我们得到了:

![](../Images/84b142f6d07d502544aa269e34fde77b.png)

#### 自动部署

另一方面，您可能希望您的登台环境在您在 GitHub 中做出更改后立即自动将更改推送到服务器。看一下服务器编辑屏幕，在右边面板。您将看到“自动部署”选项—打开它。您还需要复制它下面的 URL。在同一个区域，您将看到 DeployHQ [有关于自动部署的文档](https://support.deployhq.com/articles/deployments/how-do-i-start-an-automatic-deployment-from-github)，如果您遇到任何困难，可以提供帮助。

现在，回到你的 GitHub 库，进入库的设置和 Webhooks。添加一个新的 Webhook，选择 URL 编码类型，使用从您的 DeployHQ 服务器设置中复制的 URL 作为 URL，并保存它。这意味着每次提交被推送到存储库时，GitHub 都会向 DeployHQ 发送一个有效载荷。反过来，DeployHQ 将检查它是否是正确的分支，如果是，就排队并执行部署，因为您已经打开了自动部署。

太棒了。让我们试一试。回到 GitHub，更新你的`index.html`文件(或者一个不同的文件，如果需要的话)。提交更改，然后看看你的网站。

![](../Images/1913bed0070c700507127fbff311001a.png)

DeployHQ 已经自动将它推出，您甚至不需要做任何事情。很棒的东西！

## 结论

DeployHQ 绝对不是那些拥有超越该应用程序的复杂需求的大型组织的选择。但是对于很多很多的 web 开发者来说，像 DeployHQ 这样的服务将会节省时间和精力。为它们搭配一台提供适当 SSH 或 SFTP 连接能力的出色主机，如我们的合作伙伴 [SiteGround](https://www.siteground.com/sitepoint-recommended?afcode=97a975da3502771c04e59cbae092b1dd&campaign=deploy-hq) ，您就可以开始部署了！

## 分享这篇文章