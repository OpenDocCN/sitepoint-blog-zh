# 基于游戏的网络架构

> 原文:[https://www . site point . com/improving-percepted-performance-based-on-gaming/](https://www.sitepoint.com/improving-perceived-performance-based-on-gaming/)

![950850_27101514](../Images/42f562a313f148162be8383ed7ba6e48.png)网络架构到底是什么，在 web app 开发中代表了什么？为什么现在要讨论网络架构？

这些可能是你在读完这篇文章的标题后的一些问题，这正好支持了我将在这篇文章中解释的观点。

## 网络体系结构

### 这是什么？

有很多不同的解释，但我在维基百科上找到了一个符合要求的解释:

> 网络架构是通信网络的设计。它是一个框架，用于规范网络的物理组件及其**功能组织和配置**，其**操作原则和程序**，以及在其操作中使用的数据格式。

这小小的一句话里包含了很多信息，但是让我惊讶的一个细节是**设计**这个词。它让我想起了规划、美丽和功能。这不仅仅是关于套接字连接，也是关于以聪明的方式处理那些连接。

### 为什么要说呢？

我将用一个常见的例子来说明这一点。问你一个问题:哪条线更长？

![Lines question](../Images/efdaee9acab3ac5a0a6c2bfb104a620b.png "Lines Question")

我们都知道，尽管有任何相反的观察，正确的答案是两者长度相同。然而，这次我改变了规则，实际上，队伍变长了。我们如此习惯于给出相同的答案，以至于忽略了我们的直觉，而这正是最近网络架构领域正在发生的事情。

很简单:世界运转的方式发生了变化。在过去的 5 年里，有人改变了我们与设备和应用程序的联系方式。然而，没有人提到我们——作为开发人员——应该如何适应新的范例，所以我们只是继续“给出相同的答案”。

### 有什么变化？

网络变了吗？不，它更快，但它并没有真正改变。如果我们想要构建更好更快的应用程序，我们可能需要用不同的方式来处理它。我相信这能够并且将会在未来几年内给技术市场带来巨大的变化。

如果不是网络，是什么变化如此之快，以至于我们跟不上？社会价值观。

社会经常在改变它的价值观。如果有什么东西变得真正珍贵，那就是**时间**。时间已经成为每个人最重要的资源，现在时间实际上就是金钱，没有人想再浪费它了。

开发者应该能够响应全世界所有用户的新需求。我们应该专注于构建实时应用程序，或者至少是不会让用户浪费时间的应用程序。我们的任务应该是将加载时间减少到零！

#### 瓶颈

可惜，事情没这么简单。总会有一个瓶颈，这次是网络。如果我们甚至不知道我们的应用在 Edge、3G、4G 甚至常规有线连接上的表现，我们怎么能构建更快、更实时的应用呢？

## 游戏在哪里？

如果说有一个市场一直在关注实时和响应性应用，尽管存在网络限制，那就是游戏市场。自 90 年代慢速拨号连接时代以来，我们一直在开发在线游戏。他们是如何做到的？通过问自己一个简单的问题:**如果速度很重要，为什么我们一直只依赖网络的原始速度？**

这种心态的结果很容易想象。下面你可以看到普通网络应用程序流程和大型多人在线角色扮演游戏(MMORPG)流程的区别:

![Web Flow](../Images/36f16165c159575fec009b0dfd9c4a2f.png "Web Flow")

在通常的流程中，当应用程序和服务器处理我们的请求并更新接口时，有些操作会导致等待时间。但是当我们谈论网络多人游戏时，我们不能有等待时间。动作不能停下来加载下一个，因为每个人都必须从不同的角度分享相同的现实。因此，流程将更像这样:

![MMORPG Flow](../Images/7c8480f863c8046378e1678ef591fe70.png "Games Flow")

这种流动是可能的，因为我们根本不是在谈论速度，我们是在谈论感知的速度。这是一种欺骗，因为用户并不关心后台到底发生了什么。

游戏中有很多技术都遵循这个概念。我们可以也应该将它们应用到我们的 web 开发过程中。我们将介绍四种简单的技术，它们可以极大地改变您构建应用程序的习惯。

## 神奇四侠技巧

### 在客户端渲染

这种技术对于那些喜欢前沿技术的人来说是众所周知的。有许多 javascript 框架和库声称是“有史以来最好的模板解决方案”,市场上有这么多选项，没有理由不找到符合您需求的东西。它肯定会对您的应用程序性能和用户体验产生巨大的影响。一切都将在开始时加载，界面将能够自我更新。

即使这种技术非常普遍，仍然有很多人避免使用这种技术。他们中的大多数认为这些库不支持市场上所有的设备和浏览器，所以他们不使用它。没有任何意义。

让我们来比较一下浏览器和电视。想象一下，我们有不同类型的电视，有些是高质量的，拥有所有这些令人敬畏的技术，旁边还有你祖母 90 年代的电视，每一台都代表一个浏览器，我分不清哪一台*咳嗽*:

![Television comparison](../Images/11b99bca11a48edff0faa09054d54fee.png "Television comparison")

有一个单一的信号被发送到所有的电视，不管它支持什么，每一个都将呈现最好的图像。这被称为**优雅的退化**，结果大概是这样的:

当开发人员因为缺乏浏览器支持而决定不使用客户端渲染技术时，这将是预期的结果:

![Television wrong](../Images/2a463a5e5d2a142ffef5e3feafba1aac.png "Television wrong")

不要害怕为那些可能使用它的人提供最好的质量。优雅的退化是一个简单的概念，可以改变很多事情。

### 将数据存储在客户端

发出更少的请求可以让你的应用程序运行得更快，但是有时候我们没有意识到把一些数据存储在客户端而不是发送到服务器是多么简单。它不仅会为您节省一些基础设施资源，还会帮助您避免数据库中的无用数据。

几年前，很难考虑在客户端存储数据，我们所有的是 cookies 和会话，它不够安全和宽敞，没有用。有了 HTML5，我们有了 [LocalStorage](http://www.w3schools.com/html/html5_webstorage.asp) ，大量的空间，以及一个惊人的 API，让一切变得更容易。为什么**在提出远程请求之前不开始三思而后行**？

### 智能预载

更好描述智能预载的词是**预测**。通常，当我们谈论预测时，开发人员会感到害怕。他们开始考虑机器学习和庞大的公式，但预测可能非常容易。**你的用户接下来会采取的行动是你应该提供的。**

让我举一个例子来说明这一点。这是 Instagram 应用程序的基本流程:

![Instagram flow](../Images/7ce1b0b2f21a3160e8500c478d7af305.png "Instagram flow")

人们认为他们的图像是在按下“发送”按钮时上传的，但实际上，您的图像是在红色虚线表示的过渡处开始上传的。

该应用程序假设，一旦您选择了照片，缩放并应用了图片上的滤镜，最期望的下一个操作将是共享它。不难预测，对吧？没有神奇的公式。应用程序将开始上传您的图像，一旦您按下“发送”按钮，感觉速度会更快。**不是因为快，而是因为看起来快。**

如果你开始使用逻辑构建智能应用程序，并通过预测用户行为来预加载资产，这将对用户感知产生巨大的影响。

### 异步性

这是一个每个人都在使用的术语，但只有少数人关注其背后的真正提议。
**目标是从服务器上分离视图**。服务器只有在界面请求时才会响应，界面会自我更新，不会让用户等待响应。

一个基本的例子就是 iOS 上的 Gmail 界面。要删除一封邮件，你所要做的就是选择它，然后按“删除”。邮件会自动神奇地消失，从界面上消失。然而，它还没有被删除，请求也没有通过网络发送。这将在后台发生。重点是电子邮件是不可见的，用户也不会盯着一个微调按钮或进度条。他可以继续使用您的应用程序，确信该电子邮件已被删除。

### 但是，如果服务器出现故障怎么办？

这不是问题，机器会出故障。
只要让用户知道发生了这件事，并请他稍后再试，**我保证你的用户不会因为被告知一个不方便的事情而生气**。但是，如果您让他盯着一个加载栏看几分钟，同时您的界面被锁定等待服务器响应，他会的。

## 我们开始吧！

耶！让我们开始吧，让我们构建令人敬畏的零加载时间应用程序，但是请记住，没有什么灵丹妙药。这些技术不是所有问题的解决方案，只是游戏中使用的好技术的集合。

它们代表了我们 web 应用程序开发过程的一系列新的可能性，帮助我们遵循用户的需求。**别忘了，我们的任务是将加载时间降至零！**。

这篇文章基于我最近的一次演讲，我有机会在一月份在法国里尔举行的起飞会议上发表了这篇演讲。这很有趣，如果你想笑一点，你可以在 YouTube 上看。

## 分享这篇文章