# 如何使用服务人员跨浏览器选项卡进行交流

> 原文:[https://www . site point . com/how-to-use-a-service-worker-to-communication-cross-browser-tabs/](https://www.sitepoint.com/how-to-use-a-service-worker-to-communicate-across-browser-tabs/)

**这篇采访转载自 [Versioning](https://versioning.substack.com/membership#about) ，这是 SitePoint 的每日订阅时事通讯，通过提供前端、后端、设计和 UX、新闻、商业等内容的精选链接，帮助开发人员了解最新信息。[了解更多信息并在此报名](https://versioning.substack.com/membership#about)。**

[![Sign up to Versioning](../Images/8f417e4772d8b2dab04d6a19ebdba6e2.png)T2】](https://versioning.substack.com/membership#about)

![Tim Evko](../Images/dd478f01c5fa72dee4b5748805556ad4.png)

Tim Evko 是一名前端开发人员，主要管理 React 代码库，是 ExecThread 的团队领导，该公司致力于向专业人士提供工作机会。不在 ExecThread 的时候，他会在当地的健身房度过剩下的时间，努力成为一名更好的竞技交叉训练运动员。

### 目前哪个科技创意或趋势最让你兴奋？

最近我迷上了**服务工作者技术**，尤其是当它被用来帮助网站快速加载和快速交互时。我喜欢性能和 web-app-offline 功能，我认为社区可以从构建弹性、多功能和快速的应用程序中受益。

和服务人员一起工作特别有趣，因为你可以和他们一起做很多事情。我最近了解到，您可以使用服务人员在浏览器中跨选项卡进行通信，如果缓存过时，允许每个单独的选项卡重新加载自己。这不是一项容易使用的技术，但是我很高兴它的出现！

### 我想我以前没听说过这个，你能说得更详细些吗？

在浏览器中，服务人员可以控制可用范围内的所有客户端，而不仅仅是当前活动的选项卡。这意味着当服务人员在您的浏览器中与站点通信时，它仍将与当前显示该站点的所有选项卡通信。当使用 Service Worker 附带的 postMessage API 时，您可以利用这个特性。[这里可以找到一个详细的例子](http://craig-russell.co.uk/2016/01/29/service-worker-messaging.html#.WupTUOjwZEY)。在 ExecThread，我们使用该功能来重新加载所有选项卡，以防服务人员将旧的 CSS 文件提供给带有新标记的页面。

### 描述(或链接到！)你最近建造、设计或生产的很酷的东西。你为什么以此为荣？

我最近开始了解虚拟 DOM 算法是如何工作的，并在此过程中构建了我自己的组件 render-er: BadDom [github]。它有 600 字节，你可以用它来构建你的整个网络应用。我很自豪，因为它有 600 字节，你可以用它来构建你的整个网络应用。

BadDOM 实际上非常简单，这就是我喜欢它的原因。如果您给它一个节点(例如页面上的一个 div)和一个 ES6 模板字符串，它将更新第一个 div，使它与模板字符串匹配。本质上，它是一个 DOM diffing 函数，确保它的目标看起来像模板字符串。

然而，因为它是一个 ES6 模板字符串，所以您可以在差异中添加逻辑。这意味着无论何时更新您的逻辑所基于的状态，您都可以调用 diffing 函数，并且您的原始 DOM 目标将与新状态相匹配。整个过程是通过用模板字符串创建一个不可见的元素，并比较目标元素(及其子元素)来查找、删除或修改所有 DOM 节点，直到基于模板字符串的元素和目标元素看起来相同。

它很有效，因为它从不更新不需要更新的元素，从而避免浏览器做不必要的工作。如果你有 100 个嵌套元素，而其中一个只有一个类名改变，BadDom 会找到这个元素并只改变这个类。

### 你是如何建造它的？

像我的大多数项目一样，我在 CodePen 上构建了这个。我喜欢关注用尽可能少的构建工具/设置让事情尽可能简单。这样，无论使用什么平台或设备，任何人都很容易理解并做出贡献。CodePen 很棒，因为我不需要设置 IDE 来处理前端库。我可以整天谈论 CodePen，它是一个社区，以及我从其他人那里学到了多少，但我只想说每个人都应该自己看看。

我喜欢使用模块模式编写所有的 JavaScript，我在这里就是这样做的。模块模式是一种编写 JavaScript 的方式，这样所有代码都在一个自包含的对象中。对象内部的方法存储为函数属性，配置值可以存储为对象属性。我喜欢使用这种模式，因为它很容易组织代码(尤其是库)。你可以在这里找到更多关于这个模式的信息。

### 你最近读过的最好的科技作品是什么，为什么？

Jeremy Keith 的《弹性网页设计》(Resilient Web Design)–Jeremy 是一位优秀的作者，这本书是按照书中规定的代码编写的。

### 你最近给朋友发的最搞笑或有趣的跑题链接是什么？

在美国东海岸，不知何故仍然是冬天。前几天我给我妻子发了这个:

![The is fine meme, but with snow](../Images/cfa5b0ad57295d96c64960a60dbe8077.png)

这确实很好！这是本周的面试，感谢 Tim 分享了他最感兴趣的技术。

[![](../Images/f33abb8607769823228e69f0470933b9.png)T2】](https://versioning.substack.com/membership#about)

## 分享这篇文章