# 使用 Magento 和 Git 进行版本控制

> 原文:[https://www.sitepoint.com/version-control-magento-git/](https://www.sitepoint.com/version-control-magento-git/)

本文是与 SiteGround 合作创作的系列文章的一部分。感谢您对使 SitePoint 成为可能的合作伙伴的支持。

许多开发人员可能希望在开发 Magento 站点时使用版本控制，并在维护和添加到 live 网站时继续这样做。在这里，我们将重点关注 Git 作为版本控制系统的选择。本文并不是一步一步的指导，而是一组在使用 Magento 和 Git 时要考虑的技巧和事情。

## 为什么要使用 Magento 和 Git 呢？

Magento 是世界上最受欢迎和创新的电子商务平台之一。Magento 拥有庞大的客户群和无数开发人员在其中构建应用程序，并对其进行扩展和主题化，是电子商务网站的绝佳选择。

Git 同样是当时领先的版本控制系统。Git 托管可以去很多地方，比如 [GitHub](https://github.com) 或者 [BitBucket](https://bitbucket.org) ，([Git 和 BitBucket 有什么区别？如果你想让大多数开发人员熟悉 Git，Git 是最容易使用的 VCS，因为它无处不在，用于各种项目，从单页私人网站到大规模生产应用。](https://www.sitepoint.com/premium/screencasts/what-are-the-differences-between-bitbucket-and-github)

为什么要用 Git 对 Magento 站点进行版本控制？这个问题也很容易回答。当创建或更改像主题或其他定制代码这样的东西时，您将希望确保这些更改不仅被保存，而且您还保留了轻松回滚更改的能力。您可能希望其他开发人员能够克隆您的工作设置并添加特性或修复，或者轻松地将您的站点代码部署到另一个测试或登台服务器。Git 可以帮助解决所有这些问题。

## 决定存储库中包含的内容

首先要做的决定之一是在存储库中到底包括什么。这将在很大程度上取决于您的用例。

### 首先，决定你的方法

首先，你必须决定你的方法。Git 存储库是干什么用的？您希望存储整个网站吗？如果是这样的话，你必须记下你不希望存储在存储库中的项目。如果您有一个小团队，并且发现只下载一个包含您的(几乎)整个站点的大型 Git 存储库比在一个新环境中设置 Magento，然后只从 Git 存储库中下载一些资产更容易，那么这可能是有用的。

另一方面，也许您的团队已经建立了大量的构建工具，并且能够毫无困难地将相同版本的 Magento 和其他软件部署到任何环境中，并且您真的只想对正在开发的特定文件进行版本控制。

了解您的方法将决定您与 Magento 的其他 Git 决策。

### 考虑数据库和配置文件

一些 Git 团队将数据库转储到 Git 存储库中的文件，这样当创建一个新环境时，一旦存储库被关闭，您就有了一个相对较新的生产数据库副本，用于设置新的开发或测试环境。

其他团队可能会对此犹豫不决。这可能取决于您的情况，也许更重要的是，取决于您的团队和项目的安全性。如果项目是开源的，或者对你自己公司的大部分开放，你可能不希望包含数据库文件的副本，因为这是非常不安全的。由三个开发者共享在一个私有存储库上，对于一个仍在开发中而非生产中的初创应用来说，这可能正是你想要的。然而，如果您不将数据库转储放入您的存储库中，您*将*需要创建一个共享数据库文件的过程，以便创建开发和测试所需的克隆环境。

配置文件的处理方式大致相同。通常，如果您有任何安全顾虑，您会希望将`magento/app/etc/local.xml`排除在您的存储库之外，因为其中存储了凭证。

### 如何处理图像

对于大型 Magento 安装来说,`/media`文件夹会变得相当大。当它的内容少于一定数量时，可能在开发或早期阶段，将它包含进来以在其他环境中测试图像内容可能是有意义的。当它开始变得太大时，忽略整个东西可能更有意义，然后可能使用一个假的映像集用于测试环境。

### 设置您的。gitignore

一旦决定了在 Git 存储库中需要什么，在开始使用 Git 之前的下一步将是拿出您的`.gitignore`文件内容(当推送或从您的项目存储库拉出时，Git 将忽略这些项目)。这个`.gitignore`文件位于存储库的根目录，并指示 Git 忽略文件。它可能是一个相对较小的列表，如下所示，或者它可能覆盖了您的应用程序的大部分——这取决于您的版本控制策略。

```
magento/app/etc/local.xml
magento/cron.php
magento/cron.sh
magento/errors/
magento/install.php
magento/LICENSE*
magento/media 
magento/RELEASE_NOTES.txt
magento/robots.txt 
```

*注意，这不是一个完整的。gitignore 复制和粘贴，但只是一组想法——您需要根据自己项目的需要，决定在列表中删除或添加其他项目。*

您可能还想看看您的`.htaccess`的内容——如果它们是您的环境所特有的，那么可能需要忽略。您可能还想忽略部分或全部`var`——缓存、错误等。可能不需要提交源代码控制。

## Git 安全性

您需要确保并考虑您的 Git 存储库的安全性。谁有权访问存储库，他们有读写权限吗？当用户改变角色或离开您的项目时，您会更改或撤销权限吗？这个项目是开源的还是私有的？它有可能成为开源吗？这些都是您第一次建立存储库时需要考虑的问题。

## 分支结构和环境

另一件在开始时要考虑的事情是你的分支结构。许多项目都有类似于以下的内容:

```
- Development
- Staging
- Production 
```

但是你当然可以根据自己的需要来定制分支。你可以有临时的分支，比如主题开发或定制特性，然后在完成时将它们合并到开发管道中。策略由您决定，但是重要的部分是计划并执行它，而不是陷入将所有事情都提交到您的存储库中的`master`分支的陷阱。分支是您使用 Git 的部分原因！

## 部署策略

最后，您可能还需要考虑您的部署策略。您打算在生产服务器上使用 Git 进行部署吗？当您的 Git 存储库更新时，您会使用外部服务，比如 [DeployHQ](https://www.sitepoint.com/using-deployhq-automate-deployments/) 来通过 FTP 进行部署吗？还是手动进行部署？
SiteGround 提供了一个 Git 集成，对于使用其主机的开发者来说非常方便。

## 结论

通过仔细的规划和设置，Magento 和 Git 可以携手合作，为您提供更好、更安全的站点和更高效的开发策略。走出去，用 Magento 和 Git 构建令人敬畏的电子商务平台，并保持它们的安全性和高效性！

## 分享这篇文章