# 你考虑过多语言标记吗？

> 原文:[https://www . site point . com/have-you-considered-polyglot-markup/](https://www.sitepoint.com/have-you-considered-polyglot-markup/)

如今，许多 web 开发人员已经从 XHTML 转向 HTML5。但是您知道 web 文档可以同时基于 HTML 和 XML 吗？这就是所谓的多语言标记:HTML 文档可以正确地作为文本/html 或类似 XML MIME 类型的 application/xml 或 application/xhtml+xml。就像一个通晓多种语言的人一样，一个通晓多种语言的文档“说”HTML 和 XML。

但是，请注意，我们的目标是同时符合 HTML5 和 XML 的格式良好性；多语言文档不一定是有效的 XHTML。

## 通晓多种语言的限制

创建多语言文档会强制实施更多的约束和结构，因为它们必须符合 XML 格式良好的规则。例如，HTML 元素名和属性名通常必须是小写的，并且所有元素必须有一个结束标记或使用最小化的标记语法(如`<br/>`)。诀窍是确保文档被解析成相同的文档树(尽管有一些例外)，无论它是由 HTML 解析器处理还是由 XML 解析器处理。

通过这样做，您的文档几乎肯定会有更好的结构和更高的质量，但仍然能够被视为 HTML5。另一个好处是它们可以被 XML 工具处理。此外，如果您需要一个页面的 HTML 和 XHTML 版本，那么您就不需要维护两个不同的内容副本(这几乎总是一个坏主意)。对于多语言文档，您可以在需要时将其作为 HTML 或 XHTML 提供，而无需更改文档中的任何内容。

回到相同的 DOM(文档对象模型)的概念，记住这是至关重要的，因为浏览器不直接呈现 HTML。相反，他们从文档源创建一个 DOM 并呈现它。此外，它是由 CSS 和 JavaScript 操纵的 DOM。如果创建了不同的 DOM，那么文档的呈现可能会不同，特别是如果使用 CSS 或 JavaScript 导致不同的 DOM 发生不一致的变化。因此，许多准则都是为了确保维护相同的 DOM，而不管解析多语言文档的解析器是什么。

## W3C 推荐标准

W3C 有一个名为 [Polyglot Markup: HTML 兼容的 XHTML 文档](https://www.w3.org/TR/html-polyglot/ "Polyglot markeup")的工作草案，它详细描述了 Polyglot 文档的设计指南。我在下面总结了一些指导方针。要了解更多细节，您可以查看 W3C 文档，该文档实际上并不太长，也不太难阅读。总结如下:

*   不要使用`document.write()`或 `document.writeln()`，因为它们可能不会在 XML 中使用。请改用`innerHTML`属性。
*   不要使用`noscript`元素，因为它不能在 XML 文档中使用。
*   不要使用 XML 处理指令或 XML 声明。
*   使用 UTF-8 编码，并以 W3C 文档中列出的方式之一声明它。我推荐用`<meta charset="UTF-8"/>`。
*   使用可接受的文档类型，如`<!DOCTYPE html>`。不要对 HTML4 或以前版本的 HTML 使用 DOCTYPE 声明。
*   为了保持 XML 兼容性，显式声明“html”、“math”和“svg”元素的默认名称空间，如`<html >`。
*   如果在 XLink 名称空间中使用任何属性，那么在`html`元素上声明名称空间，或者在使用它的外部元素上声明一次名称空间。
*   每个多语言文档必须至少有这些元素(不能遗漏):`html`、`head`、`title`和`body`。
*   每个`tr`元素必须显式地包装在`tbody`、`thead`或`tfoot`元素中，以保持 HTML 和 XML DOMs 的一致性。
*   一个`table`元素中的每一个`col`元素都必须显式包装在一个`colgroup`元素中。同样，这是为了保持 HTML 和 XML DOMs 的一致性。
*   使用正确的元素名称大小写。HTML 和 MathML 元素名称只能使用小写字母，尽管有些 SVG 元素只能使用小写字母，有些必须混合使用大小写。
*   使用正确的属性名称大小写。HTML 和 MathML 属性名只能使用小写字母，definitionURL 除外。有些 SVG 属性名必须只使用小写，有些必须混合使用大小写。
*   维护属性值的大小写一致性。一种简单的方法是只使用小写字母，但这不是必需的。
*   只有某些元素可以是无效的。这些元素必须使用最小化的标记语法，如`<br/&gt`；(不允许有结束标签)。这些空元素包括:`area`、`br`、`embed`、`hr`、`img`、`input`、`link`和`meta`。
*   如果 HTTP Content-Language 头只指定了一个语言标签，那么使用`html`元素上的`lang`和`xml:lang`属性来指定语言。
*   不要以换行符开始`textarea`或`pre`元素中的文本。
*   所有属性值必须用单引号或双引号括起来。
*   不要在属性值中使用换行符。
*   不要使用`xml:space`或`xml:base`属性，除非是在 MathML 和 SVG 这样的外来内容中。这些属性在作为文本/html 的文档中无效。
*   指定语言时，同时使用`lang`和`xml:lang`属性。不要只使用一个属性而不使用另一个属性，并且两个属性必须具有相同的值。
*   仅使用以下命名实体引用。对于其他情况，使用十进制或十六进制值，而不是命名实体。
*   始终对小于号和&号使用字符引用，除非在 CDATA 节中使用。
*   只要有可能(尽管不是必需的)，`script`和`style`元素应该链接到外部文件，而不是内联包含它们(即使对于非多语言文档，这也是一个好建议)。但是，当使用内联内容时，它应该是“安全的内容”，不包含任何有问题的小于号或与号字符(由于创建了不同的 DOM，所以不能对它们进行转义)。我还建议将内联脚本内容包装在 CDATA 节中，并注释掉 CDATA 标记(使用`//<![CDATA[`作为脚本前的第一行，使用`//]]>`作为最后一行，使用“//”注释掉 CDATA 标记)。但是同样，您可以通过使用外部文件而不是内联内容来避免这些问题。

由于上面的许多准则，强烈建议使用支持多种语言的检查器。当然，您已经验证了当前的 HTML 和/或 XHTML 文档，对吗？如果没有，那么我建议你立即开始这样做，因为拥有高质量的 HTML 有很多好处。对于多语言检查器，您可以在即将发布的 CSE HTML Validator(Windows)v 12 版本中尝试新的多语言检查。下载并安装[免费公测版](http://www.htmlvalidator.com/freebeta/ "Validator")，在验证器引擎选项的 DOCTYPE 控件选项页将“验证 HTML 文档为”选项设置为 Polyglot。在 2013 年 1 月 31 日之前，您可以免费使用全功能公测版。

如果你的文档已经是 XHTML 格式的，那么把它们转换成多语言应该很容易。转换 HTML 文档可能需要更多的工作，但是您可能会发现，与 HTML5 允许的草率相比，额外的结构和质量要求是一股新鲜空气。结构更好的文档也更容易阅读和维护，更不容易被浏览你的网站的浏览器和搜索引擎曲解。

## 分享这篇文章