# 实用代码重构，第 2 部分——可读性

> 原文:[https://www.sitepoint.com/practical-code-refactoring-2/](https://www.sitepoint.com/practical-code-refactoring-2/)

在本系列的第一部分中，我介绍了什么是好的代码。随着关于代码重构的系列文章的继续，我们将深入到这三个方面中的每一个，并按顺序看看如何重构它们:可读性、可扩展性和效率。在这一部分中，重点是重构代码以获得更好的可读性。

回想一下可读性的定义:可读代码遵循一些众所周知的风格和文档实践。为了帮助您开始重构代码的可读性，我准备了一个问题列表，您应该在开发、测试和评审过程中问自己这些问题。

## 一般

**1。代码是否遵循风格、语法和文档的标准指南？**

你应该使用一种编码标准，最好是像 PSR-1/2 这样的公共标准。对于任何没有在标准中定义并且您在代码中强制执行的常见实践，为您自己和您的团队写一个简短的注释。

**2。你是在使用标准的结构语法，还是一个陌生的语法？**

在 PHP 中，你可能有几种风格来编写不同的结构(比如 PHP 控制结构的可选语法)。如果您正在使用外来语法，例如只在 HTML 模板中使用替代语法，而在标准代码中使用 C 风格的语法，请记录下来以避免歧义。更好的是，只坚持一种风格。我更喜欢在我所有的项目中使用 C 风格的语法，避免使用陌生的语法。

**3。每个文件都有记录其在项目中角色的标题注释吗？**

至少，您应该在每个代码文件中包含一个包含以下内容的头注释:

*   应用程序名称、版本和简要描述。
*   与其他文件的文件关系，以及它属于哪个包/组(如果有)。

**4。全局代码是否保持在最低限度？**

全局代码适用于快速脚本和单文件解决方案，但是当您构建复杂的 web 应用程序时，全局代码可能会成为您最头疼的问题。尽可能保持在最低限度。

如果全局代码包含函数和类定义之外的块，比如控制结构，那么您也应该将代码重构为函数或类。一般来说，不要在全局代码中包含控制结构。

## 命名

**1。做你的类，变量等的名字。在你的代码中遵循一个标准的模式/风格？**

变量、常量、函数、方法、类和名称空间都应该遵循整个代码库的统一命名风格，并且很可能是您正在使用的通用编码标准的一部分，否则您需要强制执行它。

**2。名字是否有意义且不含糊？**

变量、函数等的名字。应该是有意义的。不要创造像`$abc`这样的名字，而要使用像`$count`、`getFile()`这样好听又容易理解的名字。一个例外是具有众所周知行为的变量，比如循环中的计数器变量`$i` / `$j` / `$k`。

**3。名字太长还是太短？**

变量名和常量的平均长度应该在 8-12 个字符左右。有些异常可能会达到 25 个字符，但超过这个长度就不可读而且很麻烦，所以如果你有任何非常长(或非常短)的异常，那么你应该重新考虑它的用法。思考用法有助于创造更好的名字。

方法/函数的名称平均长度应该在 15-25 个字符左右，尽管有些例外情况可能会达到 30 个字符。和变量名一样，你应该重新考虑更长/更短的名字。

类名要尽量短，用名词表示。如果你遵循一个编码标准，那么就遵循它的类约定，否则你的类名应该在 10-15 个字符左右。

## 公式

**1。表情是否遵循标准的模式/风格？**

如何编写表达式和格式化表达式对于代码的可读性至关重要。有些人喜欢在运算符前后加一个空格，比如`$counter = 15;`，而有些人则根本不加空格。无论你选择哪一个，在你所有的代码中保持一致。

**2。是表达方式容易理解，还是太复杂了？**

对于太复杂/太长的表达式，将表达式拆分成多行。一般来说，如果你的表达式包含三个或更多不同的操作数，为了将来理解它，你应该为它写一个注释。当然，在更新表达式时更新注释也很重要。不要错过那个！:)

## 代码块

**1。代码块遵循标准的模式/风格吗？**

代码块是代码库的基本构建块。在写一行之前，你应该检查每一行应该是什么样子，并坚持这样做，因为人眼对样式比对内容本身更敏感。坚持你的标准，在哪里放括号，空格等。当应用常规规则时，你的眼睛会更快地通读这些结构，你会更容易理解它。

**2。块的长度平均超过 20-25 行吗？**

如果你的代码块超过 30 行，我建议至少重构一次，尽管你可能需要不止一次的重构来获得更好的代码。一些异常可能达到 50 行或更多，但它们仍然是异常，不应该成为习惯。较长的代码可读性较差；小代码块比大代码块可读性更强，更易维护。

**3。代码块是否被很好地注释以解释它们添加了什么功能？**

在完美的代码中，每个代码块都应该用文字说明它在代码中实现了什么。请将此作为一条规则，但是我们都知道生活并不完美，所以您可能只需要对比平均值长(超过 20-25 行)或者执行复杂任务的代码块这样做。这取决于你的感觉，但是我自己更喜欢在任何块向未来的读者介绍它的意图之前添加一行注释，除非它很琐碎。

## 摘要

现在，您可以开始重构代码，将本文作为一个检查清单作为起点，使代码更具可读性。就可读性而言，您的代码没有理由不总是处于健康的状态。我甚至建议你把这些问题和你的源代码一起放在一个电子表格中，并根据它安排重构任务，或者只要你觉得你的代码不健康就使用它。

在接下来的部分中，我们将关注重构的可扩展性和效率。敬请期待！

<small>图片 via[Fotolia](http://us.fotolia.com/?utm_source=sitepoint&utm_medium=website_link&utm=campaign=sitepoint "Royalty Free Stock Photos at Fotolia.com")T3】</small>

## 分享这篇文章