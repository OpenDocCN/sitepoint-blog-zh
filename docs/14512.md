# 用 Excel 设计 PHP 应用程序

> 原文:[https://www.sitepoint.com/php-apps-excel-worksheet-server/](https://www.sitepoint.com/php-apps-excel-worksheet-server/)

有时，有人用 PHP 做了一些真正独特的事情——这些事情远远超出了列在 [Hotscripts](http://www.hotscripts.com/PHP/index.html) 上的 PHP 应用程序的标准，让你对这种语言的能力留下了深刻的印象。

一个主要的例子是 Jedox 的[工作表服务器](http://www.jedox.com)，这是一个真正独特的微软 Excel 和 PHP 的结合，使用户能够建立“在线电子表格”。

我第一次听说 Worksheet Server 是在去年 12 月，当时我对这个想法非常着迷，所以我不得不去 Jedox(离家几个小时的路程)了解更多信息。从那以后，我一直在业余时间摆弄 Worksheet Server 的评估版，试图确定它作为构建 Web 应用程序的工具的重要性。

如果你读过[用 PHP 和 PEAR](https://www.sitepoint.com/pear-spreadsheet-excel-writer/) 生成电子表格，你会知道我不反对在 PHP 中使用 Excel，因为它比普通的 HTML 表格更适合显示数据。工作表服务器的工作方向与*相反，起点是一个 Excel 电子表格，最终结果是一个有效的 PHP Web 应用程序。*

这是一个 PHP 开发人员眼中的工作表服务器的技术回顾。

***今日练习册上:***

*   工作表服务器简介:工作表什么？
*   第一印象:作为一个天真的 Excel 用户的想法
*   PHP 开发人员的观点:生成代码和扩展
*   SUM(A1:A3):结论

##### 工作表服务器简介

Worksheet Server 的基本目的是使 Excel 用户能够使用他们已经确信的环境来构建 Web 应用程序。作为一名 Web 开发人员，最好将工作表服务器看作是一个用于构建专门 PHP 应用程序的*设计工具*，这个工具恰好是 Excel。

Worksheet Server 由两个不同的软件包组成:一个 Web 平台(Apache、PHP 和以易于安装的形式捆绑的 Worksheet Server 代码)和一组 Excel 本身的插件，以帮助您设计和发布应用程序。为了避免混淆，我将后半部分称为“WS Excel 设计器”。

##### 工作表服务器生命周期

理解 Worksheet Server 功能的最简单方法是考虑用它构建和部署的应用程序的“生命周期”。

***第一步:设计***

应用程序的设计从 Excel 电子表格开始，99%的工作与创建一个普通的电子表格没有什么不同。

特殊的 WS Excel Designer 宏可用于执行向应用程序添加超链接和图像等任务，以便它们在 Web 环境中正确显示为 HTML。此外，工作表服务器函数也是可用的，比如 MYSQLDATA 函数，它用 MySQL 查询的结果填充一个单元格。这些函数的使用就像普通的 Excel 函数一样，但是只有在 Web 服务器上运行时，它们才具有*的含义。*

***第二步:构建***

设计者对电子表格很满意，使用另一个 WS Excel Designer 宏为工作表服务器 Web 环境“构建”应用程序。

在实践中，会生成一个 ZIP 文件，其中包含 Worksheet Server 需要了解的关于应用程序的所有内容。

***第三步:发布***

在工作表服务器(Web 服务器)中，管理员发布应用程序。他们首先登录“应用程序中心”(一个管理多个工作表服务器应用程序的 PHP 应用程序)，上传 ZIP 文件，“编译”它(一个为应用程序生成 PHP 脚本的过程)，然后启动应用程序(应用程序在 Web 服务器上的一个唯一 URL 上可用)。

***第四步:安检***

管理员使用从应用程序中心获得的 URL 登录到新的应用程序。他们为最终用户创建登录帐户，授予他们访问应用程序的权限。

***第五步:动手！*T3】**

最终用户现在可以登录(通过 Web)并开始使用该应用程序。他们不再处理同一个电子表格的单独的本地副本；相反，他们通过动态 Web 应用程序进行协作。这在很大程度上与原始电子表格相同，但允许它们并发工作(更改会立即反映出来)，并可以将它们与各种其他远程数据源(数据库、Web 服务等)连接起来。

***步骤 X:重新设计***

如果需要对应用程序的设计进行更改，则上述循环会重新开始，只是不需要设置用户帐户。设计者继续他们停止的工作，使用他们保存的。xls 文件(或他们从工作表服务器下载的最新副本)，然后重新发布应用程序。

工作表服务器充当*主动*代码生成器(而不是被动代码生成器——参见[这篇文章](https://www.sitepoint.com/forums/showpost.php?p=1010198&postcount=21)关于主动与被动代码生成的思考)。运行在 Web 服务器上的代码并不意味着被直接修改(尽管您有机会编写“外部”PHP 代码与之交互)。因此，Worksheet Server 允许设计人员在不破坏任何东西的情况下对他们的应用程序进行增量更改。

这有望使工作表服务器实际上是什么变得清晰。当然，看到最终结果会更有帮助——最好的地方是 Jedox 的[在线演示](http://www.jedox.com/show.php?index=content/Demos.03)(注意，应用程序和用于创建它的 Excel 文件都是可用的)。

##### 第一印象

手里拿着 Worksheet Server 的评估版和手册，我试用了一下，安装了它，并按照引导您构建基本应用程序的介绍性教程进行了操作。该手册本身是直截了当的，没有浪费时间用无关的信息让读者超载。它专注于尽快开始真正的工作。我希望更多的技术文档是这样写的。

##### 建立

安装工作表服务器是一个两阶段的过程。

第一步涉及 Web 环境的安装。您可以在 Linux 和 Windows 上运行服务器(不需要特定于 Windows 的扩展，尽管 Excel 是设计工具)。我选择了 Windows，忽略了另一个分区上的 Linux，因为我认为在同一个系统上使用 Excel 可以节省在两个分区之间启动的时间。

安装只需要运行安装程序，并观察它如何设置 Apache、PHP 和工作表服务器软件；几乎不需要用户干预，也没有会难倒非技术人员的尴尬问题。

由于习惯了手工设置 PHP/Apache，我有点怀疑安装完成后仔细检查会发现什么。我很快松了一口气，不仅发现了最新的稳定版本(例如 PHP 4.3.6)，还发现了一个合理的 PHP 配置(例如 register_globals 被关闭，error_reporting 被设置为 E_ALL)。杰多克斯似乎知道他们在做什么。

所有标准的 Windows PHP 扩展都可以和 Jedox 内部开发的附加扩展一起使用。运行 Worksheet Server 应用程序需要一个许可文件(只需将其复制到正确的位置)，一旦完成，我就可以立即登录到在线“应用程序中心”。

第二步是安装 WS Excel Designer，这需要一个额外的许可证文件才能正常工作。文件准备就绪后，最快的方法就是启动 Excel，然后打开一个。Jedox 提供的 xla 文件，它在会话期间添加了一个额外的菜单，包含 WS Excel Designer 工具。更聪明的方法是使用 Excel 加载项管理器永久附加新菜单。请注意，Excel 2000 是最低要求。

总的来说，安装非常容易，并且很明显适合那些对成为系统管理员不感兴趣的用户。

##### 即时应用

按照入门教程，我对使用 WS Excel Designer 的简单性印象深刻。任何有 Excel 使用经验的人只需几分钟就能掌握 WS Excel Designer 扩展。通常，构建工作表服务器应用程序的过程与普通电子表格的过程没有什么不同，添加的功能不会干扰电子表格创建的正常“流程”。需要一些经验来理解电子表格最终部署到网上后的样子，但这更像是一个微调的问题。

我的电子表格设计就绪后，使用 WS Excel Designer 宏保存电子表格，然后切换到 Web 浏览器上传它就很简单了。

“应用程序中心”运行在 Web 服务器上，用于上传和部署应用程序，它有一个简单但干净的界面，使用起来通常很直观。需要多读一点手册来确定不同按钮和菜单的确切作用，但我从未发现自己不知所措，只需点击几下，就可以编译并运行应用程序。

转到发布的 URL，我首先通过一个管理员帐户登录，并创建了一个新用户来访问应用程序。用新帐户重新登录，我看到了我的电子表格，现在作为一个 PHP Web 应用程序运行。

我对这么短的时间就走到这一步印象深刻。

##### 外观和感觉

Excel 中的可视化设计过程直接转化为生成的 Web 应用程序。换句话说，给定 Excel 工作表的单元格结构、单元格之间的公式和关系(甚至跨多个工作表)、字体大小和颜色都将显示在 Web 服务器上。

假设您使用 Excel 图表向导或 WS Excel Designer 提供的一些特殊功能，Worksheet Server 甚至允许您将图表添加到电子表格中进行发布。在线图表是在 [JpGraph](http://www.aditus.nu/jpgraph/) 的帮助下呈现的。

注意，需要考虑一些“怪癖”，记住 Excel 作为一个演示工具，并不直接映射到“HTML + Web 浏览器”。Jedox 建议将默认字体设置为 Arial，这种字体在各种浏览器和操作系统中都得到广泛支持，并鼓励您将字体大小保持在特定范围内，以防止出现奇怪的结果。他们还建议您将工作表保持在合理的页面大小(水平和垂直)，以符合 Web 浏览器的人体工程学，并使应用程序易于导航(谁喜欢密集滚动？).

当您编译应用程序时，提供了不同的“皮肤”,以允许您对外观和感觉进行一般的更改(主要影响出现在顶部和底部的面板)。

一般来说，网络版是我在 Excel 中工作的一个相当不错的副本。如果您将每个原始 Excel 文件[在线](http://www.jedox.com/show.php?index=content/Demos.03)(链接到每个演示旁边)与其演示进行比较，您可以看到原始设计如何匹配最终结果。

##### 航行

顶层导航由添加到显示器顶部和底部的面板提供。它们提供了对常规工作表服务器功能的访问。根据应用程序和环境的不同，顶部面板还提供更多功能，例如下载 Excel 格式的电子表格、将应用程序中的所有数据导出为 XML 文档或将工作表呈现为可打印的 PDF。

电子表格中可修改的单元格显示为表单输入文本字段，并使用 JavaScript 控制输入键之间的光标，使单元格导航类似于 Excel。

包含多个工作表的电子表格可通过下拉菜单或在 Excel 中构建特殊的菜单表来导航。你可以通过比较[概要演示](https://www.worksheetserver.com/kd212135213/outline/run.html)和[巴塞尔 II 驾驶舱演示](https://www.worksheetserver.com/kd212135213/basel%20ii%20cockpit/run.html)来看出区别。

我想 Excel 用户在这种环境下应该会相当开心。

##### 查看源代码

对 Firefox 和 Internet Explorer 显示的比较表明，它们非常接近(没有明显的可访问性问题)。

浏览一下源 HTML 就会发现很多表格，这可能不会让所有人都满意，但这个*毕竟是*表格数据。分散的大写标签名称表明可能需要进行一些清理，并且 style 属性在许多标签中使用。

这确实意味着你需要通过 Excel 修改结构，而不是应用聪明的 CSS 技巧，但是，正如我之前提到的，工作表服务器是一个活跃的代码生成器；你不应该直接修改最终结果。

##### 限制

在构建工作表服务器应用程序时，并非所有的 Excel 功能都可以使用，这些限制在工作表服务器手册中有明确的说明。

例如，从 Excel 的“控件”工具栏中，只能使用“列表框”、“下拉”和“复选框”控件，而嵌入的图像将被忽略(尽管可以使用图表向导或特殊函数添加图表)。

不支持 Excel 工具，如“目标查找”和“场景”；Visual Basic 宏是另一个禁忌。初看起来，缺乏对 Visual Basic 的支持似乎是一个阻碍。实际上，当您需要完成一些不寻常的事情时，Worksheet Server 用 PHP 支持的真正的多用户环境代替了 VB。请记住，Worksheet Server 是一个应用程序设计工具，而不是一些盲目地将电子表格导出为 HTML 的 Excel 插件。Jedox 建议您用一个新的电子表格开始每个应用程序，并鼓励您以交付 Web 应用程序为特定目标来规划其设计。

对于使用它的人来说，唯一的另一个重要限制是不支持矩阵函数。

否则，您可以嵌入到 Excel 电子表格中的所有内置函数都可以通过同名的 PHP 函数直接在线支持。

##### 分层数据

对于 Excel 用户来说，Worksheet Server 的一个新特性是报表实体的概念。

Excel 被设计为单用户应用程序，它组织数据的方式实际上一次只适合一个人使用。相比之下，Worksheet Server 适用于多用户环境，为了实现这一点，它使用了一个称为报表实体的特性。这允许定义工作表树，每个工作表都从相同的源电子表格生成，同时允许对数据进行分组和聚合。

理解报表实体如何工作的最好方法是查看[大纲演示](https://www.worksheetserver.com/kd212135213/outline/run.html)。登录后，您会注意到顶部面板有一个下拉菜单，允许您将报告实体更改为“总”、“北”、“西”或“东”。“North”、“West”和“East”区域代表本演示中的销售区域，区域销售经理将使用他们各自的报告实体来输入销售数据。“总计”表是最高级别的报告实体，合并了来自每个子实体的数据。首席销售官可以看到这个视图，这样他或她就可以看到销售的全貌，并根据需要深入到每个地区。

注意所有四个报告实体是如何具有相同的设计的；所有这些都是从同一个 Excel 内置的电子表格中生成的。同时，总表左上角单元格中显示的数字表示每个子实体中相同单元格的总和。

要创建报告实体，只需在应用程序的在线管理界面中定义它们，并指定层次结构。您还可以确定哪些用户可以访问哪些实体；例如，这允许您将“北方”地区的销售经理限制在相关实体。令人印象深刻的是，一旦将报表实体定义为树，Worksheet Server 就会处理所有其他的工作，自动计算顶级实体中单元格的值，而不需要对原始设计进行任何修改。

在将工作表服务器应用程序变成强大的多用户协作工具的过程中，报告实体发挥了重要作用。

##### PHP 开发人员的观点

这让您对 Excel 用户眼中的工作表服务器有了一个概念——但是它如何与 PHP 开发相适应呢？

##### 心理奥林匹克

PHP 开发人员必须克服的第一个概念障碍在于工作表服务器应用程序中数据的表示方式。很可能当您看到一个表时，会立即想到“SQL 结果集，在一个循环中呈现”，因为很大一部分 Web 应用程序就是这样。

在典型的工作表服务器应用程序中，HTML 表格单元格是 Excel 电子表格的一种表示。每个单元格通常要么是“原始数据”，即由用户硬编码、输入或从数据库中单独提取的值，要么是“复合数据”，即应用于“原始数据”单元格的公式的结果。

在后台，Worksheet Server 将单元格中包含的数据以序列化形式存储到文件系统中。它管理文件锁定以防止多个用户同时更新相同的值，并在每次页面刷新时从这里获取最新的数据。

开发人员需要的第二个思维跳跃包括理解您正在处理生成的代码；您不应该直接修改工作表服务器应用程序。相反，您需要使用服务器提供的已定义的“扩展点”工作表，我稍后将对此进行讨论。

##### 从 Excel 调用 PHP 函数

对于简单的应用程序，可能根本不需要您作为 PHP 开发人员的参与。WS Excel Designer 为 Excel 用户提供了许多功能，他们甚至可以连接到数据库，执行查询，并使用 Worksheet Server 提供的 Excel 特殊函数将部分结果嵌入单元格中。

例如，要将从 MySQL 数据库获取的单个用户名插入 Excel 中的单元格*，可以使用以下函数，这些函数都是由工作表服务器提供的。*

在电子表格的单元格 A1 中，您可能有以下内容:

```
MYSQLINIT('mydatabase','harryf','secret');  

Cell: A1
```

`MYSQLINIT()`函数获取数据库的连接设置，并提供一个连接资源，您可以用它来执行查询。

接下来，在单元格 A2 中，输入:

```
MYSQLEXEC(A1,"SELECT * FROM users");  

Cell: A2
```

注意，第一个参数“指向”单元格 A1，这里使用了 MYSQLINIT(也是创建 MySQL 连接的地方)。第二个参数是查询本身。

最后，例如，在单元格 D15 中，您输入:

```
MYSQLDATA(A2,15,2)  

Cell: D15
```

这里，A2 指向执行查询的单元格，“15”指查询结果集中的行号，“2”指该行中的列号。

使用 Excel 的设计人员无法使用此查询获取的数据。只有在线发布应用程序后，它才可用。Excel 函数被自动转换成 PHP 函数，使得引用的数据可供用户使用。

当然，它并不仅限于 MySQL——Worksheet Server 为 ODBC 访问数据库提供了类似的功能，使用 Jedox 团队自己开发的 PHP 扩展提供了 [OLAP](http://en.wikipedia.org/wiki/OLAP) 功能，以及非常酷的 SOAP 支持，它看起来非常像上面的 MySQL 示例，但使用 WSDL URL 进行初始化。Jedox 还提供了绘图和图形功能，弥补了使用 Excel 的原生功能时的局限性。所有这些对于使用 Excel 的设计人员来说都是可用的，不需要在 PHP 中做额外的工作。

##### 失业了？

你可能会问，“如果设计师可以用工作表服务器做这么多事情，那我还能做什么？”事实上，在基本的应用程序中，默认的工作表服务器功能就足够了，PHP 开发人员几乎不需要参与其中。

但是当然，软件开发从来没有那么容易。总有人会提出一个独特的需求，或者有一些重要的数据需要从一些不支持的来源中检索，此时 PHP 知识是一个重要的需求。此外，如果 PHP 已经是前景的一部分，为什么不将工作表服务器应用程序与现有的应用程序集成呢？输入 PHP 开发人员…

Worksheet Server 为扩展其功能和与其他 PHP 应用程序对话提供的机制既简单又强大。没有必要开始处理生成的代码。

##### 拥抱和延伸

Worksheet Server 与其它 Web 应用程序之间最基本的通信形式是通过超链接功能，该功能提供了使用 URL 中的 GET 变量向“外部”传递变量的常见可能性。这可能不太令人兴奋，但它将解决许多简单的问题，例如能够链接回用于填充特定单元格的远程数据源的 Web 接口。

下一个机制是，在利用文件时，工作表服务器将尝试自动包含它们，如果它能找到它们的话。

在响应页面请求的过程中，Worksheet Server 会查找脚本`before_recalc.inc`和`after_recalc.inc` —它们分别包含在为当前请求重新计算单元格内容之前和之后(假设您已经创建了它们)。这两个文件中生成的输出将在显示工作表的 HTML 之前显示*，但这并不是它们真正的预期目的；相反，它们允许您在重新计算发生之前设置环境，然后响应计算，也许更新依赖于结果的数据库。*

工作表服务器试图包含的另一个脚本是`userfunc.inc`，它是定义(或包含)您自己的 PHP 函数的地方。这些将根据 Excel 电子表格本身的内容被调用，或者从`before_recalc.inc`和`after_recalc.inc`脚本中调用。

值得注意的是，工作表服务器应用程序使工作表中的所有单元格都可以作为全局 PHP 变量使用，其名称类似于`$S1_B2`(指的是工作表 1，单元格 B 2)。“全局”和“变量”这两个词可能会敲响警钟，所以在定义同名的变量时要小心。也就是说，你多久会给一个变量命名一次`$S1_B2`？还要记住 register_globals 是关闭的。在全局范围内定位变量使得添加自己的工作表服务器功能变得容易。一旦一些 Excel 用户开始使用 Worksheet Server，出于需要或兴趣，他们可能会开始探索 PHP。

##### 自定义功能

一个说明这一点的例子可以使用工作表服务器定义的特殊 Excel 函数`SHOWBUTTON()`来实现。这需要三个参数:一个值和一个名称(对应于 HTML 输入标记属性 name 和 value)以及一个标题，当鼠标移动到按钮上时显示这个标题。它还生成一个表单按钮，供用户在应用程序中单击。假设我将函数放在 Excel 工作表的一个单元格中，如下所示:

```
SHOWBUTTON("Stock Check","doStockCheck","Tell Warehouse to Check Stock")
```

一旦我完成了这些，我就可以检查应用程序的用户是否点击了按钮，如下使用`after_recalc.inc`:

```
<?php  

if ( isset($_POST['doStockCheck']) ) {  

    // Call my own PHP function, defined in userfunc.inc  

    doStockCheck();  

}
```

现在，在`userfunc.inc`中，我可以这样定义`doStockCheck()`函数:

```
<?php  

function doStockCheck() {  

    // Include our own DB library  

    require_once 'lib/db/db_conn_manager.php';  

    // Fetch values from the global cell values  

    $productName = mysql_escape_string( $GLOBALS['S1_D6'] );  

    $requiredQuantity = mysql_escape_string( $GLOBALS['S1_D7'] );  

    // Build a query  

    $sql = "INSERT INTO stock_required  

                (name,quantity)  

            VALUES ('$productName','$requiredQuantity');";  

    // Insert the data  

    DBC::execute($sql);  

}
```

在这里，您可以看到如何使用全局单元格变量。变量是在生成的 PHP 脚本中定义和初始化的，包括单元格之间的关系(使用工作表服务器在 PHP 中实现的 Excel 函数)。

您在`userfunc.inc`脚本中实现的函数也可以通过在 Excel 表中命名来直接“调用”。换句话说，设计人员可以在处理电子表格时识别出您在单元格中实现的 PHP 函数名，并且每次重新计算单元格的值时，它都会在 Web 服务器上执行。

因此，您可以将工作表服务器应用程序视为一个巨大的“组件”，并使用您定义的函数来调用您的“框架”的其余部分中的代码，例如，使用您的日志记录库来跟踪工作表服务器用户(请注意，工作表服务器已经有了一个本机日志记录机制，但是您可能需要将其与您现有的基础结构集成)。

##### 应对变化

当我考虑代码生成工具时，我通常关心的一个问题是，我的“附加”逻辑在生成的代码发生变化时会有多好。

如前所述，Worksheet Server 是一个*活动的*代码生成器(您不应该在 generates 中直接使用 PHP)。问题是:你添加的函数能经受住生成代码的变化吗？

我的*猜测*是，在大多数情况下，不需要修改你添加的代码，只要对原始电子表格的改动很小。

当然，如果设计者改变了他们放在电子表格中的一个函数调用的名称，就需要修改它的 PHP 实现(但希望能提前计划好)。

否则，唯一可能产生重大影响的变化是移动单元格的位置，这样访问给定单元格的代码将不再指向正确的位置。一旦初始结构就绪，用户很少会移动 Excel 电子表格中的单元格，所以这种问题应该不多见。在最坏的情况下，一个简单的解决方法是定义一个有效命名的 PHP 常量来标识一个单元格，允许它被快速修改以反映单元格位置的变化。

##### 访问控制

作为其内部访问控制机制的替代方案，Worksheet Server 支持使用 LDAP 进行身份验证。这应该非常适合大中型组织中的现有基础设施。

要将 Worksheet Server 应用程序从其内置的访问控制系统切换到 LDAP 服务器，只需定义一个脚本`ldap.inc`，它包含函数`GetLDAPUsergroups()`，为 Worksheet Server 提供一个可用组的列表，以及`CheckLDAPAccount()`，后者接受用户名和密码，并应返回一个指示用户是否有效的值。还提供了一个附加的(可选的)电子表格功能；`LDAPDATA()`允许您向工作表服务器传递有关用户的更多信息，如电子邮件地址和电话号码。

当然，不是每个人都使用 LDAP，如果您在现有网站上放置工作表服务器应用程序，很可能您已经实现了自己的安全机制。好消息是，工作表服务器实际上并不知道在`CheckLDAPAccount()`内部使用的安全数据源，实际上*是否是一个 LDAP 服务器*。相反，例如，您可以实现代码来根据 MySQL 中的表检查用户。

##### 形成码

当一个应用程序在在线“应用中心”编译时，它会创建一个目录结构，将生成的 PHP 源代码与 HTML 模板、日志文件、序列化数据文件、用户帐户数据库和运行应用程序所需的其他所有东西放在这个目录结构中。

工作表服务器为 PHP 源代码定义了自己的文件扩展名，避免了。php '扩展，并根据它们的功能组织脚本。例如，一个。xcc '文件包含定义单元格之间关系的单元格计算。的一个片段。快速演示应用程序的“xcc”文件如下所示:

```
<?PHP  

$S2_C7 = $S2_C6+$S2_C5;  

$S2_D7 = $S2_D6+$S2_D5;  

$S2_E7 = $S2_E6+$S2_E5;  

$S2_F7 = $S2_F6+$S2_F5;  

$S2_G5 = SUMxl(ARRAY(1,4,$S2_C5,$S2_D5,$S2_E5,$S2_F5));  

$S2_G6 = SUMxl(ARRAY(1,4,$S2_C6,$S2_D6,$S2_E6,$S2_F6));  

// ...
```

您可以看到全局单元格变量再次被使用，一条类似于`$S2_C7 = $S2_C6+$S2_C5;`的线表示单元格 C7 是单元格 C6 和 C5 的总和，而`$S2_G5 = SUMxl(ARRAY(1,4,$S2_C5,$S2_D5,$S2_E5,$S2_F5));`相当于将 Excel 函数`=SUM(C5:G5)`放在工作表的单元格 G5 中。

其他文件扩展名，如。xlr '和'。xic’分别包含应用程序范围 PHP 配置设置和表单发布时执行的代码。

当然，您不需要担心这些，因为这些都是生成的代码，但是看看工作表服务器是如何设计的是很有趣的。除了这些文件之外，您还可以创建上面讨论过的`before_recalc.inc`、`after_recalc.inc`、`userfunc.inc`和`ldap.inc`脚本，工作表服务器会自动查找这些脚本，如果找到它们，就会执行。

驱动工作表服务器的 PHP 源代码是用 Zend 的编码器加密的；毕竟，这是一种商业产品。虽然我这个 PHP 黑客发现看不到幕后发生的事情有点沮丧，但我可以想象这有迫使开发人员使用工作表服务器提供的“接口”的好处，而不是受到“只是一些小变化”的诱惑。

##### 总和(A1:A3)

工作表服务器背后的基本思想——使用 Excel 作为 Web 应用程序的设计工具——非常巧妙。这是开发人员边喝咖啡边讨论的那种事情:“如果……不是很酷吗？”。在 Jedox 的例子中，不同之处在于那些开发人员实际上已经去做了。

尽管接触 Worksheet Server 的时间相对较短，但我得到的印象是一个成熟的软件产品(我使用的版本是 2.1.x)。我没有遇到任何严重的错误或头痛；我尝试的一切都如预期般有效。从 Jedox 添加到最近版本中的特性类型来看，该团队已经建立了一个坚实的代码基础，现在可以处理用户提出的“最好拥有”的建议。

给我印象最深的是使用这个产品可以多快地构建强大的应用程序。假设您有使用 Excel 的经验，设计过程只是电子表格创建的一个扩展。使用 PHP 向已发布的应用程序添加功能也很简单— [所有的 PHP 函数](http://www.php.net/manual/en/funcref.php)都由您支配。

Worksheet Server 显然是在深入了解 Excel 以及人们如何使用它的基础上开发的。没有“神秘的功能”，我得到的感觉是一个真实的人会使用的应用程序。

另外，让我感到惊讶的一件事是 PHP 与 Excel 用户的期望有多契合，以及它在 Excel 中使用时与 Visual Basic 有多相似。我可以想象高级 Excel 用户在扩展工作表服务器时会发现 PHP 是一个渐进的步骤(而不是巨大的飞跃)。

同样让我震惊的是 Jedox 是如何在一堆开源软件(Apache、PHP、PHP 库等)上构建其产品的。)来交付一个光滑的成品，它可以被视为一个整体，而不是松散的部分集合。更重要的是，Worksheet Server 结合了 Excel 和 PHP 的强大功能，提供了两者的优势。这种组合本身就使 Worksheet Server 成为一个独特的应用程序，并为商业软件开发的未来市场提供了一个有趣的案例研究。

当然，Worksheet Server 是一个商业产品，从[的定价](http://www.jedox.com/show.php?index=content/Products.02/Pricing.03/_local.01)来看，很明显这个软件包不是为家庭用户设计的。有些人，在开源的更激进的一端，可能会争论使用开源作为商业产品基础的根本“错误”,但是我们这些喜欢吃饭和有屋顶的人，意识到钱必须来自某个地方。Worksheet Server 为构建它的开源软件增加了重要的价值，平滑了粗糙的边缘，并为最终用户提供了高度完善的产品。显然，投资必须有回报；没有它，像工作表服务器这样的软件永远不会出现。

Worksheet Server 对于 PHP 开发人员来说也是一个好消息，因为它将我们最喜爱的平台带给了可能不知道它存在的用户，并且有可能在 PHP 尚未产生影响的行业创造新的就业机会。

最终，Worksheet Server 将 Excel 带到了 Web 上。它将单用户电子表格变成了一个动态应用程序，可以完全访问“企业”(数据库、Web 服务等)。).员工依赖 Excel 作为报告和操作数据的工具的公司花费大量时间和精力来管理协作，努力合并来自同一工作表的多个副本的数据，并苦于如何从各种公司数据源获取最新信息。Worksheet Server 解决了所有这些问题，利用 Web 为公司 Excel 用户带来了巨大的优势，并且(据我所知)是同类产品中唯一的产品。

## 分享这篇文章