# PHP 中的约束理论

> 原文:[https://www.sitepoint.com/theory-constraints-php/](https://www.sitepoint.com/theory-constraints-php/)

“PHP 中的约束理论”这篇文章是 PHP 频道 7 月 11 日时事通讯的社论。为了保持对 PHP 新闻、帖子和相关链接的了解，请确保在这里了解最新的[。](https://www.sitepoint.com/php/)

* * *

我一直在读《凤凰计划》( Phoenix Project )( T1 ),一本很棒的关于 IT 的小说(你没看错),它以一种让凡人理解 21 世纪技术的复杂性和混乱的方式，展示了一家类似亚马逊的大型公司的日常 IT 和开发问题。

在不透露任何剧透的情况下，书中有一处提到了约束理论。根据维基百科:

> 约束理论(TOC)是一种管理范式，它认为任何可管理的系统在实现更多目标时都会受到很少约束的限制。总有至少一个约束，TOC 使用一个聚焦过程来识别约束，并围绕它重组组织的其余部分。

约束理论可以提炼为这样一个观点，即**链的强度取决于其最弱的一环**。

![Chain with weak link](../Images/d2e3a40578579f3ee3523d8e9ae21337.png)

在书中，它是这样措辞的:

> 除了瓶颈之外，任何地方的改进都是幻想。

出于某种原因，这比连锁习语更能引起我的共鸣。对我来说，*建造一些无效的东西*比*破坏一些建造薄弱的东西*更有关联。

## 工厂和浏览器

正如(最初)在书中介绍的那样，在这里稍微简化一下，一个工厂车间的一张桌子上堆满了工作订单，工厂的其他区域工作得还算令人满意。如果不致力于优化这一个工作台的吞吐量，并通过(无论是巧合还是有意)升级其之前或取代它的流程，工厂就会被工作堵塞，因为前者导致一堆产品*在*工作台之前没有目的地，而后者导致工厂另一端的工人无所事事，等待产品到达他们那里进行装运，但都停留在中央工作台的缓慢处理中。

![Pile of paperwork on desk](../Images/fbeb828d28864a87a97e88d6c6c245cb.png)

稍微跑题一下——如果你在 Twitter 上关注我，你会知道我喜欢对浏览器大吼大叫。当他们更新了像[OSX 本地通知](https://twitter.com/bitfalls/status/877245695920664576)这样的内容，却没有解决十年之久的内存使用问题时，我特别失落。有些人很快就把这说成是“T4 呼吁更糟糕的问题”谬论，但我不同意。虽然，是的，这是对一个更糟糕问题的呼吁，但我不认为这是谬论——相反，我认为这是谷歌方面缺乏明确的约束。作为一家公司，他们[似乎完全不知道](https://medium.com/incoherent-brainfarts/cheering-on-the-end-of-the-world-a8c25da5ca0)什么需要优化，或者缺乏资源来解决这个问题(不知道哪个更糟)。因此，我们在瓶颈之外进行了所有这些“改进”，让高级用户抓狂，导致试图通过在浏览器上贴上另一层皮肤来修复浏览器(Vivaldi、Brave、Opera、Ghost……)，但无法取得进展，因为瓶颈仍然存在。如果你把桌子和整个工厂从一栋楼搬到另一栋楼，桌子仍然是个问题。修理书桌。

## PHP 中的约束理论

那么，这如何应用于 web 应用程序呢？或者更好的是，特别是 PHP 应用程序？

如今，遵循这一原则并找出制约因素真的很容易。我们有如此多令人惊奇的工具可供使用，以至于在几个小时内找出瓶颈通常是理所当然的:

*   [Blackfire](https://www.sitepoint.com/an-in-depth-walkthrough-of-supercharging-apps-with-blackfire/) 将为您提供应用程序执行堆栈的精彩深度图，轻松指出代码瓶颈。如果在您正在分析的代码堆栈中执行，这也将包括数据库瓶颈，从而使整个事情更加容易优化。

*   没有多少人知道这一点，但是 Xdebug [有相同的带有时间分析](https://www.sitepoint.com/getting-know-love-xdebug/)的执行堆栈图，允许您在本地做同样的事情！

*   有一组[有价值的 QA 工具](https://www.sitepoint.com/8-must-have-php-quality-assurance-tools/)可以帮助你测试你的应用程序——超长的测试时间通常表明存在瓶颈，当它们在模拟数据和测试示例上运行时，精确定位它们会有令人难以置信的回报。

*   虽然有点老套，但是一旦你发现 MySQL 是一个瓶颈，这组帖子可以帮助你优化它..

    *   [优化 MySQL 配置](https://www.sitepoint.com/optimizing-mysql-configuration/)
    *   [优化 MySQL 索引](https://www.sitepoint.com/optimizing-mysql-indexes/)
    *   [优化 MySQL 瓶颈](https://www.sitepoint.com/optimizing-mysql-bottlenecks/)

    *但是请记住，仅仅为了优化而优化**并不是一个好主意！*

**   如果你用请求轰炸你的应用程序，并比较之前/之后的结果，这将有所帮助——这将是一个清晰的指标，表明你的优化从整体上提升了应用程序。像围攻这样的工具可以对此有所帮助，我们有一个针对这一点的[深度指南](https://www.sitepoint.com/web-app-performance-testing-siege-plan-test-learn/)。* 

 *上面的工具是一个很好的开始，但是远没有穷尽，也远没有适用于您可能遇到的每一个问题。来自这个 [Premium PHP 选集的关于更好的 PHP 开发](https://www.sitepoint.com/premium/books/better-php-development/?aref=bskvorc)的额外文章可能是有用的，但是我真诚地希望你提供更多不同的例子和链接！开枪！

## 结论

ToC 在软件开发中是一个有效的关注点，就像在其他地方一样适用。我们都遇到过瓶颈，我们都愚蠢地试图改善除了瓶颈之外的任何东西，或者如果你还没有陷入这个陷阱，我保证你会的。

幸运的是，PHP 生态系统已经成熟，有工具可以帮助识别瓶颈并将其转化为系统约束。如果您的应用程序有性能或吞吐量问题，找到瓶颈，标记它，然后放弃所有其他工作，直到瓶颈得到解决。把关键的人从其他任务中拉出来，即使这意味着忽略即将到来的不相关的高优先级任务，让每个合格的人专注于那个问题，直到它被解决。整个系统都会为此感谢你，因为通常情况下，一个瓶颈首先就是其他高优先级票证的原因。不要把自己逼入绝境！(要理解这个参考，你需要阅读这本书)

如果你是单飞，同样的原则也适用——当你在 Trello、Zenkit、Freedcamp 或其他项目管理工具中查看你的任务列时，找出瓶颈，将其涂成红色，并将所有其他任务移到屏幕外的列中，或者移到可以折叠的列中，直到约束被解决，系统围绕它重新建模。如果做得不够，将会招致堆积如山的技术债务，这些债务会在以后埋没你。

你如何找到你的瓶颈？你是围绕已识别的约束来改造系统，还是改造约束并尝试突破它？在上面的列表中，我错过了哪些工具/教程？请在评论中告诉我-让我们一起建立一个全面的列表-并记住:*“改善日常工作甚至比做日常工作更重要*”！(书中的另一句名言)* 

## *分享这篇文章*