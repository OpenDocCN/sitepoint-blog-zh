# 为 iOS 8 准备好您的应用

> 原文：<https://www.sitepoint.com/getting-app-ready-ios-8/>

今年 iOS 8 的发布，以及在 [WWDC](https://developer.apple.com/wwdc/) 和[9 月 9 日活动](http://www.apple.com/live/2014-sept-event/)上的新设备标志着新功能和变化的到来，iOS 开发者应该利用这些新功能和变化来保持其应用的相关性，并为用户提供更丰富的体验。

相比其他平台，苹果用户总是能够[快速适应](http://wallstcheatsheet.com/technology/apple/chitika-apple-users-quick-to-adopt-ios-7-1-update.html/?a=viewall)新版操作系统[。](http://appleinsider.com/articles/13/12/31/ios-7-now-installed-on-78-of-active-apple-handheld-devices)[苹果网站](https://developer.apple.com/support/appstore/)显示 92%的设备运行 iOS 7。有了这么高的采用率，你可以放心，在 9 月 17 日发布后不久，你的大部分应用程序用户都将使用最新版本的操作系统。因此，你应该利用它提供的新功能来构建更好的应用程序，让它们在竞争中占据优势。

iPhone 6 和 iPhone 6 Plus 给开发者带来了另一个需要考虑的因素:又一个屏幕尺寸(事实上是两个)。

iPhone 5 的发布带来了类似的变化，开发者必须考虑到这一点。由于屏幕更大，开发人员不得不设计能在以前的 3.5 英寸和新的 4.0 英寸屏幕上工作的应用程序。发布后不久，苹果开始青睐符合新屏幕尺寸的应用程序。不更新你的应用是一个缺点，因为这意味着失去在应用商店的曝光率。

发布几个月后，[苹果停止接受不支持新屏幕尺寸](http://thenextweb.com/apple/2013/03/21/after-a-year-of-warnings-apple-will-no-longer-accept-any-apps-that-use-udids-as-of-may-1st/)的应用。在 iOS 7 发布几个月后，一个类似的条件被强制执行，当时[苹果公司规定提交的新应用程序必须用 iOS 7 SDK](http://appdevelopermagazine.com/994/2014/3/4/Are-Your-iOS-Apps-iOS7-Ready?-If-Not-Listen-Up-Says-Apple,-February-Deadline-Looms/) 构建。有了这段历史，很明显升级你的应用对你是有利的，有时是必要的。如果版本变化如此剧烈，以至于旧应用无法在新设备上按预期运行，这种情况尤其如此。

但 iPhone 6 和 iPhone 6 Plus 的情况并不完全如此。随着 iPhone 5 的发布，为较小的 3.5 英寸屏幕设计的应用程序在较大的 4.0 英寸屏幕上无法正常工作，因此更新势在必行。但由于今年的新手机及其 4.7 英寸和 5.5 英寸的屏幕，开发者不需要更新他们的应用程序就可以在新手机上使用。正如苹果公司的菲尔·席勒在活动中所说，商店中尚未更新以适应新的 iOS 8 技术的应用程序将在更大的屏幕上“正常工作”。他继续进一步解释这一点:

> “iOS 内置了一项桌面尺寸缩放技术，使该软件在不同尺寸的显示器上看起来很漂亮，因此文本清晰，颜色漂亮。一切正常”。

尽管你的旧应用可以在新手机上运行，苹果仍然鼓励开发者使用新技术更新和构建新的屏幕尺寸。今年 WWDC 会议的一个大主题是为适应性而建设。这不仅可以确保你的应用程序在所有支持的 iPhone 上运行良好，还可以让你用相同的代码库和故事板文件构建 iPhone 和 iPad 应用程序。

在 [WWDC 会议](https://developer.apple.com/videos/wwdc/2014/)上，iOS 8 的发布被认为是“自 App Store 发布以来最大的发布”。据说它有超过 4000 个新的开发者 API。

我们无法涵盖每一项变化，但将概述开发人员在更新或构建 iOS 8 应用程序时应该了解的最值得注意的新功能和改进。

我们还将了解 Xcode、App Store 和 iTunes Connect 的变化如何有助于改善您的工作流程，并提高应用程序开发和分发的效率。

本文简要概述了这些变化，但是在接下来的几个月中，我们将会发布一些文章，深入探讨如何使用这些新的和改进的 API。

我们将把这些变化分为四大类——UI、集成、游戏和开发、测试和发行。

## 用户界面

### 自适应 UI

UIKit 已经做了很多改变，可以创建适应不同屏幕尺寸、方向和设备的应用程序。这包括统一的故事板、自适应视图控制器、自适应演示以及自适应文本和表格。

### 通用应用的统一故事板

以前开发通用应用程序时，你会为 iPhone 和 iPad 创建单独的故事板。在 iOS 8 中，你可以在同一个故事板上工作，以不同的方向创建在 iPhone 和 iPad 上工作良好的界面。

这是通过为不同大小的类调整 UI 组件来实现的。大小类定义布局中使用的画布大小。有紧凑型和常规尺寸等级，其中任何一种都可以是水平的或垂直的。

创建项目时，Interface Builder 以任意宽度和高度的 size 类开始。您可以使用它来布局所有尺寸等级的应用程序中的常见内容。然后选择不同的类大小，并为不同的相应大小和方向设置 UI 组件和约束。

例如，横向和纵向的 iPad 在水平和垂直方向上都有一个规则的大小等级。而纵向的 iPhone 将有一个紧凑的水平尺寸等级和一个常规的垂直尺寸等级，当它在横向时，它在垂直和水平尺寸等级上都是紧凑的。

一个尺寸等级不一定映射到一个方向上的一个设备。例如，在 iPad 布局中，如果 iPad 上的空间较小，您可以在适当的时候使用 iPhone 风格的布局(即紧凑的水平尺寸类别和常规的垂直尺寸类别)查看。

有了统一的故事板，你现在可以创建一个用户界面来适应它所包含的空间。

### 自适应视图控制器

使用自适应视图控制器，您可以在 iPhone 和 iPad 的视图中使用相同的代码，而无需进行设备检查。

变化最大的一个视图控制器类是`UISplitViewController`。以前，当您为 iPhone 版本编写不同的视图控制器代码时，会在编写 iPad 版本的应用程序时使用这种方法。

在 iOS 8 中，拆分视图控制器现在在两个平台上都可用，因此您可以编写一个适用于 iPhone 和 iPad 的视图控制器层次结构。在 iPad 和 iPhone 横向模式下，拆分视图控制器将呈现并排的两列视图，而在 iPhone 纵向模式下，它将呈现两页单列视图。

### 适应性演示

在创建演示文稿时，您现在可以编写简单且与设备无关的代码，但可以在每个设备上正确执行。

您可以编写没有任何设备检查的代码，在 iPhone 上呈现全屏模式，并在 iPad 上获得更合适的东西，如表单。

另一个例子是活页纸如预期的那样出现在水平常规尺寸类别中，并且作为外页出现在水平紧凑尺寸类别中。

现在可以对警报、弹出窗口和搜索视图这样做。

### 自适应文本和表格

iOS 7 中引入了动态文本，用户可以在应用程序中更改文本的大小。iOS 8 里推的一个功能就是到处都是动态类型。

表格视图也发生了变化，以适应文本大小的变化。现在，您可以创建响应动态类型行变化的表，而无需实现委托方法`tableView:heightForRow AtIndexPath:`。

表格视图单元格本身支持自动布局，因此表格在不同的屏幕尺寸下应该具有一致的视图。

## 通知和小部件

### 交互式通知

在 iOS 8 中，用户可以在不切换应用程序的情况下，与通知进行交互，并采取行动，如回复信息、确认联系请求或像脸书帖子一样。

您的应用程序必须首先注册才能使用通知，无论它是要显示远程用户通知还是本地用户通知。

### 基于位置的通知

您现在可以创建位置感知通知，例如，当用户进入或离开某个区域时就会出现。

### 小工具

第三方应用程序现在能够定义可以出现在通知中心的小部件。您的应用程序可以向用户呈现信息并提供交互，而无需用户启动应用程序。

## 综合

在这里，我们来看看新的 API，它们允许开发者通过向系统和第三方应用添加功能来扩展 iOS。

### 手递手传球

Handoff 允许用户在一台设备上开始一项活动，然后在另一台设备上无缝地继续这项活动，这台设备可能是 Mac、iPhone 或 iPad。

要包含此功能，您需要创建一个活动来跟踪设备上的用户操作，例如打开网页。当上下文发生变化时，您需要更新该活动。操作系统负责在您附近的所有设备上公布活动。此更新仅包含活动的元数据，如 url 或滚动位置，您必须找到自己的方法将实际数据传输到其他设备。

### 扩展ˌ扩张

通过提供应用程序扩展，iOS 8 允许您在整个操作系统中扩展应用程序的功能和内容。在用户任务的上下文中启用自定义功能的代码。通过扩展，您可以在用户需要时随时为他们提供应用程序的强大功能。

iOS 支持以下领域的应用程序扩展，这些扩展称为扩展点:

*   **动作**:对所选内容执行简单任务。
*   **分享**:与社交网站或其他实体分享内容。
*   **照片编辑**:在照片应用中编辑照片或视频。
*   **今日**:在通知中心的今日视图中启用快速任务或更新。
*   **存储提供者**:提供一个可以被其他 app 访问的文档存储位置。
*   **自定义键盘**:提供一个自定义键盘，用户可以为设备上的所有应用选择替代系统键盘。

每个扩展点都为其目的定义了适当的 API。

### 保健包

[HealthKit](https://developer.apple.com/healthkit/) 提供了一个应用程序可以存储和共享健康相关信息的平台。您现在可以构建能够从其他健康应用程序或健康设备访问数据的应用程序。用户可以控制哪些应用程序可以访问哪些信息。

### -我要回家了

[HomeKit](https://developer.apple.com/homekit/) 框架支持用户在家中使用 iOS 设备与支持的设备进行通信和控制。这是通过使用 Siri 发出命令来实现的。如果您正在构建家庭自动化应用程序，您肯定应该看看 HomeKit 提供的潜力。

### 云套件

[CloudKit](https://developer.apple.com/icloud/documentation/cloudkit-storage/) 让你无需编写服务器部分就能编写客户端-服务器应用。CloudKit 使您能够专注于编写客户端应用程序，同时为您处理云存储、身份验证和数据库维护等功能。在很高的范围内都是免费的。

### 本地认证

该特性使用户能够在您的应用程序中使用 TouchID 进行身份验证。这意味着您可以消除使身份验证变得繁琐的密码字段。使用时，您的应用程序将被通知身份验证是否成功，但不会给出用户的生物特征信息。这意味着用户的信息总是隐私和安全的。

### PhotoKit 和新的相机 API

新的[照片框架](https://developer.apple.com/library/prerelease/ios/documentation/Photos/Reference/Photos_Framework/index.html)使您能够创建能够访问和编辑照片应用程序管理的照片和视频资产的应用程序。这是在无需首先导入它们或创建副本的情况下进行的。使用 iCloud 照片图库，您可以访问照片和视频的整个用户收藏。您可以编辑它们，而不用担心它们是在本地还是在云中，所做的更改将在所有设备上反映出来。新的相机 API 可以完全手动控制相机的设置。您的应用程序可以直接控制相机对焦、白平衡和曝光设置。

### 文档选取器

iOS 8 中引入了一个文档选择器视图控制器类。您不再需要编写完全定制的代码来为用户提供文档选择体验。现在，您可以在您的应用程序中构建一个[文档选择器](https://developer.apple.com/library/prerelease/ios/documentation/FileManagement/Conceptual/DocumentPickerProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40014451)，它可以访问本地和 iCloud drive 范围内的文档。如果任何其他应用程序向操作系统提供文档提供程序扩展，这些文档也会出现在您的文档选取器中。

### 组合设置

新的设置面板将应用程序的偏好设置和系统偏好设置合并到一个位置。这为您的用户提供了一种快速访问和更改设置的方式，而无需离开您的应用程序。

## 比赛

### 控制器转发

在去年的 WWDC 会议上，苹果推出了游戏控制器。这些是控制器，你可以把它们挂在你的设备上来控制在设备上玩的游戏。今年，苹果宣布推出控制器转发(controller forwarding)，这是一项新功能，用户可以将 iOS 设备接入游戏控制器，并能够使用控制器按钮、设备的触摸屏和动作来控制 iPads 或 MAC 上运行的游戏。为这些平台开发游戏的开发者在开发支持控制器的应用时，应该考虑这些新的控制选项。

### 喝点什么

[SpriteKit](https://developer.apple.com/library/prerelease/ios/documentation/SpriteKit/Reference/SpriteKitFramework_Ref/index.html) 在 iOS 7 中作为高性能 2D 游戏引擎推出，内置物理支持。在 iOS 8 中，对 SpriteKit 进行了改进。这些包括图形技术，如着色器，照明和阴影，有助于创建丰富的游戏场景。

介绍了以下模拟技术:逐像素物理遮挡、物理场、通用运动学和约束。这些改进将使开发者能够增强他们游戏的外观，并构建更丰富的用户交互。

### SceneKit

SceneKit 是一个 3D 场景渲染器，以前只能在 Mac 上使用，现在已经引入到 iOS 8 中。它有一个集成的物理引擎，粒子系统和对脚本动作的支持。SceneKit 可以与 SpriteKit 集成，在您的 2D 游戏中包含 3D 对象。

### 金属

[Metal](https://developer.apple.com/metal/) 由于其对 A7 和 A8 GPU 的低开销访问，实现了图形渲染和计算任务的高性能。

以前，开发人员会使用 OpenGL 访问 GPU 来创建优化的图形渲染。Metal 通过减少以前存在的性能开销和瓶颈对此进行了改进。有了 Metal，您现在可以从设备 A7 和 A8 芯片中获得最大性能，在游戏中创建丰富的图形和体验，让您的用户高兴。

## 开发、测试和分发

### 互动游乐场

随着 Swift 的推出，游乐场出现了。Playgrounds 使您能够交互式地编写和测试代码。当您创建一个操场文档时，您将看到一个双窗格窗口，您可以在左侧窗格中编写代码，并在右侧窗格中接收实时结果。有了这个新功能，你可以测试代码，而不用在模拟器或设备上启动你的应用。这将加快你的编程工作流程。

### 文档游乐场

文档游乐场结合了交互式游乐场和文档的力量。阅读文档时，您可以更改文件中的代码，并立即收到反馈，就像在普通的游乐场一样。

## 界面构建器更改

### 查看调试

创建视图时，很难跟踪视图在视图层次结构中的位置。尤其是在添加视图元素时，将它们一个放在另一个上面。

在 Xcode 6 之前，Interface Builder 只能显示界面的 2D 平面视图。当调试分层 UI 时，这不是很有用，开发人员通常会求助于第三方应用程序，如 [Reveal](http://revealapp.com/) 来帮助他们调试视图。

有了 [Xcode 6](https://developer.apple.com/xcode/) ，你就有了一个实时交互的方法来调试你的 ui。您可以通过使用 3D 可视化来查看 UI 元素在视图中是如何堆叠的。您可以从视图中移除层，以便更好地访问下面的层。

这不仅可以更好地可视化您的视图层次结构，而且您可以对视图进行更改并立即看到结果，从而使调试变得更加容易。

### 更改界面构建器画布

界面构建器画布现在比以往任何时候都更具交互性。之前有一些变化，你不能在构建应用程序时在画布上预览。你必须在设备或模拟器上运行应用程序，才能看到你所做的改变。

本地化文本就是一个例子。您必须运行应用程序才能在您的用户界面上查看本地化的文本，但现在这是在画布上实时呈现的。自定义字体和视图现在也可以在画布上实时呈现。

### 可调整大小的模拟器

Xcode 6 附带了选择可调整大小的 iPhone 模拟器和可调整大小的 iPad 模拟器的选项。您可以使用它们为 iPad 或 iPhone 的硬件大小输入自定义值，并动态测试代码的适应性。

### 模拟器自定义配置

新的 iOS 模拟器使您能够将数据和配置设置分组在一起。为具有自身数据的应用程序的一个版本运行一个配置，为不同的应用程序版本运行另一个配置。这意味着您将能够在您的机器上模拟多个用户。每个用户都有自己的数据和配置。

### 将界面构建器文档用于启动图像

使用 iOS 8，您现在可以提供一个界面构建器文档，并且在运行时，操作系统会为您的应用程序生成所有必要的启动图像。使用此功能，您无需为启动图像提供单独的资源，并且可以在界面构建器中设计您的启动演示文稿。

## 测试

### 异步测试

过去，所有测试都是同步运行的。这可能是限制性的，因为您可能会使用大量异步的 API。XCTest 中添加了新的 API，允许创建管理异步活动的异步控制流。这是通过描述预期事件的预期对象(XCTestExpectation)实现的。XCTestCase 有一个新的 API，它等待期望实现并设置超时。

当所有事件都完成或超时时，将调用完成处理程序。它可以同时等待多个异步事件，从而更容易测试异步执行的代码和系统交互，如文件 IO、网络请求等。

### 性能试验

在应用程序开发中，代码更改会导致性能退化。改进的 XCTest 框架可以测量和量化应用程序不同部分的性能。您可以在测试中设置基线性能指标。该测试将运行几次，每次运行时，将性能与后续运行进行比较，测量随时间的变化。如果平均性能度量显著偏离基线，测试将失败，提醒您性能回归。

### 仪器集成

随着性能测试的引入，出现了在仪器中分析测试的能力。您将能够选择一个测试或测试套件来进行概要分析，并使用工具进行进一步的调查和分析，以确定测试失败的原因以及回归的原因。

## 应用捆绑包

开发者可以捆绑他们的应用程序，为用户提供以折扣价购买两个或更多应用程序的方式。捆绑包最多可以有 10 个应用程序，苹果公司设置了一些条件，例如:

*   在任何给定时间，您最多只能拥有十个应用捆绑包。
*   一个单独的应用程序可能包含在多达三个应用程序捆绑包中。
*   应用捆绑包在所有国家都可用，每个单独包含的应用都可用。
*   捆绑包中包含的应用程序也必须可以单独销售。
*   应用捆绑包支持完成我的捆绑包。“完成我的捆绑包”为之前购买了捆绑包中包含的一个或多个应用的客户提供了应用捆绑包价格的额外折扣。

## 应用预览

您现在可以创建应用预览视频，这些视频将出现在 App Store 中您的应用详情页面上。你有机会向客户展示你的应用程序能做什么，这可能是说服他们下载它的决定性因素。

## 对 iTunes Connect 的更改

### 试飞测试

[TestFlight Beta 测试](https://developer.apple.com/app-store/Testflight/)允许开发者邀请用户测试他们应用的预发布版本，并在将应用发布到应用商店之前提供反馈。您可以邀请多达 1，000 名测试人员(用户，而不是设备)来测试您的应用程序。

### 分析学

iTunes Connect 现在为开发人员的应用程序提供分析，从而深入了解应用程序商店的浏览量、下载量、参与度和留存率。这些信息以前可以通过第三方 SDK 获得，但现在开发者可以直接获得。

## SDK 现代化

iOS 中的许多框架已经被修改，以利用现代的 Objective-C 语法:

*   指定的初始化器已经用`NS_DESIGNATED_INITIALIZER`标注了，所以你现在知道哪些是指定的初始化器。
*   在大多数类中，Getter 和 setter 方法被属性所取代。使用现有 getter 和 setter 方法的代码应该可以继续使用这种变化。
*   初始化器的所有返回类型都从`id`变成了`instancetype`。

在大多数情况下，这些更改不需要额外的工作，但您可能希望在 Objective-C 代码中实施这些更改，尤其是在与 Swift 代码互操作时实现代码现代化。

## 其他值得注意的事项

下面我列出了苹果在 WWDC 会议和 2014 年 9 月 9 日的活动中推出的其他值得关注的技术。

### 迅速发生的

在 WWDC，苹果为 Cocoa 和 Cocoa Touch 推出了一种新的编程语言，让开发者们感到惊讶和/或高兴。斯威夫特，显然已经酝酿了四年，据说，嗯，斯威夫特。

它建立在 C 和 Objective-C 的基础上，没有 C 兼容性的限制。swift 的好处是它可以处理 objective-C 代码。这种互操作性对开发人员来说是有利的，因为当您开始将应用程序更新到这种新语言时，您不必丢弃以前的代码和库。

iOS 开发中心现在提供 Xcode 6 GM 种子，你可以下载并开始为 iOS 8 的公开发布准备你的应用。有了 Xcode 6 和 iOS 8 的 GM 种子，Swift 现在是最终版，你可以把你用 Swift 编写的 iOS 应用提交到 App Store。

### 苹果手表

在最近的活动中，苹果发布了传闻已久、备受期待的智能手表 [Apple Watch](http://www.apple.com/watch/) 。这款手表将于 2015 年初开始销售，对开发者来说，好消息是它还可以运行第三方应用。

作为 iOS 8 的补充，WatchKit 框架将使开发者能够为 Apple Watch 开发应用程序。

### Apple Pay

Apple Pay 是苹果公司在最近的 9 月 9 日活动中推出的一项新服务。这项服务为用户提供了一种简单、安全和私密的支付方式，无需实物货币或信用卡。Apple Pay 将适用于 iPhone 6、iPhone 6 Plus 和 Apple Watch。Apple Pay 将于今年 10 月作为 iOS 8 的免费更新在美国推出。

苹果计划发布 Apple Pay APIs，这将使开发者能够开发利用这一移动支付选项的应用程序。

## 结论

苹果今年引入了许多新功能和技术，让开发者能够开发出更高级别的应用。

为了让你的应用保持更新，并为你的用户提供更好的体验，你需要在你的应用中加入这些新功能，尤其是如果你希望在应用商店的竞争中保持领先。

你对开发或使用哪些功能最感兴趣？

## 分享这篇文章