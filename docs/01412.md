# 你的 WordPress 主题是灵活的还是快速的？

> 原文:[https://www . site point . com/are-your-WordPress-themes-flexible-or-fast/](https://www.sitepoint.com/are-your-wordpress-themes-flexible-or-fast/)

本文是与 SiteGround 合作创作的系列文章的一部分。感谢您对使 SitePoint 成为可能的合作伙伴的支持。

如果你已经开发了面向大众发行的 WordPress 主题，你可能会遇到这样的问题:在构建高性能主题和为你的客户构建功能丰富的媒体产品之间找到完美的平衡。

让我们更深入地了解一下这种紧张可能是怎么回事，以及如何在创建快速加载的主题和为用户提供他们喜欢和期望的灵活性和简单的定制选项之间找到折衷的方法。

## 编写 WordPress 主题代码时，灵活性和性能有冲突吗？

首先，我要说的是，我的讨论不是关于整个 WordPress 网站的性能，这可能包括许多不同的因素，比如找到一个伟大的主机提供商，实现缓存机制，利用后端和前端技术，等等。

此外，这个主题不是关于你为自己使用或为特定客户从头开始编写的 WordPress 主题的性能。在这些特殊的情况下，你可以根据你自己或者你的客户的具体需求来定制你的主题，这将使得性能优化变得容易适应。

相反，我的重点将是你为公众编写的 WordPress 主题，这些主题将在 WordPress 或在线市场上发布。在这种情况下，作为主题开发人员，您无法控制如何使用和定制您的主题。

但是为什么为性能编码会与为公众编码的主题相冲突呢？

总的来说，性能要求您:

*   坚持简单的设计
*   在主题中包含有限数量的功能(更多的功能可能需要更多的处理能力和资源，所有这些都会影响主题的性能)
*   为主题添加最小数量的页面模板(模板越少，需要的资源越少，这对性能有好处)
*   尽可能少地执行数据库查询(查询数据库需要时间)
*   限制图像和其他媒体的数量和大小，它们是众所周知的大文件
*   尽量减少 HTTP 请求的数量(每次往返服务器都要花费一些时间，这对性能有明显的负面影响)。

另一方面，你的主题中有相当数量的用户可能更有企业家精神，而不是技术头脑。因此，他们可能会寻找一种产品，可以变成几乎任何东西，而不需要一行代码，具有许多现成的功能，令人惊叹的照片和视频资产，超级令人愉快的视差和其他动画效果，等等。

为主题用户提供他们想要的所有灵活性可能会带来一些性能成本。但是，让我们进入几个具体的点，说明这是如何发生的，以及如何找到一些中间地带，以取得成功的结果。

### 主题是外观，插件是功能

尽管一些著名的 WordPress 专家已经对所谓的*厨房水槽主题* 提出了一些有根据的批评，也就是说，这些多功能主题可以通过提供任何功能而成为任何人的任何东西，但对它们的需求仍然很强劲。

让用户能够轻松添加社交媒体按钮、SEO 功能、联系方式、价格表等的主题。，虽然吸引了很多买家的注意，但不要没有一些严重的缺点。

特别是，这种 WordPress 主题与专门为其构建的插件紧密耦合，甚至直接集成到主题中。由于以下原因，这种做法受到普遍反对:

*   一些与主题捆绑在一起的插件可能存在漏洞，将主题用户置于危险之中。如果这个主题没有安装特定的插件，那么它就不太可能面临这样的风险
*   A super important drawback of tight integration between themes and plugins is what [Ren Ventura identifies as *theme lock*](https://www.engagewp.com/why-i-no-longer-use-themeforest/). Here’s his explanation of this problem:

    > 当 WordPress 用户不能在不破坏网站大部分功能的情况下改变他或她的主题时，主题锁定就会发生。一旦主题被停用，它就会停用主题注册的短代码和自定义文章类型。如果没有这些用户在网站中大量集成的功能，事情就会分崩离析。

    因此，当你改变主题时，很多你认为是网站内容的东西会随着旧主题一起消失。例如，如果你的主题提供了向你的网站添加推荐的能力，一旦你改变主题，所有与你的推荐相关的内容都将消失。不太好。

*   当然，膨胀和性能成本。比方说，你不需要在你的网站上有一个推荐部分。然而，使该功能在主题中工作的所有代码仍然存在:它占用了服务器上的空间，最终会花费金钱。

主题审查团队(即审查在 WordPress.org 主题报告上提交的主题的志愿者)正确执行的一条伟大格言是:**保持功能与外观分离。插件处理功能，主题处理外观。消除所有的复杂性将会提高主题的性能，同时让用户更容易安装和配置 WordPress 主题。**

### 你的用户不需要大量的主题选项(但是他们可能不知道)

直到不久前，WordPress 主题还包括相当复杂的主题选项页面，用户只需点击一个按钮就可以进行各种修改。

这些天来，由于 2015 年 WordPress.org 主题审查团队做出的重大[决定，大多数主题都使用](https://make.wordpress.org/themes/2015/04/22/details-on-the-new-theme-settings-customizer-guideline/) [WordPress 定制器](https://developer.wordpress.org/themes/customize-api/)提供主题选项，这使得用户可以实时预览所做的更改。

不幸的是，统治旧主题选项页面的厨房水槽心态已经开始迁移到定制器，现在你可以看到它也开始充满各种设置。

尽管非技术客户喜欢使用主题选项来修改他们的主题，但有时太多的选项会带来更多的问题，而不是表面上解决的问题:

*   太多的选项会让不太熟悉网站设计核心原则的用户陷入瘫痪。
*   设置和配置主题可能会比预期花费更多的时间。
*   很容易犯错误，比如选择错误的颜色，使文本不可读等。
*   用户可能会在他们的主题中添加太多的字体，从而破坏设计并降低网站速度。
*   更多的选项意味着向主题添加更多的功能，从而影响其性能。

虽然你的客户可能一开始不接受这一点，但你是主题设计师，因此你应该是最适合为你的主题做出重要设计决策的人。

一个精心设计的主题选项数量应该足以让你的客户做出一些有针对性的和预先定义好的(由你)修改来个性化主题，使之成为他们自己的主题。

### 实施智能图形优化技术

与模板文件、脚本和样式相比，图片可能是主题表现的重中之重。只需通过 [Pingdom 的速度测试工具](https://tools.pingdom.com/)运行任意主题来验证这一点。

然而，大量使用全屏粗体图像并不奇怪。图像为主题增加了巨大的美学价值，顾客被吸引到一个主题很大程度上是基于其视觉冲击。

虽然很难抗拒优秀图形的力量，但下面的指导方针可以帮助你更快地编写主题，而不必牺牲美学(太多):

*   使用尽可能少的图片总是一个好的指导原则。
*   利用 CSS [混合模式](https://www.sitepoint.com/close-up-css-mix-blend-mode-property/)、[滤镜](https://www.sitepoint.com/css-filter-effects-blur-grayscale-brightness-and-more-in-css/)和低分辨率图像上的半透明覆盖来掩盖像素化并增强它们的视觉外观。你也可以尝试在 HTML 元素和文本上使用 CSS [混合模式](https://codepen.io/helmsmith/pen/xbBEWy)和[过滤器，而不是图像，尽可能创造出令人惊叹的视觉效果。](https://codepen.io/commander-clifford/pen/PZJYBo)
*   确保图像采用[适当的格式](https://www.sitepoint.com/what-is-the-right-image-format-for-your-website/)并针对网络进行了优化。
*   在适当的地方，使用 [CSS sprites](https://www.sitepoint.com/css-sprites-sass-compass/) 将你的图片组合成一个更大的图片，从而减少 HTTP 请求。
*   尝试实现图片的[延迟加载。这样做将实现更快的页面加载，如果用户不滚动到`<img>`标签的位置，图像根本不需要下载。要在 WordPress 中惰性加载图片，你可以从一些好的插件中选择，比如](https://www.sitepoint.com/five-techniques-lazy-load-images-website-performance/)[惰性加载](https://wordpress.org/plugins/lazy-load/)、 [a3 惰性加载](https://wordpress.org/plugins/a3-lazy-load/)和[火箭惰性加载](https://wordpress.org/plugins/rocket-lazy-load/)。

### 让客户支持和教育成为你的力量支柱

不要给你的客户提供大量令人困惑和耗时的主题选项，试着就如何使用你的主题、图像优化、WordPress 101 等提供全面的支持和教育。

您可以通过以下方式实现:

*   博客帖子
*   可下载指南
*   视频教程
*   你网站上的常见问题
*   使用你的主题时可能出现的更具体的问题的票证系统。

分享关于您的产品和平台的基本知识是让您的主题易于客户使用的好方法，并有助于产生高度的信任，这是健康和成功业务的核心。

## 有时灵活性胜过性能

在有限的情况下，您可能认为为了少量的性能提升而牺牲一些灵活性并不是一个好主意。

我想起了几个例子。

### 什么时候写枯燥的代码会让你的客户不高兴

第一个例子来自于[汤姆·麦克法兰](https://twitter.com/tommcfarlin)，一个知名的 WordPress 主题开发者和作者。

在他的博客中，他解释了为什么他决定包含一长串 [WordPress 模板文件](https://developer.wordpress.org/themes/template-files-section/partial-and-miscellaneous-template-files/)，从而违背了 [DRY](https://en.wikipedia.org/wiki/Don't_repeat_yourself) 编码原则(并且在某种程度上对性能有负面影响)，同时开发了他的主题 *Meyer* 。

Meyer 的目标是没有多少 WordPress 技术知识的博客作者和数字出版商。Tom McFarlin 知道缺乏编程经验不会阻止这些观众修改他的主题，他想出了一个让事情变得更容易的方法。他为他的客户提供了大量的模板文件，他们可以很容易地复制并粘贴到一个 [WordPress 子主题](https://www.sitepoint.com/watch-create-your-first-wordpress-child-theme-quick-fast/)中进行定制，而无需修改原始主题。

麦克法兰写道:

> 如果模板是在基本主题中定义的——而不是，比方说，一堆开发人员特有的条件——用户将更容易根据已经存在的东西来创建模板…
> 
> 因此，如果我必须以某种简洁的方式总结这一点，我会说，我——像许多开发人员一样——希望尽可能保持我的代码干燥，但是在 WordPress 主题开发的环境中这样做是有代价的。
> 
> 我不认为保持干燥是最好的方式，如果你要向广大观众推销一种产品的话。
> 
> [了解你的客户——博客作者](https://tommcfarlin.com/wordpress-theme-development-thinking-of-the-blogger/)。

### 静态源代码对性能更好，但是不要在你的公共主题中使用它

我的第二个例子是基于 Codex 的性能建议，说明了在 WordPress 主题中什么时候不要为了一些性能增益而牺牲灵活性。

你可以在那里找到一些很棒的性能技巧，但是有一个我不建议你使用，至少如果你打算向公众发布你的主题的话。

事情是这样的:

> *   静态值可以硬编码到你的主题中吗？这将意味着您必须在每次进行更改时编辑代码，但是对于一般的静态区域，这可能是一个很好的权衡。
>     
>     
>     *   例如，您的站点字符集、站点标题等等。
>         
>         
>     *   你能硬编码很少改变的菜单吗？比如避免使用`wp_list_pages()`这样的函数。
>         
>         
> 
> [Codex — WordPress 优化/WordPress 性能](https://codex.wordpress.org/WordPress_Optimization/WordPress_Performance)

避免不必要的数据库调用和优化 SQL 查询是每个主题都应该遵循的优秀实践。

如果你的主题运行的有点慢，试着寻找那些执行时间太长的有问题的数据库查询。您可以在您的开发环境中使用类似于 [Query Monitor](https://wordpress.org/plugins/query-monitor/) 的插件来帮助您完成这项任务。

然而，硬编码的信息，如网站标题，菜单项等。，是办不到的。即使你的用户一旦设置了这些信息就不再更改，他们也需要至少设置一次，而且他们有理由期望使用 WordPress 动态功能来这样做。

此外，即使你的主题的用户准备钻研源代码，他们也必须破解主题文件来添加所需的数据。这几乎从来都不是一个好主意，尤其是因为所有的改变都会在下一次主题更新时被覆盖。

## 结论

为大众编写 WordPress 主题可能会涉及到迎合不同的，有时是不相容的需求:你的客户群的需求，网络性能的需求，因此也是那些使用你的主题的网站的访问者的需求，甚至是你自己作为 WordPress 主题设计者和创造者的需求。

在这篇文章中，我表达了我对如何解决 WordPress 主题开发者在灵活性需求和性能需求之间可能面临的困境的看法。

## 分享这篇文章