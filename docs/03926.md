# 重新介绍流浪者:PHP 入门的正确方法

> 原文:[https://www . site point . com/re-introducing-lavour-right-way-start-PHP/](https://www.sitepoint.com/re-introducing-vagrant-right-way-start-php/)

我经常被要求为刚接触 PHP 的人推荐初学者资源。而且，这是真的，我们没有很多真正对新手友好的人。我想改变这种情况，首先谈谈环境配置的基础知识。在这篇文章中，你将了解到在开始使用 PHP(或者其他语言)之前你应该做的第一件事。

我们将重新介绍流浪者动力开发。

*注意，这个主题(以及其他最佳实践)在 [SitePoint 的 Jump Start PHP Environment](https://www.sitepoint.com/premium/books/jump-start-php-environment?aref=bskvorc) 一书中有更深入的介绍。*

请花时间通读整篇文章——我知道这是一堵文字墙，但这是一堵重要的文字墙。通过遵循里面的建议，你不仅能帮自己一个大忙，而且将来还能让无数其他开发人员受益。这篇文章主要是理论性的，但最后我们会链接到一个 5 分钟的快速教程，旨在让你很快就能开始使用流浪者。不过，建议你在这样做之前先理解它背后的理论。

为了以防万一，你想赶在进入理论之前*做些实际的事情，[这里有那个教程的链接](https://www.sitepoint.com/quick-tip-get-homestead-vagrant-vm-running/)。*

## 什么？

让我们从一个显而易见的问题开始——什么是流浪者？为了解释这一点，我们需要首先解释以下 3 个术语:

*   虚拟计算机
*   VirtualBox(虚拟方块)
*   准备金提取

### 虚拟计算机

在我能想到的最简单的定义中，虚拟机(VM)是你的主计算机的一个独立部分，它认为自己是一台独立的计算机。例如，如果您有一个具有 4 个内核、12 GB 内存和 500 GB 硬盘空间的 CPU，您可以将 1 个内核、4 GB 内存和 20GB 硬盘空间变成一个虚拟机。然后，该虚拟机认为它是一台拥有如此多资源的计算机，并且完全不知道它的“父”系统——它认为自己是一台计算机。这让你可以拥有一台“电脑中的电脑”(是的，甚至是一台新的“显示器”，本质上是一个窗口中的窗口——见下图):

![A Windows VM inside a Mac OS X system](../Images/429ccadb3ec873081fa61d468a50b416.png)
*Mac OS X 系统内的 Windows 虚拟机*

这有几个优点:

*   你可以搞乱任何你想搞乱的东西，你的主机上没有任何东西坏掉。想象一下，在你的主机上意外下载了一个病毒，那将是灾难性的。你的整个电脑都会有危险。但是如果你在一个虚拟机中下载了一个病毒，只有这个虚拟机会受到威胁，因为它与它赖以生存的父系统没有真正的联系。因此，当虚拟机被感染时，可以简单地被破坏并重新配置为存在，干净得像哨子一样，没有任何后果。
*   您可以测试其他操作系统的应用程序。例如，你有一台苹果电脑，但你真的想要一个苹果没有的特定的 Windows 应用程序。只需启动 Windows 虚拟机，并在其中运行应用程序(如上图所示)！
*   你保持你的主操作系统没有垃圾。通过在你的虚拟机上安装东西，你可以避免在你的主机上安装任何东西(虚拟机在其上运行)，保持主操作系统干净、快速，并且尽可能长时间接近它的“全新”状态。

您可能会想——如果我将我的主机计算机的这么多部分专用于虚拟机(一个完整的 CPU 内核、4GB 的 RAM 等),难道不会:

*   让我的主电脑变慢？
*   让虚拟机变慢，因为这是一个很弱的机器？

两个问题的答案都是“是”——但这就是为什么这没什么大不了的。您只在需要时运行虚拟机，当您不需要时，您就“关闭它”，就像关闭物理计算机一样。资源(您的 CPU 内核等。)会立即被释放。虚拟机速度慢并不是问题，因为它并不意味着是一台主要机器——你有主机，你的主要计算机。所以虚拟机只是为了一个特定的目的而存在，对于这个目的来说，这些资源已经足够了。如果你真的需要一个比主机操作系统更强大的虚拟机，那么只需给虚拟机更多的资源-就像如果你想在你的 Windows 机器上玩一个强大的游戏，而你在一台有 4 个 CPU 核心的 Mac 电脑上，给虚拟机 3 个核心和 70-80%的 RAM 虚拟机立即变得足够强大，可以运行你的游戏！

但是，如何“制造”一个虚拟机呢？这就是像 VirtualBox 这样的软件的用武之地。

### VirtualBox(虚拟方块)

VirtualBox 是一个程序，让您快速轻松地创建虚拟机。VirtualBox 的替代产品是 VMware。你可以(并且应该立即)在这里安装 VirtualBox。

VirtualBox 提供了一个易于使用的图形界面来配置新的虚拟机。它将让您选择 CPU 核心的数量，磁盘空间，等等。要使用它，您需要一个想要在您正在构建的虚拟机上运行的操作系统的现有映像(例如，安装 CD)。例如，如果你想要一个如上图所示的 Windows 虚拟机，你需要准备一张 Windows 安装 DVD。不同风格的 Linux、OS X 等等也是如此。

### 准备金提取

创建新虚拟机时，它是最基本的。它只包含已安装的操作系统，没有其他应用程序，没有驱动程序，什么都没有。你仍然需要把它配置成你刚买的一台全新的电脑。这需要很多时间，人们想出了不同的方法来解决这个问题。其中一种方法是*供应*，或者使用预先编写的脚本为您安装一切。

借助配置流程，您只需创建一个新的虚拟机并启动配置程序(配置程序是一个接受特殊指令的特殊程序)，一切都会自动完成。一些流行的供应器有:Ansible、Chef、Puppet 等——每个供应器在配置“配方”中都有一个特殊的语法，您需要学习。但是不要害怕，这也是可以跳过的。继续读。

### 无赖

这就是我们流浪的地方。vagger 是另一个程序，它结合了 provisioner 和 VirtualBox 的功能来为您配置虚拟机。

你可以(并且应该立即)在这里安装流浪者[。](https://www.vagrantup.com/)

然而，vagger 对虚拟机采取了不同的方法。传统虚拟机的图形用户界面(GUI)包含窗口、文件夹等等，因此需要很长时间才能启动并在配置后变得可用，而由流浪者驱动的虚拟机则不需要。vagger 去掉了你不需要的东西，因为它是*面向开发的*，这意味着它有助于创建开发友好的虚拟机。

流浪机器将没有图形元素，没有窗口，没有任务栏，没有任何可以使用鼠标的东西。它们只能通过终端(或 Windows 上的命令行——但为了简单起见，我从现在开始将它称为终端)使用。与标准虚拟机相比，这有几个优势:

1.  流浪的虚拟机启动速度非常快。打开虚拟机并在其上开始开发只需几秒钟。看看这对我来说发生得多快——从开始到结束仅仅 25 秒:
    ![Vagrant up](../Images/3845220aad0e3fb42251d1c4327c9022.png)
2.  流浪虚拟机的使用速度非常快——没有图形元素占用宝贵的 CPU 周期和 RAM，虚拟机与普通计算机一样快
3.  流浪的虚拟机类似于真实的服务器。如果你知道如何使用一个流浪的虚拟机，你也可以在真正的服务器上找到自己的路。
4.  由于其剥离的性质，流浪虚拟机非常轻，因此它们的配置通常比常规的图形驱动虚拟机弱得多。使用 PHP 开发时，在大多数用例中，一个 CPU 内核和 1GB RAM 就足够了。这意味着你不仅可以在一台非常弱的计算机上启动一个不稳定的虚拟机，还可以启动几个虚拟机，而不必担心资源耗尽。
5.  也许最重要的是，流浪的虚拟机是可破坏的。如果您的虚拟机出现问题——您安装了恶意软件，您意外删除了一些重要的东西，或者发生了任何其他灾难，您只需运行两个命令就可以恢复到原始状态:`vagrant destroy`这将在配置过程(在启动后立即发生)后销毁虚拟机和安装在虚拟机上的所有内容，而`vagrant up`将从头开始重建虚拟机，并在之后重新运行配置过程，有效地将时间返回到您搞砸事情之前。

有了流浪者，你有一个高度宽容的环境，可以在几分钟内将一切恢复到原来的状态，节省你几个小时的调试和重新安装程序。

## 为什么？

那么，为什么要特别为 PHP 开发这样做呢？

1.  在几个版本的 PHP 上测试的能力，或者安装了不同扩展的 PHP。一个虚拟机可以运行 PHP 5.5，一个可以运行 PHP 5.6，一个可以运行 PHP 7。在每台机器上测试你的代码——不需要重新安装任何东西。立即确保您的代码是跨版本兼容的。
2.  在多台服务器上进行测试的能力。在一个 VM 上测试 Apache，在另一个 VM 上测试 Nginx，或者在另一个 VM 上测试 Lighttpd 和上面一样:确保你的代码可以在所有服务器配置上工作。
3.  在服务器+ PHP 版本的不同组合上测试代码的执行速度。也许代码在 Nginx + PHP 7 上的执行速度会快一倍，这允许您进一步优化，并提醒潜在用户可能的速度提升。
4.  与其他团队成员共享相同的环境，避免“它在我的机器上工作”的借口。所有需要做的就是共享一个单独的流浪文件(包含所有必要的配置),每个人都有和你完全一样的设置。
5.  获得开发/生产奇偶校验:配置您的浮动虚拟机使用与您的生产(活动)服务器相同的软件(和版本)。例如，如果您在 live 服务器上运行 Nginx 和 PHP 5.6.11，以完全相同的方式设置 Vagrant VM。这样，当您将代码部署到生产环境中时，您可以 100%确定您的代码会立即工作，这意味着您的访问者不会有停机时间！

这些是主要原因，但不是唯一原因。

但为什么不是 XAMPP 呢？XAMPP 是一个预建的 PHP、Apache、MySQL(和 Perl，为世界上需要它的三个人准备的)包，只需点击一下鼠标就可以创建一个 PHP 工作环境。这肯定比流浪好，不是吗？我的意思是，一次点击与了解终端、Git 克隆、虚拟机、主机等等……？实际上，情况更糟，原因如下:

1.  有了 XAMPP，你完全掌握了服务器配置的知识，对终端、手动软件安装、SSH 使用以及将来部署一个真正的应用程序所需要的一切都了如指掌。
2.  与 XAMPP，你永远不会对最新版本的软件。它是一个预先配置的软件堆栈，更新一个单独的部分需要时间和精力，所以除非涉及重大版本变更，否则通常不会完成。因此，你总是在操作一些至少有点过时的东西。
3.  XAMPP 强迫你使用阿帕奇。不是说 Nginx 是服务器软件的阿尔法和欧米茄，但至少能够在它上面测试将是非常有益的。对于 XAMPP 和类似的软件包，您没有选择这样做。
4.  XAMPP 强迫你使用 MySQL。如上所述，能够随意切换数据库是基于 VM 的开发的一大好处，因为它不仅让您学习新技术，还让您使用那些适合用例的技术。例如，你不会用 MySQL 建立一个社交网络——你将使用一个[图形数据库](https://www.sitepoint.com/discover-graph-databases-neo4j-php/)——但是有了像 XAMPP 这样的软件包，你就可以和这个选项说再见了，除非你陷入在你的机器上安装它的额外骗局，这会带来一系列新问题。
5.  XAMPP 安装在你的主机操作系统上，这意味着它会污染你的主系统空间。每次你的电脑启动时，都会因为这个而慢一点，因为无论你那天是否打算做一些开发，软件都会加载。对于虚拟机，您只需在需要时启动它们。
6.  XAMPP 是版本锁定的——你不能把一个版本的 PHP 换成另一个，或者把一个版本的 MySQL 换成另一个。你所能做的就是使用你所得到的，虽然这对一个 100%不熟悉 PHP 的人来说可能是好的，但从长远来看是有害的，因为它给人一种错误的安全感和确定感。
7.  XAMPP 是操作系统特有的。如果你使用 Windows 并安装了 XAMPP，你必须忍受 PHP 在 Windows 上遇到的各种问题。适用于 Windows 的代码可能不适用于 Linux，反之亦然。因为绝大多数 PHP 站点都运行在 Linux 服务器上，所以在 Linux VM 上开发是有意义的。

不使用 XAMPP(以及类似的软件包，如 MAMP、WAMP 等)还有很多原因，但这些是主要原因。

## 怎么会？

那么一个人如何给一个流浪者盒子加电呢？

第一种方法，包括一点实验和下载大量数据，是去哈希公司的流浪者盒子列表[这里是](https://atlas.hashicorp.com/boxes/search)，找到一个你喜欢的，并执行你能在盒子细节中找到的命令。例如，要启动一个 64 位的 Ubuntu 14.04 虚拟机，按照[指令](https://atlas.hashicorp.com/ubuntu/boxes/trusty64)，在安装了 after 之后，在你选择的文件夹中运行:`vagrant init ubuntu/trusty64`。这将把这个盒子下载到你的本地漫游副本中，以备将来使用(你只需要下载一次),这样将来基于这个的虚拟机就可以设置得更快。

请注意，Hashicorp(顺便说一句，它是流浪者背后的公司)的机器不一定是基本的虚拟机。有些预装了软件，让一切都变得更快。例如， [laravel/homestead box](https://atlas.hashicorp.com/laravel/boxes/homestead) 预装了最新的 PHP、MySQL、Nginx、PostgreSQL 等，因此您几乎可以立即开始工作(下一节将详细介绍)。

另一种方式是从 Github 上抓取某人预先配置好的流浪者盒子。上面链接中的列表中的盒子已经足够好了，但是没有你想要安装或配置的所有东西。例如，homestead box 确实带有 PHP 和 Nginx，但是如果你启动它，你就不会配置服务器，你也不能在浏览器中访问你的站点。要做到这一点，你需要一个 provisioner，这就是流浪文件发挥作用的地方。当你从 Github 获取某人的流浪文件时，你也获得了配置——一切都为你设置好了。这使我们进入嗨。

## 嗨！

[HI(Homestead Improved 的简称)](https://www.sitepoint.com/quick-tip-get-homestead-vagrant-vm-running/)是 [laravel/homestead](https://laravel.com/docs/5.0/homestead) 的一个版本。我们在 SitePoint 广泛使用这个框来快速引导新的项目和教程，这样所有读者都有相同的开发环境来工作。为什么是一个版本，而不是原来的家园，你可能会奇怪？因为最初的版本要求你在你的主机上安装 PHP(你将在其上启动你的 VM ),我是跨平台开发的大力支持者，因为当你切换机器时，你不需要改变你的主机操作系统上的任何东西*。通过使用 Homestead Improved，您几乎不费吹灰之力就可以为任何操作系统准备好一个环境。*

 *上面的 gif 图片显示我在 25 秒内启动了一个虚拟机——这是一个 HI 虚拟机，我用它来完成一个特定的项目。

我建议你通过这个[快速提示](https://www.sitepoint.com/quick-tip-get-homestead-vagrant-vm-running/)快速启动并运行它。第一次运行可能会花一点时间，由于盒子必须下载，但随后的运行应该和我上面的 gif 一样快。

请现在就做——如果你遇到了什么困难，请告诉我，我会跑过去帮你解决；真的希望大家尽快过渡到游民驱动型发展。

## 结论

通过使用 HI(一般来说是 vagger)，您可以为自己的跨平台开发体验铺平道路，并保持您的主机操作系统整洁，与您的所有开发工作隔离开来。

下面你会发现一系列其他有用的资源来增强你的新流浪能力:

*   sitepointvagger 发布了许多关于使用 vagger 进行开发的不同方面的教程，有些解释了下面的链接，有些则深入到手动提供一个盒子，甚至创建自己的盒子，等等。
*   [StackOverflow 游民标签](https://stackoverflow.com/questions/tagged/vagrant)关于游民的问题和答案，如果你在设置时遇到问题
*   [pup hpet](https://puphpet.com/)–一种根据您的需求图形化配置新的流浪者盒子的方式–选择一个服务器、一个 PHP 版本、一个数据库等等。使用傀儡置备程序。不需要木偶知识。
*   [phan sible](http://phansible.com/)–与 PuPHPet 相同，但使用 Ansible provisioner。不需要 Ansible 知识。
*   一组 bash 脚本，你可以下载(没有 provisioner——各种文件中的原始终端命令，只是被执行)作为上面两个脚本的替代。需要更多的手动工作，但由于*的微调能力*，通常会减少虚拟机的膨胀。
*   [流浪汉的 5 种入门方式](https://www.sitepoint.com/5-easy-ways-getting-started-php-vagrant/)——列出了上面的资源，加上一些其他的。

你有什么问题吗？有什么不清楚的吗？您希望我更深入地探讨上面提到的任何话题吗？请在下面的评论中让我知道，我会尽最大努力澄清事情。* 

## *分享这篇文章*