# 4 种敏捷方法来处理生产中的 bug

> 原文：<https://www.sitepoint.com/4-agile-ways-to-handle-bugs-in-production/>

![A bug](img/a4486cc4d44698aaa937dee831396167.png)

在一个完美的世界里，每次我们在 sprint 结束时推出代码，它都会在生产中完美地工作。不会有任何错误，也不会有任何问题迫使我们回滚已经部署的代码。

当然，我们并不是生活在一个完美的世界里。这是我们首先采用敏捷的原因之一。敏捷不是假装你的世界是完美的。这是关于适应现实，迭代改进你的过程和你的灵活性，以便当问题出现时你能够处理它们。

团队经常遇到的一个问题是在冲刺阶段发现了产品中的一个新 bug。您的团队已经完成了部署，通过了所有的测试，所有的东西都已经推出到生产环境中，因此客户可以开始使用它了。

但是可能会出现一个没有考虑到的边缘情况。也许没有经过充分测试的代码的某些方面浮出了水面，并开始给用户带来问题。你的敏捷团队应该如何应对呢？

有许多不同的方法来处理产品中在 sprint 中出现的 bug。选择一个最适合你的团队的依赖于你的公司是如何构建的，bug 有多严重，以及什么对你的产品所有者和你的客户最重要。

## 最小影响选项

如果生产中的一个 bug 是由以前的 sprint 工作造成的，并且对用户产生了负面影响，那么尽可能最简单的方法就是将生产服务器回滚到上次 sprint 更新之前的状态。至少，这将把 bug 对新用户的影响降到最低。

这样做需要有一个支持干净回滚的生产部署系统设置。一个能够将代码推入生产环境的敏捷团队应该在一个支持连续部署的环境中工作，或者至少是允许您将生产服务器回滚到先前状态的部署标签。正是在这样的时候，你才会真正感激团队中有强大的部署或开发工程师。

如果有可能简单地解决问题，产品负责人可能会选择写一个 bug 故事，在下一个 sprint 中处理。这将防止当前的冲刺被中断，并减少对团队速度的影响。以这种方式处理 bug 还允许团队更仔细地考虑 bug 的潜在影响，以及修复它的最佳方式。

## 深度探索选项

有时候在产品中修复一个 bug 并不像听起来那么简单。例如，错误可能对输入到应用程序中的数据有影响，或者错误可能实际上存在于数据层中。在这种情况下，数据库恢复可能是必要的，这会带来一系列其他困难。

识别 bug 的潜在范围是产品负责人和工程团队的责任。当发现一个 bug 时，产品负责人可能需要召集一个或多个工程师开会，讨论影响的深度，并制定行动计划。当然，团队在冲刺阶段的速度可能会降低，仅仅是因为需要评估损害的程度并提出可行的解决方案。

如果 bug 足够紧急，并且预测不确定，可能有必要在当前的 sprint 中引入一个新的峰值，并让工程团队中的一些人开始展望在下一个 sprint 中修复 bug 的必要性。由于未知的性质，bug 可能很难估计，因此不为 bug 打分通常是个好主意。然而，从长远来看，让一个工程师从当前的冲刺中带走一点点努力会有回报，而不会阻碍整个团队。

## 紧急工作选项

![More bugs](img/63f0a9eb1df6aaa845af3aefdac70009.png)

不总是有可能把 bug 修复推迟到下一次冲刺。有时一个 bug 是如此关键，并且影响到产品如此重要的一个方面，以至于有必要在当前的冲刺阶段实现一个修复。理想情况下，这项工作不需要整个开发团队。产品负责人有责任评估损害的范围，并决定是否值得在冲刺阶段引入一个新的故事来解决一个关键的 bug。

在冲刺阶段引入新的故事从来都不是一个好主意。一个好的 scrum 大师应该和产品负责人一起努力限制正在进行的 sprint 的变化。但这并不意味着它从来没有必要，一个好的 scrum 大师也应该能够清楚地向团队传达何时以及为什么调整 backlog 是重要的，如果这是最好的选择。

这种情况下的目标是对 sprint 产生尽可能小的影响。也许从事导致问题的代码部分的开发人员可以从他们正在从事的工作中脱离出来，并被临时指派去修复 bug。当然，他们正在做的任何故事都将受到影响，并且在 sprint 中对前一次 sprint 中的 bug 所做的工作不会获得任何积分。

## 核选择

如果在产品代码中发现了一个关键的 bug，这个 bug 的存在导致了严重的问题，需要开发团队一半以上的人齐心协力来修复它，有时唯一能做的就是停止 sprint 并开始一个新的。

这应该是产品负责人的最后手段。虽然产品负责人总是可以选择停止一个 sprint，但是应该意识到，任何正在进行的工作的连续性都将丢失，并且与那个 sprint 相关的速度计算也将丢失。出于规划的目的，在冲刺阶段已经完成的所有工作都应该被视为放弃。

当然，这并不意味着作品实际上被丢弃了。但是从工程的角度来看，停止一个故事的工作，然后再继续，会对一个工程团队所需要的关注和专注产生如此负面的影响，以至于只有在最极端的情况下才应该使用这个选项。

如果你的团队选择这个选项，不要错误地试图创建一个比典型 sprint 更短的迷你 bug-sprint。如果您认为 bug 可以在比完成一次 sprint 更短的时间内修复，那么保留上一次 sprint 的积压工作，一旦 bug 被修复，就让工程师们重新开始工作。您的总体速度应该考虑到修复团队产生的错误所需的努力，而不是假装它不存在。创建多种长度的冲刺是一种严重的 scrum 反模式，会破坏你跟踪团队真实速度的能力。

## 一盎司的预防

根据您的公司正在部署的代码类型和您的用户群的规模，使用 canary 服务器来测试生产中的任何变化对您的用户子集的影响通常是一个好主意。这使您能够快速找出可能的边缘案例，并限制对整体客户群的影响。

即使加那利服务器不是一个选项，开发带有开关的代码总是一个好主意，这将允许您随意打开或关闭已经添加到产品中的新功能。Scrum 是关于在每个冲刺阶段开发和部署完整的自顶向下的特性。如果以这种方式添加了一个新特性，结果发现其中有一个没有更广泛影响的 bug，在生产中关闭它可能会允许团队继续前进，同时最小化对用户的影响。

## 别忘了回顾展

当然，诸如此类的问题应该总是在回顾会上讨论，以确保每个人都知道发生了什么，以及如何在将来更有效地预防或处理它。

最终，产品负责人负责做出这些决定。敏捷工程团队需要以一种允许在生产中出现 bug 的情况下做出最有生产力和效率的响应的方式工作。

## 分享这篇文章