# 灯塔初学者指南

> 原文:[https://www.sitepoint.com/lighthouse-beginners-guide/](https://www.sitepoint.com/lighthouse-beginners-guide/)

你已经建立了一个网站，但是它对你的终端用户来说表现如何呢？提这个问题很关键，但是怎么才能得到答案呢？一个很好的选择是使用[灯塔](https://developers.google.com/web/tools/lighthouse)。

Lighthouse 允许您轻松地自动分析网页的性能和质量。它提供了一些工具，让你了解如何提高你的网页的性能，可访问性，搜索引擎优化等等。使用这些分数来提升你的网站最终会吸引更多的用户，增加你的网站在搜索引擎中的排名。

在本文中，我们将探讨网站性能的重要性，这是灯塔评分的亮点。我们还将看看为什么我们应该使用 Lighthouse 如何通过 Chrome 和 Lighthouse CLI 使用 light house；和各种审计灯塔可以执行评分您的网页，以及为什么他们很重要。我们还将介绍如何解决一些常见的性能和其他网站问题。

我们还将了解如何使用 WebPageTest，这是另一个评估站点性能的强大工具。

## 为什么性能很重要

如果你看看一些世界上最好的网站，它们都有一个共同点:它们为用户提供卓越的体验。这有很多原因，但其中最重要的一个是性能。用户喜欢快捷的网站。他们等待网站加载的时间越长，他们就越有可能离开网站去寻找一个更好的网站，让他们不用等待就可以做他们需要做的事情。

提高你的网站的性能可以带来更高的 SEO 排名(我们将在本文后面看到更多细节)，并提高点击率和转化率。因此，如果你想要更多的销售、注册或流量，你首先要确保你的网站的性能符合标准。

## 为什么使用 Lighthouse

[Lighthouse](https://developers.google.com/web/tools/lighthouse) 是谷歌打造的开源工具。由于谷歌是一家声誉良好的公司，受到许多人的信任，这使得搜索结果比其他工具更可靠。此外，由于谷歌的搜索引擎是过去十年[的领先搜索引擎](https://www.statista.com/statistics/216573/worldwide-market-share-of-search-engines/)，在他们的搜索引擎上出现更高很可能会带来更多的流量。因此，在他们的绩效审计工具上获得更高的分数可能会提高你的网站在搜索结果中的排名。

但是除了 Lighthouse 是由 Google 创建的这一事实之外，使它成为一个好工具的是它的详细结果，这些结果将用户的最佳利益放在了心上。Lighthouse 提供了许多结果，包括页面加载需要多长时间，页面(以及最终的网站)是否安全，页面的可访问性实践和实现是否允许包容所有用户，等等。

## 如何使用灯塔

在本节中，我们将首先介绍使用 Lighthouse 分析和检查网页得分的最简单方法，这是直接通过 Chrome 完成的。然后，我们将检查其他可能提供更详细结果或选项的 Lighthouse 工具。

### 使用铬合金

通过 Chrome 使用 Lighthouse 是衡量网站性能最简单的方法。首先，打开您想要测量的任何网页。为了演示，我将使用在[我的网站](https://blog.shahednasser.com/)和 [GitHub](https://github.com/) 上的一些审计结果，让我们看到各种样本结果。

接下来，在 Windows/Linux 上点击`shift` + `control` + `J`或`F12`，或者在 macOS 上点击`option` + `command` + `J`或`fn` + `F12`，打开 devtools。

之后，点击**灯塔**标签。

![Click on Lighthouse](../Images/11119077ba23b729be5aee34e45ec3c9.png)

如您所见，您可以选择希望审计包括哪些类别。这些类别是性能、渐进式 Web 应用程序、最佳实践、可访问性和 SEO。您还可以选择是在移动设备上还是在桌面上运行审核。

在这一部分，我们将执行四项审计，分别是性能、最佳实践、可访问性和 SEO，我们将在桌面上运行它们。然而，为了达到最佳效果，在不同的条件下测试你的网页是很重要的——比如在手机上和不同的网速下。

因此，在您想要测量的网页上，继续选择提到的四个类别和桌面，然后单击**生成报告**。

![Click Generate Report](../Images/978833321f215fd4e66387af9a18d521.png)

这可能需要几分钟的时间，您会看到您的浏览器窗口可能会在此过程中增大和缩小。这是因为报告需要不同的屏幕尺寸和网页条件。一旦完成，Lighthouse 选项卡将包括审计结果，其中将包括性能、最佳实践、可访问性和 SEO 的得分。

![Lighthouse Score](../Images/3c06a1596efdda204d7b2a39b0bac7ce.png)

需要注意的是，根据您的互联网连接，有时结果会有所不同。此外，有时 Lighthouse 可以显示一个通知，说明某些扩展可能会影响结果。如果是这样，最好在一个隐蔽的窗口中运行测试。

当 Lighthouse 完成运行后，您可以点击任何类别来查看更详细的报告。

#### 表演

性能侧重于如何让你的网站加载更快。我们将讨论六个重要的绩效指标，每个指标的含义以及如何在每个指标上取得更好的成绩。

##### 第一幅令人满意的画(FCP)

第一幅内容丰富的图画 (FCP)是从用户导航到网页的那一刻开始计算的。它测量加载第一段 DOM 内容需要多长时间。DOM 内容可以包括图像、非白色画布元素和 SVG 元素。

FCP 是以秒计算的。为了让您的 web 页面获得“绿色”分数——这意味着快速 FCP——第一部分 DOM 内容最多需要 1.8 秒的加载时间。一旦超过这一点，它可以去或温和或缓慢。

FCP 重要的原因可以追溯到对用户的理解。如前所述，用户没有耐心，如果加载时间过长，他们会离开你的网站。快速的 FCP 让用户保持参与。它可以像一个加载屏幕一样简单，告诉用户耐心等待，因为网页很快就要加载了。

影响网站 FCP 时间的一个因素是字体。字体可能需要很长时间来加载，有时会使文本在加载之前不可见。解决这个问题的一个好方法是在使用`@font-face`声明字体时使用 CSS 属性`font-display: swap;`。例如:

```
@font-face {
    font-family: 'MyFont';
    font-style: normal;
    font-weight: 400; 
    src: url(MyFont.woff);
    font-display: swap;
} 
```

如果您使用的是 Google 字体，这个属性现在默认是启用的。该属性允许文本使用用户的系统默认字体显示，直到网站的字体被加载。

另一个影响 FCP 的因素是渲染阻塞资源。这些通常是 JavaScript 或 CSS 文件，它们在`<head>`中同步加载，需要很长时间才能加载。这些资源将迫使页面的其余部分在页面完全加载之前等待加载，从而影响 DOM 内容的 FCP。

以下是解决这个问题的一些方法:

*   **将`defer`或`async`属性**添加到您的`<script>`标签中。例如:

    ```
    <script src="myScript.js" defer></script> 
    ```

*   缩小页面上正在使用的 JavaScript 和 CSS 文件，减小其大小，这样加载这些资源就不会花太多时间。这取决于您使用的是什么框架或编程语言，但几乎所有的框架或编程语言都有这样做的方法。在 web.dev 网站上使用各种流行的框架时，你可以查看[关于如何简化 JavaScript](https://web.dev/unminified-javascript/) 的简单提示。

*   移除网页中未使用的 CSS 。随着 CSS 数量的增加，通过删除页面上不需要的规则和属性来减少 CSS 文件可以使页面加载更快。同样，基于你正在使用的[框架](https://web.dev/unused-css-rules/)，有不同的方法可以实现。然而，你可以使用 Chrome 的开发者工具在**覆盖**标签中查看未使用的 CSS。使用像 [Tailwind CSS](http://tailwindcss.com) 这样的框架——使用树摇动机制来减少你的 CSS 样式，而不是用许多你可能永远不会使用的样式来膨胀你的网站——可以帮助你的网站加载得更快。

*   **减少服务器的响应时间**。这可以通过使用异步请求执行页面加载所需的逻辑，缓存服务器经常使用的数据，或者优化服务器代码以更快地获得所需的结果来实现。

当您执行性能审计时，如果您的网页存在字体、内容阻止资源、未使用的 CSS 或上述其他问题，Lighthouse 将突出显示导致问题的每个文件，并给出如何改进的提示。例如，如果一种字体阻挡了文本的可见性，Lighthouse 将向您显示导致该问题的字体文件，以及解决该问题将如何加快页面的 FCP 时间。

下面是 GitHub 审计报告中的一个例子，它将一个 CSS 文件显示为“渲染阻塞资源”。

![GitHub Audit](../Images/ef28142ada107c4ee60b0304a382b776.png)

当您阅读其余的指标时，您会意识到它们在某种程度上取决于这个指标的结果。所以，在 FCP 取得好成绩很重要。

##### 互动时间(TTI)

**互动时间** (TTI)测量用户与网页完全互动所需的时间。TTI 的结果取决于 FCP，因为 FCP 越快，用户与网页的交互就越快。

用户不仅需要看到加载的页面，还需要能够与之交互。如果网站*看起来*满载，但用户却无法与之正常互动，那就更令人恼火了。例如，单击一个按钮不会做任何事情，即使它看起来可以在屏幕上使用。提高网站的 TTI 会让你的用户更容易使用你的网站，从而提高转化率。

为了使一个网页被认为是完全活跃的，它首先需要达到 FCP。然后，应该为页面上可见的元素注册事件处理程序。最后，页面应该能够在 50 毫秒内响应用户的交互。

一个网页的 TTI 是以秒计算的。对于一个具有良好 TTI 的网页来说，它最多需要 3.8 秒就可以完全交互。如果页面花费的时间超过这个时间，它将被认为是中等或缓慢的。

有几个因素会影响网页的 TTI 分数。最常见的是“主线程工作”和“JavaScript 执行时间”。

**主线程工作**是指浏览器渲染一个页面所花费的过程。对于呈现页面的浏览器，它首先解析 HTML，然后构建 DOM，解析 CSS，并执行 JavaScript。如果这个过程花费的时间太长，这意味着页面也需要很长时间来响应用户的交互，因为处理事件也是主线程工作的一部分。

JavaScript 执行时间包括获取脚本、解析脚本、编译脚本、执行脚本所需的时间，以及脚本可能使用的内存。如果获取脚本由于其大小而需要很长时间，那么解析和执行它将需要更长的时间。在获取脚本之后，解析和编译它发生在主线程工作中，因此如果花费很长时间，它将减慢主线程工作。如果脚本有很多代码要在页面加载时执行，这发生在主线程工作上，那么网页需要很长时间才能准备好供用户交互。

改进 TTI 指标与 FCP 非常相似，因为它首先依赖于它。好的做法是缩小 JavaScript 和 CSS 文件，删除其中任何不用的代码。您可以做的另一件事是将 JavaScript 和 CSS 文件分成包(通常使用捆绑器，如 webpack)。这意味着 web 页面可以更快地获取包，如果您还使用了`defer`属性，如前一节所述，它将更快地异步获取包。

##### 总阻塞时间(TBT)

这个和 TTI 在概念上非常相似。**总阻塞时间** (TBT)测量 FCP 和 TTI 之间各种任务阻塞用户交互的总时间。如果单个任务花费的时间超过 50 毫秒，那么它就被认为是阻塞的，此后的时间将被添加到总阻塞时间中。例如，如果某项特定任务需要 90 毫秒，那么 40 毫秒(即 90 毫秒–50 毫秒)将被添加到 TBT 总测量值中。

这个指标主要强调 TTI 测量的内容，特别关注哪些任务影响了页面的加载时间，以及它们的影响程度。

TBT 以毫秒为单位。为了得到一个好的 TBT 分数，你的网页上任务的总阻塞时间不应该超过 200 毫秒。

提高你的 TBT 分数，和 TTI 差不多。您需要最小化主线程工作并减少 JavaScript 执行。然而，随着 TBT 更多地关注代码执行的细节，额外的增强可以优化您的 JavaScript 代码，使其工作得更快。例如，当从文档中选择一个元素时，在您的选择器中要具体，而不是使用像`div`这样的通用选择器。更深入地研究你的代码，寻找任何改进代码的机会，这反过来会优化每项任务所花费的时间。

##### 最大含量涂料(LCP)

**最大内容绘画** (LCP)测量可视视口中最大元素加载所需的时间。考虑的元素有`<img>`、[、`<image>`、](https://developer.mozilla.org/en-US/docs/Web/SVG/Element/image)、`<video>`，有背景图像的元素，或者有文本和内联节点作为子元素的块元素。

如果某个元素是当前视口中最大的元素，则该元素被视为最大的元素。这不包括当前视口中未显示的元素的任何部分(例如，如果图像延伸到可见视口之外，则只有可见部分将被计算)，或者用 CSS 添加的边距、填充或边框。

由于视口中的最大元素会随着页面的加载而改变，因此将对网站中的每个新元素条目测量 LCP，直到用户能够与页面进行交互。因此，如果在页面加载时，最大的元素是一个包含文本的节点，但是加载的图像大于文本节点，那么 LCP 将改为针对图像进行测量。一旦用户可以与页面进行交互——如前所述，使用 TTI 进行测量 LCP 将停止测量任何新条目。

LCP 以秒为单位。一个好的 LCP 是最大的内容最多需要 2.5 秒来加载。

与 FCP 类似，LCP 也受到渲染阻塞资源的影响。它还受加载资源(例如，图像、CSS 文件等)所需时间的影响。影响 LCP 分数的另一个因素是服务器响应的时间。

为了改进 LCP，它类似于前面讨论的方法。推迟渲染阻塞资源、最小化 CSS/JavaScript 文件以及使用`font-display: swap`属性可以优化 LCP 分数。

此外，您可以做以下事情来提高您的网页的 LCP 分数:

*   将 CDN 用于图像和视频等资产。cdn 为资产提供服务的速度更快，因此 it 可以改善这些资产的“服务器响应时间”。

*   将图像压缩到较小的尺寸。这可以通过很多在线工具完成，比如 [Compress PNG](https://compresspng.com/) 。缩小图像可以减少加载图像的时间。

*   将您的图像转换为 WebP，因为它们比 PNG 和 JPEG 图像小。这也可以使用在线工具来完成。

*   根据设备的大小正确调整图像的大小。

要完成最后一项任务，您可以使用`<picture>`元素来包含基于设备宽度的图像。例如:

```
<picture>
  <source srcset="img-small.png" media="(max-width: 567px)" />
  <source srcset="img-medium.png" media="(max-width: 992px)">
  <img src="img.png" />
</picture> 
```

注意，为了指定媒体大小，我们使用了`<source>`标签并指定了`media`属性。然而，为了确保我们的网页支持所有的浏览器和用户代理，我们添加了`<img>`标签作为后备，以防浏览器不支持`<source>`。

因为总是调整大小和转换图像并不理想，所以一个很好的选择就是 [Cloudinary](https://cloudinary.com) 来帮你动态地做到这一点。Cloudinary [通过根据需要调整大小和转换来优化](https://cloudinary.com/products/media_optimizer)你的图像，他们提供了一个相当不错的[免费计划](https://cloudinary.com/pricing)。

自动化这个过程的另一个选择是使用像 [Gulp](https://www.sitepoint.com/introduction-gulp-js/#imagetask) 或 [webpack](https://webpack.js.org/plugins/image-minimizer-webpack-plugin/) 这样的工具。

例如，下图显示了在我的网站上运行的报告，其中包括一个关于图像大小的警告。

![Image Size Warning](../Images/469581acfe50d7b591ded130b97c13ef.png)

##### 速度指数

正如你可能从名字中猜到的那样，**速度指数**度量的是页面内容可见的速度。这是通过捕捉页面加载的视频，然后计算帧之间的视觉进展来完成的。

与其他度量类似，这个度量以秒为单位。为了有一个好的速度指数，你的页面应该在开始加载后的 3.4 秒内加载它的内容。

这个指标在很大程度上依赖于前面提到的指标。如果你的网页有任何上述问题，比如图片没有压缩，样式和脚本没有缩小和优化，或者大量工作发生在主线程上，你的网页速度指数就会下降。这些问题会延迟页面内容的可见性。为了提高你的速度指数，努力改进已经讨论过的问题。

##### 累积布局偏移(CLS)

**累积布局偏移** (CLS)测量页面在完全加载之前的布局变化次数。例如，有多少次，当页面加载时，用户试图点击一个按钮，结果内容移动，导致用户点击其他地方？这可能非常烦人，有时会导致用户执行他们实际上并不打算执行的操作。

每一次布局变化都被称为布局偏移。CLS 测量了一秒钟内发生的多种布局变化。所以，如果你的网页有很多布局变化，它会有一个糟糕的 CLS 评分。CLS 分数越低越好。一个网页的 CLS 分数应该在 0.1 或以下才算快。

以下是一些避免布局偏移的技巧，这样可以降低和提高页面的 CLS 分数:

*   设置图像或视频的`height`和`width`属性，这样即使它需要很长时间加载，它也不会在加载后移动它周围的内容。当设置这些属性时，在加载资源时，该高度和宽度的空间仍将保持不变，并且其周围的内容在加载时不会受到影响。

*   避免使用弹出窗口或任何覆盖元素，除非它们在用户与页面交互时出现，例如，当用户单击按钮时。

*   当有必要移动元素时，使用变换动画，这向用户表明布局变化即将发生，而不是让他们措手不及。

##### 性能指标对搜索控制台的影响

谷歌的[搜索控制台](https://search.google.com/search-console/about)是了解你的网站在搜索引擎中表现的一个很好的工具。你可以看到很多关于你的网站的搜索引擎优化的信息，包括你的网站在哪些查询中排名较高，用户通过执行搜索查询找到了哪些页面，以及你的网页排名有多高。

如果你在谷歌的搜索控制台上有一个帐户，并把你的网站添加到其中，你会注意到，在侧边栏中，有“核心网络生命”。

[Web Vitals](https://web.dev/vitals/) 由谷歌创建，旨在简化改善网站用户体验的过程，并使之统一。核心网络生命体征是网络生命体征的子集。它们是最重要的指标，因为它们适用于所有网站，结果将出现在所有的谷歌工具中。在撰写本文时，核心网站由 FCP、LCP 和 CLS 组成。然而，随着改善用户体验和性能的研究正在进行，该列表预计将[扩展](https://web.dev/vitals/#evolving-web-vitals)。

![Core Web Vitals](../Images/ed41941bce14c24b336716b31167eb00.png)

此页面显示当通过搜索引擎找到您的网站的用户使用性能审计的重要指标时，这些指标如何达标，如果网页的指标较低，它会将它们显示为较差的 URL 或需要改进的 URL。

核心重要指标是 FCP、LCP 和 CLS。如果您的网站或网页在这些指标中得分较低，不同级别的警告将显示在您网站的核心 Web Vitals 报告中。下图展示了 LCP、CLS 和其他问题将如何出现在谷歌的搜索控制台中。

![Core Web Vitals Warnings](../Images/b37362da96ef8114bb48006c7a4415df.png)

根据谷歌的说法，一个网站的页面体验报告，考虑了移动可用性问题和核心重要指标，被用作 URL 的“排名”信号。这意味着，如果一个网页的核心生命指标较低，它在搜索结果中的排名会较低。因此，在这三项指标上取得好成绩非常重要。

#### 易接近

Lighthouse 执行的下一个审计是可访问性。辅助功能确保您的用户可以通过不同的设备、硬件或工具访问您的网站。它还确保残疾用户能够像其他用户一样访问您的网站。可访问性允许不同用例的用户访问你的网站，而不影响他们的体验。

以下是一些确保良好的可访问性得分的提示:

*   确保您的网站包含可访问的富互联网应用程序(ARIA)属性。这包括使用像`aria-checked`、`aria-labelledby`、`aria-describedby`等属性。你可以在教程“[使用 WAI-ARIA](https://www.sitepoint.com/wai-aria/) 提高网站的可访问性”中了解更多关于 ARIA 以及如何在网站中使用属性的信息。

*   使用 ARIA 属性时，请确保使用正确。例如，`aria-disabled`——表示输入是否被禁用——不应该与`<div>`这样的元素一起使用。

*   确保元素的 id 是唯一的。

*   不要在`<body>`元素上使用`aria-hidden`。

*   确保文档有一个`title`元素。

可访问性审计涉及许多细节。当您执行审计时，如果有任何问题，Lighthouse 会为您突出显示这些问题，这些问题是在哪些元素上发现的，以及可能的修复方法。

![Accessibility Audit](../Images/9f38f0220eae99c782448c4eca60e601.png)

#### 最佳实践

最佳实践审核可确保您的网页遵循指导原则，使网站适合用户使用。这些可以确保当你的用户使用网站时，他们不会受到任何可能导致糟糕体验的安全问题或错误的攻击。

以下是一些确保获得良好最佳实践分数的提示:

*   确保浏览器控制台中没有记录任何错误。这意味着如果你网站上的任何页面有错误——无论是链接无法加载还是代码中的错误——你应该修复它们，这样它们就不会再发生了。

*   确保在 HTML 文档的顶部有`<!DOCTYPE html>`。

*   用 HTTPS 保护你的网站。即使您的网站不处理敏感数据，确保您的网站对所有用户来说都是安全的，这通常是一个好的做法。

*   确保您的图像以正确的纵横比呈现。例如，正方形图像不应该以矩形纵横比呈现。

这些只是将提高您的最佳实践分数的一些最佳实践技巧。当您在网页上运行测试时，您将会看到是否有任何问题需要解决。

![Best Practices Audit](../Images/8079b22a1cfe1a7e1173f4a5cc7197c8.png)

#### 搜索引擎优化

搜索引擎优化审计衡量所有不同的做法和准则，以确保您的页面在搜索引擎中排名良好。提高这次审核的分数是提高网站 SEO 的良好开端。

以下是一些提高网页搜索引擎优化分数的技巧:

*   确保你的网页有`<title>`元素，并且在网页的`<head>`中有好的`meta`描述。

*   确保你的网页的字体大小在不同的屏幕上是可读的。不要把它们做得太小！

*   不要使用带有文本“这里”或“阅读更多”的链接，而要使用描述性的文本，让用户明白他们要去哪里。例如，如果你的链接指向你的 Instagram 帐户，文本应该是“支持我的 Instagram 帐户”。

*   确保你的网站包含一个`robots.txt`文件，因为搜索引擎用它来抓取你的网站。你可以在谷歌的[创建一个 robots.txt 文件教程](https://developers.google.com/search/docs/advanced/robots/create-robots-txt?visit_id=637605816478470587-1744963519&rd=1)中了解更多关于如何创建一个好的`robots.txt`文件。

如果你的搜索引擎优化有任何问题，你的审计报告会告诉你是什么问题，以及你如何解决这些问题。

应该注意的是，Lighthouse 提供的结果通常不足以确保您的 SEO 策略都相应地工作。但这仍然是一个很好的起点。

### 使用 CLI

另一种检查网页分数的方法是使用 Lighthouse 的 [CLI 工具](https://github.com/GoogleChrome/lighthouse)。CLI 工具允许您使用更多选项来提高报告的准确性。

在安装 CLI 工具之前，请确保您已经安装了 [Chrome](https://www.google.com/chrome/) 。还有，你需要安装 [Node.js](https://nodejs.org/en/download/) ，而且必须是 12 版以上。

要检查 Node.js 版本，请运行以下命令:

```
node -v 
```

如果一切正常，您现在可以使用以下命令安装 Lighthouse 的 CLI 工具:

```
npm install -g lighthouse 
```

安装完成后，您可以使用以下命令运行 Lighthouse 的分析:

```
lighthouse <PAGE_URL> 
```

这里，`<PAGE_URL>`是您想要生成报告的页面的 URL。一旦你运行这个命令，你会注意到 Chrome 会打开几次，使用不同的窗口大小。您还可以在终端中看到正在执行的每个测试的详细分析。

审计完成后，带有结果的 HTML 文件将保存在运行命令的当前目录中。如果你在任何浏览器中打开它，你会看到类似于我们在 Chrome 中使用 Lighthouse 得到的结果。

#### 选择

以下是一些您可以添加的有用选项:

*   默认情况下，CLI 工具将对宽度为 360 像素、高度为 640 像素、设备比例系数为 2 的移动设备执行审核。要禁用所有这些默认值，也就是说，要在与您的桌面屏幕的宽度和高度相匹配的设备上执行审计，您可以添加选项`--screenEmulation.disabled`。要改变仿真的宽度和高度，你可以使用选项`--screenEmulation.width`和`--screenEmulation.height`。

*   要打开报告进行查看，在测试完成后，立即添加选项`--view`。

*   可以用`--port`指定端口，用`--hostname`指定主机名。

*   要指定想要运行的类别，请使用选项`--only-categories`，例如`--only-categories=performance,seo`。

*   要指定您想要运行的审计，请使用选项`--only-audits`。要排除某些审计，请使用选项`--skip-audits`。

*   要指定输出类型，使用`--output`。值可以是“json”、“html”和“CSV”——例如，`--output=json,html`。

*   要向执行的请求添加头，使用`--extra-headers`，其中的值是一个字符串，例如`--extra-headers "{\"Accept\":\"application/json\"}"`。

*   要阻止页面中对某些 URL 的请求，请使用`--blocked-url-patterns`。

如果你愿意，还有[更多选项和配置](https://github.com/GoogleChrome/lighthouse#cli-options)供你查看。

### 使用网页测试

与使用 Chrome 或 CLI 相比，WebPageTest 可以提供更高级、更详细的结果。虽然它不是由谷歌创建的，但它仍然可以对您的网站在不同场景下的性能进行深度分析，例如使用特定设备访问您的网站或使用较慢的互联网连接。

要执行测试并生成报告，请打开[网页测试](https://webpagetest.org/)，并在文本字段中输入您想要测试的 URL。

![WebPageTest](../Images/f084adf01d5b4073a2ed3901b047a3f9.png)

您还可以指定测试位置，因为不同的测试位置会提供不同的测试设备。

此外，如果向下滚动，您可以指定高级设置。在这些设置中，您可以选择不同的互联网连接。这是非常有用的，因为它帮助你了解你的网站如何根据不同的用户运行，比如那些有快速和慢速互联网连接的用户。您还可以指定屏幕尺寸，并捕捉测试视频。

有许多其他的设置允许你在不同的条件下测试你的站点。您可以通过在选项卡之间切换来浏览不同的设置。

![Additional Settings](../Images/000512e77bc7e9b7e5c4e4c7d949cf05.png)

完成后，点击**开始测试**。该测试可能比其他方法需要更长的时间，因为它提供了比我们以前做过的测试更多的细节。完成后，您将首先看到我们之前指定的指标的一般结果，包括 FCP、TBT、速度指数等。您还可以看到每次运行的屏幕截图(默认情况下，会执行三次运行，但是您可以在前面表单的高级设置中进行更改)。

![Test Summary](../Images/146c36913acfca37e2346275d96b170b.png)

除摘要外，您还可以点击**详细信息**选项卡查看更多详细信息。这将显示详细信息，包括每个资源的加载时间、加载时间、加载每个资源所用的头文件等等。

在 **Performance** 选项卡下，您可以看到有关图像压缩、图像格式、CDN 资产等的详细信息。您可以使用这些细节来确定如何改进您在网站中使用的资源，这反过来可以改进网站的加载时间和性能。

WebPageTest 提供了更多关于您的网站分数的详细信息，以及它在使用不同设备、互联网连接速度或任何其他可能影响用户体验或网站性能的因素时的表现。这使得 WebPageTest 成为详细分析您的网站在不同条件下的表现的绝佳选择。对于一些开发者来说，这可能有些高级，所以在 Chrome 上使用 Lighthouse 肯定更容易。

## 结论

提高网站的性能是开发过程中必不可少的一步。不应该忽视或掉以轻心。提供一个快捷、易访问、在搜索引擎中表现良好的网站可以提高网站的流量，增加注册人数或销售额。Lighthouse 是一个很棒的开源工具，它提供了全面的见解和分析，可以帮助您改进网站并吸引更多用户。

要获得更多关于提高网站性能的最佳实践的重要提示和建议，请务必查看 SitePoint 的*[Jump Start Web Performance](https://www.sitepoint.com/premium/books/jump-start-web-performance/read/1/)*。

## 分享这篇文章