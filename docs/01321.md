# 普通 JavaScript 中的 MVC 设计模式

> 原文:[https://www.sitepoint.com/mvc-design-pattern-javascript/](https://www.sitepoint.com/mvc-design-pattern-javascript/)

![A developer with a laptop in front of the Hollywood sign - The MVC design pattern](../Images/6e94c68a857931c9e97f1ef27ef4fe23.png)

设计模式经常被整合到流行的框架中。例如，[模型-视图-控制器(MVC)](https://developer.chrome.com/apps/app_frameworks) 设计模式是一种无处不在的模式。在 JavaScript 中，很难将框架与设计模式分离。通常，一个特定的框架会有它自己对这种设计模式的解释。框架伴随着观点而来，每一个都迫使你以某种方式思考。

现代框架规定了 MVC 模式的具体实现是什么样子。当所有的解释都不同时，这是令人困惑的，这增加了噪音和混乱。当任何代码库采用一个以上的框架时，都会产生令人沮丧的混乱。我脑子里的问题是，有没有更好的办法？

MVC 模式适合客户端框架，但是现代框架会发生变化。今天的现代会随着时间的流逝而消亡。在这一次，我想探索替代方案，看看一点点纪律会把我们带到哪里。

就其本身而言，MVC 模式可以追溯到几十年前。这使得它成为一个很好的设计模式，可以投资你的编程技能。MVC 模式是一种独立的设计模式。问题是，这能让我们走多远？

## 等等，这是另一个框架吗？

首先，我想消除这个普遍的误解:设计模式不是框架。设计模式是解决代码问题的一种训练有素的方法。有一个必要的技能水平，并把责任放在程序员身上。设计模式分离关注点并促进干净的代码。

框架是不同的，因为它不必遵循任何设计模式。区分框架和模式的一个方法是寻找好莱坞原则。好莱坞的原则是，“不要打电话给我们，我们会打电话给你。”任何时候都有一个依赖决定了你什么时候使用它，它就是一个框架。框架很像好莱坞，因为你没有发言权去做什么或者如何去做。事实上，开发人员就像演员一样，因为他们在被要求表演时会遵循剧本。

有充分的理由避免客户端框架:

*   框架增加了解决方案的复杂性和风险
*   您经历了依赖锁定，这导致[不可维护的代码](https://github.com/Droogans/unmaintainable-code)
*   随着新的流行框架的出现，很难重写现有的遗留代码

## MVC 模式

MVC 设计模式出现于 20 世纪 70 年代的施乐 Smalltalk 研究项目，并延续到 80 年代。这种模式经受住了前端图形用户界面的时间考验。这种模式来自桌面应用程序，但已经证明对 web 应用程序也是有效的。

在它的核心，MVC 设计模式是关于关注点的清晰分离。我们的想法是让解决方案变得易懂和吸引人。任何希望进行特定更改的程序员都可以轻松找到正确的位置。

## 企鹅演示

企鹅！可爱又令人想抱抱，是这个星球上皮毛最丰富的生物之一。太可爱了，事实上，有 17 种不同的企鹅并不都生活在南极环境中。

企鹅演示时间到了！我会在一页上展示几个物种。为此，我想使用 MVC 设计模式和一点原则。我将使用[极限编程](http://www.extremeprogramming.org/)方法，通过单元测试来解决手头的问题，没有废话。最后，你应该能够翻阅几只企鹅，每只都有自己的数据和资料图片。

到本例结束时，您应该已经学会了在普通 JavaScript 中使用 MVC 设计模式。模式本身是超级可测试的，所以期待好的单元测试。

出于跨浏览器兼容性的原因，我将坚持在这个演示中使用 ES5。在这种常年设计模式中使用经过验证的语言特性是有意义的。

你准备好了吗？让我们找出答案。

### 骷髅

演示将由三个主要部分组成:控制器、视图和模型。每一个都有自己的关注点和需要解决的问题。

这看起来像下面的视觉效果:

![Demo of Penguins Visual](../Images/cf4e7d36dfb93f6e11aa27afa5f0da74.png)

`PenguinController`处理事件，是视图和模型之间的中介。它计算出当用户执行一个动作(例如，点击一个按钮或按下一个键)时会发生什么。客户端特定的逻辑可以放在控制器中。在一个更大的系统中，有很多事情在进行，你可以把它分成模块。控制器是事件的入口点，也是视图和数据之间唯一的中介。

`PenguinView`关心 DOM。DOM 是用于 HTML 操作的浏览器 API。在 MVC 中，除了视图，没有其他部分关心*改变*DOM。视图可以附加用户事件，但是将事件处理问题留给控制器。视图的主要指令是改变用户在屏幕上看到的内容的状态。对于这个演示，视图将用普通的 JavaScript 进行 DOM 操作。

`PenguinModel`关心数据。在客户端 JavaScript 中，这意味着 Ajax。MVC 模式的一个优点是，现在服务器端 Ajax 调用只有一个位置。这使得它对不熟悉该解决方案的程序员同事很有吸引力。这种设计模式中的模型只关心 JSON 或来自服务器的对象。

一种反模式是违反这种内在的关注点分离。例如，模型必须不关心 HTML。视图必须不关心 Ajax。控制器必须充当中介，而不用担心实现细节。

我发现这种模式是开发人员从良好的意图开始，但是泄漏了关注点。把所有东西都变成 web 组件并以一片混乱告终是很诱人的。重点放在功能和面向用户的问题上。但是，功能关注和功能关注是不一样的。

在编程中，我喜欢功能关注点的清晰分离。每个独立的编程问题都有一致的解决方法。这使得你在阅读代码时更容易理解。这个想法是编写有吸引力的代码，这样其他人也可以做出积极的贡献。

如果没有一个你可以看到和触摸到的真实的例子，它就不是一个演示。所以，事不宜迟，下面是一个展示企鹅演示的代码笔:

在 [CodePen](https://codepen.io) 上通过 SitePoint ( [@SitePoint](https://codepen.io/SitePoint) )看 Pen [一个企鹅](https://codepen.io/SitePoint/pen/RgEoOe/)的演示。