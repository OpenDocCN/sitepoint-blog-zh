# 二进制文件也属于数据库

> 原文：<https://www.sitepoint.com/binaries-belong-in-the-database-too/>

人们在互联网上看到的一个经常重复的建议是“不要在数据库中存储二进制文件。保存一个指向该文件的指针，并将其保存在磁盘上。表面上的原因是，存储二进制文件是因为文件系统在存储和检索文件方面比数据库更有效。这是一个有效的参数，尤其是在处理非常大的文件时。但是我认为在数据库中存储文件有很多好处，这些好处很容易超过这个问题，特别是对于动态的、数据驱动的网站。

最大的优势是数据库通常支持事务，并且符合 ACID。这意味着如果上传文件有问题，用户可以很容易地取消整个更新并回滚到以前的状态。与处理文件系统不同，在文件系统中，用户必须手动清理自己造成的混乱。此外，当使用数据库作为文件的后备存储时，您不必担心文件名冲突。

备份是另一个巨大的优势。如果您的应用程序已经将内容存储在数据库中，那么将二进制附件存储在那里也很有意义。您的备份例程变得简单多了，因为您只需要备份一个数据库，而不必担心磁盘上的一些任意文件夹。您的恢复例程也变得非常简单，因为您只需要恢复数据库，而不是数据库以及文件系统的一些部分。作为一名开发人员，当您需要下载站点的“当前”副本以进行一些维护工作时，这就非常方便了。

从安全的角度来看，也有巨大的优势。如果您的应用程序不需要写入文件，您可以使用文件系统权限轻松禁止它写入磁盘。无法将恶意文件写入磁盘使得许多攻击变得不可能。此外，由于您使用服务器端语言来处理文件，防止未经授权的用户窃取您的文件变得更加容易，因为他们可以很容易地通过您的正常安全补丁。此外，因为没有人需要上传文件，人们可以经常完全禁用 FTP 访问。FTP 是当今最不安全的服务。

最后，根据数据库平台的不同，人们可以用基于数据库的文件存储做一些非常巧妙的事情。在 Sql Server 中，用户可以对现成的 Html 或 Word 文档进行全文搜索。安装 [PDF IFilter](http://www.adobe.com/support/downloads/detail.jsp?ftpID=2611) 允许在 PDF 上进行相同类型的搜索。还有其他 IFilters 可用于多种类型的文件。用户喜爱全文搜索。

如上所述，使用数据库存储二进制文件显然会产生一些开销。最重要的一点是，数据库连接非常昂贵，从数据库中提取数百 KB 的数据确实需要打开很长时间。但是使用缓存很容易解决这个问题，要么缓存到磁盘上的一个临时文件夹中，要么缓存到内存中。

所以，下一次有人告诉你在 RDBMS 中存储文件是疯狂的，告诉他们他们在磁盘上存储文件是疯狂的。

## 分享这篇文章