# 谁需要图形？在 SQL 中创建图表

> 原文：<https://www.sitepoint.com/sql-pie-chart/>

这是我见过的最令人印象深刻的 SQL 演示之一。来自以色列的数据库顾问 Shlomi Noach 开发了一个简单的 SQL 查询来分析一个表格，并以 ASCII 艺术形式生成一个饼图。

Shlomi 的博客文章 [SQL 饼状图](http://code.openark.org/blog/mysql/sql-pie-chart)，提供了一个完整的一步一步的分析它是如何实现的。总而言之:

1.  检查单个表中的值，并计算累计总数。
2.  根据累积总数，在 0 到 1 的范围和 0 到 2 *π的范围内计算累积比率(整圆的弧度)。
3.  然后创建一个坐标表。这从左上角的零开始，在适当的值中增加到右下角的最大值。
4.  坐标表用于生成相对于表中心的度数表。
5.  然后，原始表数据被映射到 degrees 表，为每种“颜色”分配一个 ASCII 字符，圆圈外的任何内容都被设置为一个空格。
6.  最后补充一个图例。

```
+----------------------------------------------------------------------------------------------+
| pie chart                                                                                    |
+----------------------------------------------------------------------------------------------+
|                                                                                              |
|                                   ;;;;;;;;;;;;;;;;;;;;;;;;;                                  |
|                          oooooooo;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                         |
|                    ooooooooooooooo;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                   |
|                oooooooooooooooooooo;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;               |
|             oooooooooooooooooooooooo                     ;;;;;;;;;;;;;;;;;;;;;###            |
|           oooooooooooooooooooo                                 ;;;;;;;;;###########          |
|         oooooooooooooooooo                                         ##################        |
|       ooooooooooooooooo                                               #################      |
|      ooooooooooooooooo                                                 #################     |
|      oooooooooooooooo                                                   ################     |
|     oooooooooooooooo                                                     ################    |
|      oooooooooooooooo                                                   ::::::::::::::::     |
|      ooooooooooooooooo                                                 :::::::::::::::::     |
|       ooooooooooooooooo                                               :::::::::::::::::      |
|         oooooooooooooo::::                                         ::::::::::::::::::        |
|           ooooooo:::::::::::::                                 ::::::::::::::::::::          |
|             ::::::::::::::::::::::::                     ::::::::::::::::::::::::            |
|                :::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::               |
|                    :::::::::::::::::::::::::::::::::::::::::::::::::::::::                   |
|                          :::::::::::::::::::::::::::::::::::::::::::                         |
|                                   :::::::::::::::::::::::::                                  |
|                                                                                              |
| ##  red: 1 (10%)                                                                             |
| ;;  blue: 2 (20%)                                                                            |
| oo  orange: 3 (30%)                                                                          |
| ::  white: 4 (40%)                                                                           |
+----------------------------------------------------------------------------------------------+

```

正如您可能想象的那样，结果查询有点长且复杂。我不会在这里复制它，但是如果你想自己尝试的话，Shlomi 的帖子提供了代码。

非常聪明。完全疯了。

你见过其他奇怪的 SQL 查询的例子吗？在下面张贴您的链接…

## 分享这篇文章