# Dmitry Baranovskiy 谈论拉斐尔

> 原文:[https://www . site point . com/Dmitry-baranovskiy-talks-about-Raphael/](https://www.sitepoint.com/dmitry-baranovskiy-talks-about-raphael/)

**[德米特里](http://dmitry.baranovskiy.com/)是神奇的[拉斐尔](http://raphaeljs.com/) JavaScript 库的作者，我在《科技时报》第 205 期讨论过这个库。在 [Web Directions South](http://south08.webdirections.org/) ，我设法听到了[他的介绍](http://south08.webdirections.org/?page_id=7#post-39)，并聊起了拉斐尔是如何诞生的。**

是的，我想我的第一个问题应该是:你为什么要写拉斐尔？是什么启发了你写它？

我在做一个联邦快递的项目。在 [Atlassian](http://www.atlassian.com/) 内部，我们有联邦快递日，给你时间展示你正在做的项目。

联邦快递日-你说什么？

它被称为“联邦快递”，因为你必须递送一些很酷的东西。你在一个小的比赛中展示它(这不是为了大奖——更多的是为了好玩)，当然它应该与你从事的项目有关。因为我是一名前端工程师，而其他人都是 Java 开发人员，所以我想我应该专注于一个能给人留下深刻印象的前端项目。很难打动后端开发者。

所以我想我应该做一些程序员可能不知道的事情，因为我以前有过使用 SVG 的经验，所以使用 SVG 是有意义的。但是，作为一名前端开发人员，我关心的是创建一些只在 Firefox 中工作的东西，所以我想在 IE 上为 VML 创建一个桥梁。我最初的项目是创建一个图表应用程序，像一个简单的折线图。我很快从零开始用一天半的时间把它敲起来，给它看，但它什么也没赢。没有打动人。

一点也不？

哦，可能有一点，但不是全部。所以我把它放了一段时间。然后我们开始我们的 20%项目(就像谷歌一样)。我决定接下这个项目，并把它扩展一点。我去掉了制图部分，把它变成了一个通用的绘图库。只是 SVG 和 VML 之间的桥梁，使我能够做更多酷的东西，而不用担心浏览器的兼容性。

所以在接下来的联邦快递日，我用这个库创建了一个类似于 [Skitch](http://skitch.com/) 的应用程序。你可以拍一张照片，然后加上箭头和省略号之类的东西。它甚至挽救了形象，但显然这不是最难的部分。

然后我开始在这个 20%的项目上多下功夫。老实说，我每周花的时间不止一天:我在火车上用笔记本电脑工作——上班一小时，回来一小时——一般每周两天，大约一个月。然后我决定发布它已经足够好了，因为在另一个开发者发布同样的东西之前这样做更好。所以，我在八月中旬发布了它。

我被反馈惊呆了。老实说，我没想到会这样，因为我在我的博客上写了这件事，我通常每天会有大约 20 次点击；但在它发布并登上[美味](http://delicious.com/)和 [Reddit](http://www.reddit.com/) 的首页后，我每天有大约 8000 次点击。它占用了我的带宽，我不得不创建一个新的域名。它实际上开始花费我的钱！

那么你在 Atlassian 的工作中真的会用到它吗？

还没有，但我们计划将它集成到产品中，用于制图等，但目前为止我们还没有找到它的许多用例。我个人认为人们有点害怕这项技术。但我希望它能找到一个地方。它还是很生的。所以展示概念，玩得开心，到处做点事情就够了。我总是在找 bug(尤其是 IE 的 bug)，所以它还没有真正地、绝对地准备好。嗯，才一个月。

你想在哪里看到它被使用？

哦，好吧，到处都是。统治世界是我的目标！当然，人们首先想到的是图表，这也是我产生这个想法的原因，但我想展示的是，图表只是一个明显的部分。你可以用它来给页面添加一些效果，比如图像的旋转。

比方说，如果你在 Flickr 上，你想把一张图片旋转 90 度，因为你是从侧面拍摄的。目前，你按下一个按钮，它发送请求到服务器，服务器做旋转，发送回来，你看到旋转的图片。相反，您可以使用 Ajax 只发送基本信息:向右旋转 90%,在客户端上您会看到向右旋转的平滑动画。由于显而易见的原因，这对用户来说会是一种更愉快的体验。

如果没有它，实现起来会有点复杂，因为你必须把 IE 版本和其他浏览器的版本分开。事实上，这就是我创建拉斐尔的全部原因——你在 FireFox 和 IE 中做一些事情，它就能正常工作。它还没有完全实现，但它正在实现。

当我做我的演示时，我确实注意到一个障碍。在所有非 IE 浏览器中，你可以创建一个路径，然后避免指定填充颜色，它只会画出一条线。但是在 IE 中，如果你没有指定填充颜色，它会选择白色，并开始尝试填充白色。

是的，我修好了。

哦，真的吗？太好了，太棒了。因为我将填充不透明度设置为 0。

是的，我注意到了这一点，当我看代码的时候，我想“哦，你为什么用不透明来填充呢？”所以我开始到处玩，想“啊，是的，哦，好吧。”

嘿，谢谢！

是啊，我在 IE 测试的时候经常发现 bug。SVG 和 VML 是完全不同的语言。你不能真的用一个代替另一个。有时候，在 IE 中做一些在 SVG 中容易做的事情是不可能的。所以我必须找到一个折中的解决方案。我不能为你做不到的事情提供 API。

例如，在 SVG 中你可以围绕一个点旋转一个对象，而在 IE 中旋转是非常不稳定的；不能指定点。它围绕着某个神奇的中心旋转，而这个中心点非常随意地位于…嗯，我不知道它是什么的中心。我发现如果你把一个物体放在一个组里，它会成为这个组的中心，它会对物体做一些杂耍，它们会在这个地方跳来跳去。所以我已经成功地让所有的物体在所有的实现中绕着它们的中心旋转，但是人们问我他们是否能指定旋转的点。我说“哦，是的，我希望。”所以，还没有，但也许以后。我希望做这件事，但是做起来并不容易。在 SVG 中这很容易；它是内置的。但在 VML 不是这样。

SP:我认为这可能是 raphal 的一个弱点，但也是一个优点，如果你在处理任务时考虑如何使用 raphal API，那么你就可以避免这类问题。

嗯，也许，某种程度上…嗯，例如，我试图实现一个模糊效果，你可以在浏览器，火狐和 Opera 中完成，但 Safari 不支持它，令人惊讶。一旦我发现我不能在所有浏览器上做某事，我就不会把它添加到 API 中。一旦 Safari 支持它，我就会把它放进去。但是现在没有意义，因为拉斐尔的全部意义在于你写了它，它就工作了。啊，我希望它会。在版本 1 中应该是这样的。

它还可以帮助你理解，你知道，如果你试着做一些事情，你说“我能做这个跨浏览器吗？”答案很可能是“不”。当然，当我创建拉斐尔时，我试图涵盖尽可能多的功能，所以如果我删除了某个东西，我删除它是有原因的。也许我以后会想办法做，也许在 ie 浏览器里没办法做。

有时我在 SVG 中做一些额外的计算来模拟 IE 的功能。如果我有选择的话，我可能会把额外的计算添加到 SVG 端，因为 JavaScript 引擎在浏览器中比在 IE 中更快。例如，如果你不得不妥协，在 IE 中进行计算，或者在 Firefox 中进行计算，那么最好在 Firefox 中进行计算，这样会更快，而且用户不会注意到。如果在 IE 里做，会比较慢，IE 用户会不爽。

我和 SitePoint 的一些开发者交谈过，我们中的一些人一致认为，使用 SVG 和 JavaScript 驱动的 VML 很容易取代 Flash。

我不会轻易说。有些东西是 Flash 擅长的，比如流媒体视频和动画。但是，如果你看看，比如说，谷歌分析图表，我看不出有什么理由不能用拉斐尔来做。

昨天早上，我试图重现谷歌图表的功能。我是在火车上做的；这真的很容易做到，而且它可以直接跨浏览器工作。当然，要做到这一点，你的团队中需要一个 JavaScript 开发者，他会使用像 Raphaë这样的程序，或者像我在演讲中提到的， [excanvas](http://excanvas.sourceforge.net/) ，或者 [dojox](http://dojotoolkit.org/projects/dojox) 。老实说，我认为拉斐尔有更正确的方法。它可能还没有得到很好的开发，但是那些其他的库没有正确地使用它。他们把 canvas、SVG 和 VML 混合在一起，canvas 完全不同。SVG 和 VML 在意识形态上是一样的。嗯，在某种程度上，我想。

我不认为它会取代 Flash，但是如果在某些任务中你可以用 SVG 代替 Flash，我会很高兴看到这一点。一些本地的东西，一些你可以破解的东西——整个开放网络的概念。SVG，甚至 VML，都比 Flash 开放。你可以破解它，你可以查看源代码，什么都可以。当然，Flash 不能在 iPhone 上运行。这是使用原生浏览器技术的另一个原因。我说的不是拉斐尔。我认为 SVG 是很多事情的发展方向。

关于 Raphaë，可访问性的问题出现了很多，尽管当我看你的演示时，你倾向于坚持不引人注目的 JavaScript 的理念。

当您谈到图像和图表时——无论 SVG 产生什么，它始终是一个图像，无论动态与否——它始终是一个可访问性问题。在我的演讲中，我们谈到了屏幕阅读器应该如何阅读 SVG 他们应该如何阅读圆，椭圆，以及它们的组合。即使您有一个好的解析器，可以读取您在页面上创建的形状，您也无法判断这些形状实际上创建了什么:最终的图像。如果用户是盲人，这真的很复杂，也很难解释。比如，你会如何向盲人用户解释 Web Directions 徽标？我不认为屏幕阅读器能够做到这一点。

所以这完全取决于开发人员如何正确地完成它。例如，在我的图表中，页面上有一个表格。屏幕阅读器可以看到该表，如果关闭了 JavaScript，也可以看到该表。您仍然可以访问数据；它没有那么漂亮，没有那么丰富的视觉效果，但你仍然可以阅读和理解。

我觉得不是 SVG 的问题，也不是 Raphaë的问题；我认为这是一个普遍的问题，已经有很多关于如何处理它的文章和书籍。

**SP:非常感谢，很高兴与您交谈**

别担心。

## 分享这篇文章