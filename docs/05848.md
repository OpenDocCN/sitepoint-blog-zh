# 在开源项目中使用 Git

> 原文:[https://www.sitepoint.com/using-git-open-source-projects/](https://www.sitepoint.com/using-git-open-source-projects/)

如果你作为团队的一部分开发软件，不管团队的规模有多大，你可能都使用过源代码管理(SCM)系统，无论是 [Subversion](http://subversion.apache.org/) 、 [Mercurial](http://mercurial.selenic.com/) 、 [Bazaar](http://bazaar.canonical.com/en/) 、 [Git](http://git-scm.com/) 还是其他。每个组织都有自己的提交代码的指导方针——从要遵循的风格指南到要写什么测试。

在这篇文章中，我将解释许多开源组织在使用 Git 时遵循的一般准则，从一些关于开源的一般性讨论开始。

## 经典的方式

直到几年前，大多数组织还通过电子邮件接受对其开源项目的贡献。他们将中央存储库托管在一个公共服务器上，你可以在那里克隆代码。在添加和提交更改时，必须生成一个补丁，以便通过电子邮件发送。如果要进行更改，必须生成新的补丁。这个过程非常笨拙，但是仍然被许多大组织使用。

在过去的几年里，Subversion、Mercurial 和 Bazaar 非常流行。那么为什么现在似乎只看到 Git 的使用呢？

## Git 的出现

GitHub 的推出让开发者的生活变得更好。它消除了通过电子邮件交流的需要，使代码审查变得非常容易。在 GitHub 中，大量的 Git 特性被赋予了 web 接口，导致许多组织转向 Git。

因此，大量开源组织已经从 Subversion 或 Mercurial 转向 Git(尽管 [Mercurial 仍然是脸书](https://code.facebook.com/posts/218678814984400/scaling-mercurial-at-facebook/)的首选，因为它每天都有大量的提交)。随着代码现在通过 GitHub 托管在云中，贡献的过程已经发生了显著的变化。

## “分叉”的概念

如果您想要直接为项目做贡献，那么如果您拥有对存储库的写访问权限，就可以推送变更。然而，出于安全考虑，写访问权限只提供给项目的长期贡献者。那么你如何做出贡献呢？

GitHub 为此引入了[分叉](https://help.github.com/articles/fork-a-repo)的想法。fork 是您自己的中央存储库的副本，在那里您有完全的写访问权。您可以随意使用 fork，而不会干扰主存储库。

一旦你修复了一个 bug(你可以在一个项目的 bug 追踪器中找到，或者通过邮件列表或 IRC 询问)，你可以提交一个 [pull 请求](https://help.github.com/articles/using-pull-requests)将你的代码合并到中央存储库中。您的提交历史记录和更改的文件是可见的，每行都启用了注释。

还有其他基于云的解决方案，如 [BitBucket](https://bitbucket.org/) 和 [GitLab](https://www.gitlab.com/) ，但其过程与 GitHub 大致相似。

## Git Remotes

虽然这不是真正强制的，也不影响你的工作流，但是有两个[远程分支](http://git-scm.com/book/en/Git-Basics-Working-with-Remotes)在开发者中普遍流行:origin 和 upstream。Origin 指向您的分支，而 upstream 指向中央存储库。您从上游进行拉取，以保持代码更新，并将错误修复和补丁推送到拉取请求的来源。

## 分支的使用

如果你正在处理一个新的 bug，从[开始一个新的分支](http://git-scm.com/book/en/Git-Branching)。如果你想试验，就在新的分支中进行。您不应该将您的更改推送到您的主分支；主分支必须仅用于从上游更新您的分支。

为分支保留有意义的名称。当您在一个频繁变更的大型代码库上工作时，很容易忘记几天前您在做什么。分支机构的名称必须表明设立该分支机构的目的。使用许多分支；不要拘泥于单一的主分支或开发分支。

为什么要这样使用分支呢？想象一个场景，您将一个 bug 修复推送到 fork 的主服务器，并创建了一个 pull 请求。在合并拉请求之前，您决定处理一个新的 bug，并再次推送到 master。此时，您现有的 pull 请求将使用新的 bug 修复代码进行更新。

这就是为什么你的主人应该总是干净的。或者，您可以使用不同的名称创建一个分支作为引用，但是主分支也是为了相同的目的而创建的，所以最好坚持使用我上面概述的方法。

## 保持您的代码更新

如果您曾经与开源组织合作过，您会知道他们在接受代码方面非常严格，尤其是来自新贡献者的代码。您的代码需要尽善尽美，遵循该组织制定的所有准则(通常可以在他们的文档中找到)。

由于完善的需要，经常会发生贡献者被要求在补丁中做进一步的修改。在引入这些变更的前几天，代码库通常会发生重大变化。在这种情况下，您应该从上游拉，并且[将您对补丁的所有提交](http://git-scm.com/book/en/Git-Tools-Rewriting-History#Squashing-Commits)合并成一个(使用`git squash`)来更新拉请求。

## Git GUI Tools

尽管所有的 Git 命令都可以从终端成功运行，但是对于某些人来说，它们可能会让人不知所措，甚至很难看。有一些应用程序可以通过图形界面帮助您管理 Git 存储库，使所有数据的可视化变得更加简单。如果你的 Git 基础很清楚，这些工具最终会加速你的工作！这种工具的一个例子是 Atlassian(恰好是拥有 BitBucket 的同一家公司)的 [Source Tree](http://www.sourcetreeapp.com/) ，这是一个用于 Windows 和 Mac 的免费 Git 和 Mercurial 客户端。

如果你只需要一个 GitHub，你可以使用 GitHub 专为 Windows 平台开发的 [GitHub for Windows](http://windows.github.com/) 。它有一个漂亮的用户界面，只需点击几下鼠标，就可以轻松地进行克隆、分支和同步。缺点是复杂的命令无法通过 GitHub for Windows 执行，这意味着你需要通过软件启动终端来执行它们。

## 交互式学习 Git 基础知识

有一个由 Code School 提供的[交互式教程是免费的，它侧重于一般的 Git 教学。本教程非常适合初学者，它将教你如何在浏览器中执行 Git 命令！如果你以前没有用过 Git，你绝对应该试一试。](http://try.github.io/levels/1/challenges/1)

## 结论

开源贡献大部分是自愿的——除非你运行一个并行的咨询服务或为一个大组织工作，否则你不会得到报酬。大多数人以这种方式贡献自己的爱好。因此，参与一个项目的成员通常分布在世界各地，这使得使用 SCM 成为绝对必要的。

开发软件是一项激动人心又富有挑战性的工作。像 Git 这样的工具已经把基于团队的开发变得更好了。我希望这篇概述已经帮助您理解了一些与 Git 相关的概念，以及在对开源做出贡献时如何使用它们。

如果你有任何关于你自己的 Git 工作流程或者你为大型开放项目做贡献的经验的建议，我们很乐意在评论中听到它们。

## 分享这篇文章