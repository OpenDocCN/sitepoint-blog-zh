# PCI 符合性和 PHP 开发人员

> 原文:[https://www . site point . com/PCI-compliance-and-the-PHP-developer/](https://www.sitepoint.com/pci-compliance-and-the-php-developer/)

PCI 代表“支付卡行业”，但对许多人来说，它是一个秘密的国际卡特尔强加的一套模糊的标准，该卡特尔热衷于用突破性的法规和法律灾难埋葬粗心的灵魂。

事情的真相就无趣和平淡多了。事实上，PCI 是由信用卡公司和行业安全专家组成的联盟制定的一套安全指南，用于管理应用程序在处理信用卡或借记卡信息时的行为。信用卡公司把这些标准强加给银行，银行再把这些标准强加给我们这些经营电子商务网站之类的人。

在本文中，我们将消除关于 PCI 的几个长期存在的神话，从 20，000 英尺的高度看一下 PCI 包含的内容，然后聚焦于那些与一般编码，特别是 PHP 最密切相关的需求。

## PCI 神话

毫不奇怪，有许多关于 PCI 标准的神话。其中一个神话是，它们就像黑手党的行为准则，没有写在任何地方，所以它们可以按照你想要的方式解释。当然，这不是真的。对于 PCI 标准的完整声明，你所要做的就是去[pcisecuritystandards.org](https://www.pcisecuritystandards.org/ "Official PCI Security Standards Council Site - Verify PCI Compliance, Download Data Security and Credit Card Security Standards")。

另一个神话是 PCI 安全标准只适用于像银行和主要零售商这样的“大家伙”。他们适用于每一个接受信用卡信息支付的人。如果你用 PHP 为你的母亲写了一个网站来卖她著名的柠檬派，你就拥有了一个符合 PCI 准则的系统。

第三个神话是，如果你遵循 PCI 标准，那么你将免受恶意黑客攻击，你的数据将保持安全。这当然很好，但事实是 PCI 标准是指导方针和想法，而不是具体的技术(它们必须是模糊的，以适应所有的架构和平台)。显然，你越注意安全，你被攻击的机会就越小，但任何人都可能受到威胁。如果你至少努力达到 PCI 的期望，你将会在法律和消费者两方面被更好地看待。

最后，PCI 不是你做一次就能深深松一口气的事情。该标准要求您每年进行一次 PCI 审查，因此这是一项持续的工作，就像质量保证工作或听取您配偶的意见一样。

简单的事实是，PCI 是每个在接触信用卡数据的应用程序上工作的程序员都需要知道的事情，不管有多小。是的，这就是为什么经销商只收现金。

## PCI 基础知识

PCI 标准由 12 个基本要求组成。该标准大约每两年更新一次，在此期间，发布了各种更加具体的指南文档，处理 PCI 领域的某个子集。例如，2013 年 2 月，PCI 人员发布了一份讨论 PCI 和云的白皮书。这些特别报告也可以从 PCI 网站上获得。

正如我们将看到的，许多 PCI 需求更多地是面向网络的，但是如果您不了解完整 PCI 的基本概念，那么讨论这些东西又有什么意义呢？这些要求是:

*   区域 1–构建和维护安全的网络
    *   要求 1-安装防火墙来保护您的环境。
    *   要求 2–不要使用供应商默认配置文件或密码。
*   区域 2–保护持卡人数据
    *   要求 3-保护存储的持卡人数据。
    *   要求 4-加密通过开放的公共网络传输的持卡人数据。
*   区域 3-维护漏洞管理计划
    *   要求 5–使用并定期更新防病毒软件。
    *   要求 6-开发和维护安全的系统和应用程序。
*   领域 4–实施强大的访问控制机制
    *   要求 7-在需要知道的基础上限制对持卡人数据的访问。
    *   要求 8-给每个有计算机访问权限的人分配一个唯一的 ID。
    *   要求 9-限制对持卡人数据的物理访问。
*   区域 5–定期监控和测试网络。
    *   要求 10-跟踪和监控/记录对网络资源和持卡人数据的所有访问。
    *   要求 11-定期测试安全系统和流程。
*   领域 6-维护信息安全政策。
    *   要求 12-维护解决信息安全问题的政策。

其中一些项目与政策决策有关，即制定政策的决策，明确说明如何努力保护卡信息并确保网络和应用程序的整体安全性。其他要求与网络本身以及可用于保护网络的软件有关。他们中的一些处理过程的设计阶段，你如何构建和设置你的应用程序。几乎没有任何需求与代码有关，也没有任何需求描述了为保证您的安全而推荐的特定编程技术。为了使事情相对简短，我将限制我的讽刺和智慧(这是一个 70:30 的组合)，并专注于最后两组。

## 要求 2–不要使用供应商默认的配置文件/密码

在许多方面，这几乎是显而易见的。自从开始担心事情以来，安全人员一直在告诉我们这一点。但令人惊讶的是，在我们使用的许多软件中，只使用默认帐户和密码是多么容易(尤其是当你第一次安装时，一切都是非常‘测试’的)，MySQL 只是其中之一。

这里的危险增加了，因为我们大多数人都是围绕软件的一些基础部分来构建我们的应用程序，而不是从头开始做所有的事情。它可能只是一个我们用来处理加密和密钥存储的包(见下文),也可能是整个应用的框架。无论哪种方式，容易记忆，容易实现:不要使用默认帐户。

## 要求 3-保护存储的持卡人数据

我所记得的大多数高调的零售网站黑客攻击都涉及窃取网站保存的卡或其他数据，所以我将这列为 PCI 标准中最重要的部分。

显然，您存储的任何卡数据都应该加密。你需要做好加密工作。对于那些非常了解加密的人来说，您知道做好数据加密工作意味着您已经做好了加密密钥的管理工作。

密钥管理围绕着加密过程中使用的密钥的生成、存储和更新问题。存储它们可能是一个大问题，因为你要确保某人不能进入系统并窃取密钥。管理策略在如何将密钥划分和分离成多个部分上有所不同；如果你想了解密钥管理，我会从 Securosis 的白皮书[开始，然后从那里开始，尽管要注意水很快会变得很深。](https://securosis.com/assets/library/reports/Data_Encryption_101_FINAL.pdf "Data Encryption 101: A Pragmatic Approach to PCI Compliance")

当然，如果您使用商业产品来处理加密，那么您可以将密钥管理交给他们，尽管您希望确保他们的过程是可靠的，并且适合您的方法。大多数商业产品在开发时都考虑到了 PCI，因此会按照 PCI 标准来构建，但是仔细检查一下也无妨。

此外，如果您最小化甚至消除您存储的数据量，保护数据的任务将变得容易得多。也就是说，持卡人的数据可以是他们的姓名、生日、卡号、有效期、卡验证(CV)码(卡背面或正面的三位或四位数字)等等。您保留的项目越少，您需要加密的内容就越少，您的责任也就越小。幸运的是，这是 PCI 标准非常具体的一个领域，它明确规定了哪些数据可以保留，哪些数据不可以保留。您可以保留卡号(PAN 主账号)、持卡人姓名、有效期和服务代码。如果您保留平移，那么如果您要显示它，您必须屏蔽它，前六位和后四位是您可以显示的最大值。您不能存储 PIN、CV 代码或整个磁条。

在设计阶段，你必须问自己的问题是，你到底想保留多少这种讨厌的数据。保留它的唯一真正原因是您想在下次访问时为您的客户提供轻松的体验。你可以抓住生日，这样你就可以在生日的时候给他们一个友好的小问候。所有这些数据都必须被加密和保护，所以要确保这些数据有可靠的商业用途。

要求 4(加密任何传输的数据)是其中的一部分，但我将考虑基础设施的这一部分，不再赘述。

## 要求 6-开发和维护安全的系统和应用程序

这是与代码相关的需求。不是针对特定的函数或类，但至少要确保你遵循一般的安全标准，并努力使你的东西有一定的防弹能力。所以，你只需使用编码技术，而不管是什么语言，这不会让你的应用程序暴露在明显的黑客攻击之下。例如，您试图通过在接受表单数据时采取预防措施来防止 SQL 注入，您试图阻止 XSS，等等。有关避免一些更常见的安全问题的更多信息，请参考 SitePoint 上发表的一些其他文章([本](https://www.sitepoint.com/top-10-php-security-vulnerabilities/ "Top 10 PHP Security Vulnerabilities")和[本](https://www.sitepoint.com/5-more-php-security-vulnerabilities/ "5 More PHP Security Vulnerabilities")加上其他文章，如果您通过“安全”进行搜索)。

## 要求 7 和 8-限制访问和唯一 ID

这两件事都与你访问应用程序的方式有关，因此介于编码和设计之间。

要求每个访客都有一个唯一的 ID 应该不成问题，除非——你碰巧让人们通过访客资料登录和购物。我马上就能想到几个允许你这么做的网站，这些网站本身并不邪恶，但是使用群组档案是危险的，你必须额外努力确保他们没有太多的权限。通常，您应该努力设置唯一的 ID，即使您没有保存该 ID。例如，您可以让人们以客人身份登录，然后立即在活动的幕后创建一个独特的个人资料。

我们还想限制对持卡人数据的物理访问。这可能是对未来的一种认可，那时我们将能够把人缩小到亚微观大小，就像在 Issac Assimov 的神奇旅程中一样，并将他们注入存储设备，以获取卡数据的 1 和 0……或者它也可能与锁定的服务器房间、所有访问者的徽章、不让任何人接近备份磁带等事情有关。

## 要求 10-跟踪和记录对资源/数据的所有访问

最后，不要低估跟踪和记录访问资源或持卡人数据的所有内容的重要性…我指的是所有内容。应该记录的事件包括登录、注销、数据访问；数据更新，实际上是任何涉及资源或数据元素，并且您认为可能作为审计线索或刑事审判证据有用的东西。您必须实现一个安全的日志，每天检查日志以查找问题，并将日志保存一年。

对于 PHP 用户来说，熟悉来自 PHP-FIG 小组的 PSR-3 日志记录标准是有益的，它提供了一种统一而灵活的方式来设置日志记录。与其在这里深入探讨，我推荐帕特里克·马尔维的介绍性文章。

## 摘要

我想我真正想强调的一件事是 PCI 不是糖衣。这是创建处理信用卡数据的应用程序的一部分。如果你正在编写一个应用程序来处理这些数据，不管你的客户是否知道，它都适用于你。大部分都在编码水平之上，但它是真实的，是你仍然必须注意的东西。

<small>图片 via[Fotolia](http://us.fotolia.com/?utm_source=sitepoint&utm_medium=website_link&utm=campaign=sitepoint "Royalty Free Stock Photos at Fotolia.com")T3】</small>

## 分享这篇文章