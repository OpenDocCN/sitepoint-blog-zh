# RubyMotion:加糖的伯爵茶

> 原文:[https://www.sitepoint.com/rubymotion-early-gray-with-sugar/](https://www.sitepoint.com/rubymotion-early-gray-with-sugar/)

### RubyMotion 社区的一位伯爵解释了方糖

Ruby 非常适合领域特定语言(DSL)的创建。

如果你是第一次接触 iOS 开发，基于你的背景，你可能会有这些一致的反应

*   重度 C/C++:这个 Objective-C 的名字里甚至不应该有“C”这个字！
*   闲聊或接下来:我又回家了
*   鲁比:WTF？

正如前一篇文章[中所描述的，](https://www.sitepoint.com/rubymotion-dreams-do-come-true/) [RubyMotion](http://rubymotion.com) 隐含着“用 Ruby 取代 Objective-C”的承诺。那确实不完全是事实。即使 RubyMotion 是一个将 Ruby(或类 Ruby)代码编译成 iOS 可执行文件的工具链，但是理解 iOS 和 Objective-C 的结构和架构并没有捷径可走。

在 RubyMotion 社区中，当一个核心的 ruby 爱好者遇到 Objective-C 这个庞然大物时，会有很多“减轻打击”的努力。
[气泡包装](https://github.com/rubymotion/BubbleWrap)(如此贴切的名字)是第一个，并且在相当长的一段时间里保持最受欢迎。它有助于以一种更像 Ruby 风格的方式“包装”iOS 所需的晦涩难懂的语法。

随着[方糖](https://github.com/rubymotion/sugarcube)的出现，最终的*句法糖*出现了。SugarCube 几乎是一种全新的语言，作为 DSL 编写，用于 [RubyMotion](http://rubymotion.com) 。

方糖的“幕后人”是科林·托马斯·阿诺德·格雷。

科林在 [RubyMotion](http://rubymotion.com) 社区的努力，尤其是他名为 SugarCube 的 DSL，为他赢得了 RubyMotion 社区内**社区经理**的正式职位。

我和科林谈了他的背景，他对 RubyMotion 的介绍，SugarCube 的历史和发展，以及他在 T2 ruby motion 社区的新职位。

#### 面试

**Thom:** 告诉我们你的背景和你对 Ruby 的介绍(还有 [RubyMotion](http://rubymotion.com) )。

科林:是的，我很早就知道我喜欢制作工具，别人用的东西。我也喜欢做产品，但我更喜欢做工具。我喜欢写可重用的代码。所以即使只是对我来说，我也很喜欢这方面。
修补很有趣。当然，编码是一个如此幸运的职业，因为它是一个修补的工作，我们喜欢它，我们整天修补就能得到报酬。

你说过你在丹佛从事 PHP 工作——帮助构建一个框架——大约在第一本[鹤嘴锄书](http://pragprog.com/book/ruby/programming-ruby)出版的时候。你对 Ruby 感兴趣，但当时它不是你的主要语言？

科林:所以我对 Ruby 产生了兴趣，就像我说的，我正在编写我们自己的框架。所以我在很大程度上基于 Rails 的想法；ORM 非常不同，它对原始 SQL 有更多的访问权限。

所以 Ruby 有点“在那边”，这是我想用的东西，我会读它，试着了解更多，但是我没有每天都用它，也没有用 Rails 做任何东西。但是在那个时候，配置一个服务器使用 Rails 真的很难，所以 PHP 只是一个后备。每个服务器都支持它。

后来它被搁置了一段时间，因为我们转向了 Django 和 Python，然后我大部分时间都在做 Python，所以 Ruby 被搁置了。一直以来，iPhone 都是过时的，我想为它开发应用程序。我不停地拿起 Objective-C 和 iOS 的书。我已经知道了 Objective-C，所以我想，“我应该能做到这一点。”但是我不能完全投入进去。我认为一个问题是时间。我不是专业的，所以我没有一整天的时间来玩它。另一个是工作流程，我认为很多 RubyMotion 程序员会立即意识到这不太自然。

Thom: 我觉得那是很平常的事情。我想，从苹果的角度来看，Xcode 是一个不错的 IDE，但感觉有些笨拙。

科林:是的，它隐藏了太多东西，你真的不知道当你创建一个导航控制器时会发生什么。您在哪里添加视图？它必须是根视图控制器吗？它可以是其他事物的子事物吗，那些事物是什么？

是的，你说得对，这有点太夸张了。

科林:是的，这很傻，因为一旦你弄明白了，你就会意识到，UINavigationController 没有任何魔力。它只是一个愚蠢的容器。你可以在一个下午写你自己的导航条，当然，它的功能不会那么全，也不会集成得那么好，但是你可以只写一个。这不是魔法。
但是 Xcode 带来了魔力，因为你看不到实际发生了什么。

Thom: 我认为 Xcode 正试图成为 Visual Basic 所变成的样子。你知道，Visual Basic 让任何人编写糟糕的软件变得如此容易。

科林:没错。我写了我的一份。

我在日本上学的时候就决定学习 Objective-C。所以我想跟进这件事。我有足够的时间和动力去真正做到这一点。

所以我想，“好吧，我要做一个应用程序，一个 Mac OS X 的应用程序，让我们看看，我能做什么应用程序？我会做一个电子表格。”那是我的“天才”主意。

我想，“我会有一个电子表格，它会有一个完整的语言，不是电子表格语言，而是一个完整的东西。”我写了这种语言，我称之为 LX，代表“像 Excel 一样”，但是倒过来了。所以 XL 倒过来。

汤姆:真聪明。

**科林:**我实际上启动了电子表格程序，并取得了很大进展，它实际上非常类似于数字，因为它没有电子表格作为根对象，它有一个文档，你可以将表格拖到它上面，也可以将图表拖到它上面。这些表格将数据制成表格，你可以在其中放入公式，这些公式可以是一个迷你程序。所以这很酷。

那么你是如何以及何时发现 [RubyMotion](http://rubymotion.com) 的呢？你很早就参与其中了。

科林:我完全是偶然发现了麦克鲁比。我想也许我谷歌了一下，“用另一种语言编写 Mac OS 程序”，因为我知道，你过去可以使用 Java，你过去可以这样那样做，我听说过 PyObjective-C 之类的。在那次搜索中，MacRuby 是第一名。你可以写，它自然运行！嗯，那是，哇！这真的很酷！

我变得非常兴奋。我做网络工作已经很久了，而且做得很好。我想从事一些桌面编程，那会很棒。

所以我和那群人混在一起。我记得约书亚·伯兰科。劳伦不在。我读到了他的名字，他是创造者，但他明显缺席。但是还有其他几个人，我不记得他的真名了，但是费里斯和乔舒亚·伯兰科，他们是主要的两个人，尤其是乔舒亚，他总是乐于提供帮助和信息。

“我要完全投入进去”，我想。我在上面读了 Matt Aimonetti 的书，然后和 Josh 谈论“我能做什么？我能为这个社区写些什么呢？有什么用？”“当然，答案是文档。

**Thom:** 是的！

科林:总是文档。我在考虑做一个 CoreData 工具，让 CoreData 更容易。就在那个时候，就在我正跃跃欲试要投入到一个更大的项目中的时候，宣布了 [RubyMotion](http://rubymotion.com) ，就在那时，云散开了，亮了——

**Thom:** 机缘巧合。

科林:这甚至比了解麦克鲁比还要好。我想做 iOS 开发，我想成为这个 Mac Ruby 世界的一部分，而现在，一切都在一起了。所以我跳了进去，在 IRC 上打开了 [RubyMotion](http://rubymotion.com) 房间。那里已经有几个人了，可能有十个左右。大家都很兴奋，只是，“太酷了！”它编了，它居然*编了*，简直是疯了。

我想 Matt Aimonetti 已经发布了 [BubbleWrap](https://github.com/rubymotion/BubbleWrap) ,然后在那个聊天室，我们讨论了这个视图 DSL 的想法，我们都同意，让它成为一个社区项目。所以我们当然得想出名字。我们玩了不同的名字，让我想想，有人说——我想是克里斯·克拉克——“就像我们喝茶而不是喝可可。”

科林:所以我们创办了茶杯，它开始只是维基页面。你可以提交一个关于语法的建议，我们都会讨论它，一些比另一些更好，我们最终会——这是康拉德·欧文的建议——基于这些其他的。

我开始做[方糖](https://github.com/rubymotion/sugarcube)作为[茶杯](https://github.com/rubymotion/teacup)的助手。我看着茶杯，心想，“嗯，这是相当低的水平，因为它应该是，但我不想把这些东西都写出来，我希望能够像方糖一样只说‘白色’。”

我最终接手了茶杯项目。我想我添加的第一件事是处理程序。它们用于转换样式表中的值，并将其分配给任何方法或属性。有机会说，“好吧，等等，你想用这个值做什么？”这就是你可以将颜色符号名称转换成颜色对象的地方。通过一个处理程序。

Thom: 所以你的介绍，或者说是吸引你加入 [RubyMotion](http://rubymotion.com) 的事情，是这个参与社区项目的机会。

科林:对。

Thom: 并且实现你最初的目标，围绕 Ruby 语言编写某种 DSL。我的描述正确吗？

科林:我想是的。好吧。所以我最喜欢的，也是 SugarCube 最让我满意的部分是 REPL 工具。

**Thom:** 是的。

科林:每次我开始一个新项目，这只是第一步。

**Thom:** 假设你在电梯里，有 15 秒钟的时间去说服那些从未听说过它的人，为什么他们应该看看 [RubyMotion](http://rubymotion.com) 。你想到的关于它的什么事情，让你如此兴奋？

**科林:**当你和 [RubyMotion](http://rubymotion.com) 一起工作时，你处在一个 iOS 的世界里， [RubyMotion](http://rubymotion.com) 把你放在它的中心，所有的工具；比如和 REPL 一起工作，写出你的代码。你从 AppDelegate 开始，你创建你的窗口，你设置好一切，你的工作非常接近金属。因此，可能有一个更高的学习曲线，尽管你也学得很快，很多时候你可以复制和粘贴相同的应用程序委托代码。随着你的前进，你总是会得到它，它会迫使你彻底地学习东西。这是一个原因。

这很棘手，因为有好处也有坏处。我首先要提到的一件事是，我不会努力说服人们使用它，因为这是一个非常奇怪的决定。

汤姆:我同意。

科林:必须感觉正确，当感觉正确时，你就会知道。它会感觉很直观，感觉像是工作的合适工具，而 Xcode 不会，乐器不会，你不会想使用它们。

所以使用它的一个重要原因是因为它是一种选择，因为它就在那里，因为它可能是工作的最佳工具。如果没有，就不要用。但我不想赢得任何战斗。

### 方糖

汤姆:再告诉我一点关于[方糖的事情](https://github.com/rubymotion/sugarcube)。灵感是什么？

**Colin:** 这里有 REPL，你可以点击视图，但不能全部点击。有很多不会注册，当然，如果你在视网膜，不会注册任何一个，不管什么原因。命令点击技巧不起作用。

所以我说，“好吧，这很傻。我应该能够做的只是看看层次结构，这就是我正在做的，我只是在遍历层次结构，我想要一些东西为我做这件事。”

所以我写了树命令。输出从应用程序窗口开始，你可以继续下去。然后立即执行调整命令。所以这就发生了，而且是巨大的。看到正在发生的事情很有帮助。这实际上以某种方式引导了我的编程，因为我总是确保当我的视图输出时，所有重要的信息都在树视图中。

树视图可以做的另一件事是输出任何类似树的结构，主要是层，所以你可以做你的层，你的核心动画层层次和视图控制器。你可以说“树根”，这会给你所有的视图控制器。在这些东西之间，你已经拥有了你每天都在处理的大部分东西，而且它们非常容易得到。

Thom: SugarCube 是一个非常棒的 DSL，可以帮助简化从 Ruby 到 iOS 的过渡。

### 巡回大使

告诉我关于 HipByte 的事情，因为那非常令人兴奋。

**科林:**是的，写完了[方糖](https://github.com/rubymotion/sugarcube)和[茶杯](https://github.com/rubymotion/teacup)，这让我陷入了一个困境，洛朗在 11 月问我，他告诉我关于会议的事情——那时候还没有名字——那时候会议将在 2 月初举行，我会去参加吗？我只是被吹走了。一次会议从未邀请我发言，这太荒谬了。所以这很酷。

嗯，这让我们彼此认识了，不仅仅是支持票和到处聊天，所以我们更经常地聊起了会议，谁将发言，以及社区里发生了什么。很明显，他想做 RubyMotion，他是一名程序员，不是经理，他想做他的产品，他只有这么多时间参与社区。这是一个很大的遗憾，因为他想知道发生了什么，但是你能做什么呢？所以我会给他一些信息。这里有一个谷歌群聊，你应该看看这个，你应该在这里插话，这很重要。有人正在尝试，最近有人在 Cocos2D 上遇到了问题，我发给他说:“我知道 Cocos2D 集成很重要，所以你对此有什么看法？”他和沃森对此也有所回应。

然后有一次，他问我是否对 HipByte 社区联络员的实际职位感兴趣。因此，这将需要写博客和写教程，采访写宝石的人，就像抓住脉搏一样，确保最好的产品，最好的项目和宝石得到管理。

就像 BubbleWrap 的故事一样，Matt Aimonetti 决定，“我不想再维持这个了，我没有时间了。”所以把它转移给其他 BubbleWrap 程序员。现在，他们当然会自己处理，但是要确保事情发生。

Thom: 那你有什么官方头衔吗？

科林:是的，工作头衔，我不知道这是不是正式头衔，但社区经理是这个职位。

**Thom:** 好的。

科林:现在这是一个非常有限的角色。我有一个 HipByte 的电子邮件地址，我就在这栋楼里。

Thom: 但你更像是这个社区的一员，代表 HipByte？

科林:是的。实际上，这个角色最好的部分是它需要维护项目，开源项目。

Thom: 太好了。我想我看到了一条关于你的电池快没电的推文，我想那是你们在讨论的时候。

科林:是的。这是我之前想提到的，这是我想做的另一件事，从 Mac Ruby 转移到 [RubyMotion](http://rubymotion.com) ，是真正成为编程社区的活跃成员。所以我更多的是从远处观看 Django，那是我使用的第一个大型软件项目，我可能会加入其中，但那已经是一个老男孩俱乐部了。它已经存在了很长一段时间，他们有自己的成员插话和回答，所以我只是坐在一旁。

有了 [RubyMotion](http://rubymotion.com) ，它就在那里，我可以直接跳进去。我决定回答尽可能多的问题，即使这会有点烦人。即使我不完全知道，如果我只是有一个观点，我会积极的，这就是我要做的。看到这出戏结束真是太棒了。

Thom: 我认为它很适合你。

科林:是的。

**Thom:** 正如我所说，你算是一个名人，你的名字在[谷歌集团](https://groups.google.com/forum/#!forum/rubymotion)中得到认可。

科林:是啊，花了很多功夫。一方面，它可能是任何人，你知道，因为有整个群体的活跃成员，特别是在[谷歌集团](https://groups.google.com/forum/#!forum/rubymotion)，我认为，你只是，他们突然出现，你只是看到他们，你知道吗？

**Thom:** 是的。

**Colin:** 这也是一个非常棒的社区，看到电子邮件并看着它一点一点地成长是一件非常愉快的事情，每个人都很高兴能加入，我真的认为这就像看 Rails 社区，如果你很早就加入并看着它成长，就像是在说，“哦，我的天哪！”这是我的经验。

最后，我只是想了解一下你的观点。你认为目前在 [RubyMotion](http://rubymotion.com) 中有什么突出的缺失吗？

{在这次采访的时候，科林提到了一个“秘密项目”。这是在第一次 [RubyMotion](http://rubymotion.com) 大会上公布的，#inspect }

### x 射线–暴露您的 RubyMotion 应用程序

汤姆:告诉我你的最新项目:x 光。

**Colin:** 我在展示一个新的应用功能时产生了 x 射线的想法，并被要求做一些简单的修改:

*   交换两个视图的位置
*   更改字体
*   改变一些颜色

诸如此类的事情。如果我在浏览器上，我可以打开 firebug/web inspector，然后 *bam* 就在那里完成。或者，如果我在一个终端上，我可以使用 [RubyMotion](http://rubymotion.com) 非常棒的 REPL 来移动东西。但是，*叹*，它在设备上。如此回到电脑进行编码/编译/查看/上传/重复循环。

我突然想到，如果我可以就地编辑这些东西，我就可以在几分钟内显示这些变化，就在那里……更好的是，我可以把电话交给他们，对他们说“疯狂吧”，他们可以做任何他们想要的改变。当然，这需要一些日志机制，但这是合理的…这就是 x 射线的开始。在开发的早期，我就意识到虽然 UI 编辑很“简洁”，但是还有更多的事情可以做。控制台日志很容易实现，而且非常方便！所以那个被扔了进去。Austin Seraphin 将在#inspect 上做一个关于可访问性的演讲，我想到了一个主意，我可以展示可访问性视图的可视化，因此“可访问性”插件被创建了。

如果可能的话，我喜欢以可扩展系统为目标——它们使代码更干净，因为它们强制分离关注点。所以这是一场轻松的胜利。现在，当然更多插件的想法不断增长:内存使用图，cocos2d 帧速率/纹理数量，自动布局约束可视化(非常难！)、蓝牙设备扫描仪、网络使用记录——以及我从未想到过的想法不断涌现！我想到了一个:Joffrey Jaffeux 正在构建一个显示环境变量的插件，你可以编辑它们。例如，您可以从您的“开发”服务器切换到您的“生产”服务器，或者编辑一些凭证以模拟有问题的用户！因此，不仅仅是一个开发环境，您还可以将 Xray 用作“超级用户”工具！如果在你的应用上有一个“以用户 X 的身份登录”的功能该有多方便！？

来自社区的反馈非常好——我认为人们理解在设备上拥有这些东西*的价值，所以你实际上可以在网络连接不稳定的地铁上进行一些调试和自省。
有几件事在 iOS 上特别难测试——不管你用的是 [RubyMotion](http://rubymotion.com) 还是 XCode。*

汤姆:非常感谢你，科林。我希望你代表 [RubyMotion](http://rubymotion.com) 社区继续创新。

科林·托马斯·阿诺德·格雷在谷歌团队中非常活跃。你可以在 www.colinta.com 的[、Github 的](http://colinta.com)[科林塔](https://github.com/colinta)和 Twitter 的@科林塔找到他。

## 分享这篇文章