# PHP 之旅。初始化设置文件的后缀名

> 原文：<https://www.sitepoint.com/a-tour-of-php-ini/>

任何拥有使用 PHP 的服务器的人都一定听说过`php.ini`——它是用于控制和定制 PHP 运行时行为的配置文件。它提供了一种简单的方式来配置设置，例如:

*   上传目录
*   记录错误
*   最长脚本执行时间
*   文件上传限制

…还有更多。

`php.ini`是 PHP 启动时寻找的第一个文件，因为它设置的配置指令非常重要。但是，如果您对您的`php.ini`进行更改，则需要重新启动服务器，更改才会生效。

PHP 附带了一个带有推荐设置的预制`php.ini`文件。许多支持 PHP 的主机提供商允许您定制`php.ini`指令，这样您就可以按照自己喜欢的方式调整 PHP 的行为。在这些情况下，PHP 只使用您在自定义的`php.ini`文件中指定的指令值；您没有在文件中声明的任何设置都被赋予各自的值，这些值来自原始的`php.ini`和 PHP 的内置默认值。

在这篇文章中，我将给出一些重要设置的概述，我相信你在调整自己的`php.ini`文件时应该关注这些设置。当然，这只是个人的选择，随着时间的推移，每个人都会发展自己的偏好，所以我建议您对`php.ini`中提供的无数配置指令做一些扎实的研究。

`php.ini`的位置取决于服务器和 PHP 的安装方式。出于本文的目的，我假设它在`/usr/local/lib/php/php.ini`。你的道路可能会不同。要找到您的`php.ini`文件所在的位置，您可以使用`phpinfo()`功能。

所以让我们开始我们的`php.ini`文件之旅，第一站:`engine`指令。

## PHP 引擎

```
engine = On
```

第一个配置设置是`engine`指令，它主要控制 PHP 引擎是打开还是关闭。该指令负责确定 PHP 是否对您的脚本可用，如果将其设置为 Off，将完全阻止您使用 PHP。

你可能想知道为什么我包括了这个，因为很明显如果你打算使用 PHP 的话，你应该启用这个。简单的答案是，在一个定制的`php.ini`文件中使用它可以让你在定制的配置中完全控制 PHP 服务器。您将在文件中设置 PHP 的所有自定义规则，我认为将主开关隐藏在另一个文件中而不是显示在您最常访问的文件中是低效的。

下一站是一个指令，我认为它是编写可移植代码时最重要的:`short_open_tag`。

## 短标签

```
short_open_tag = On
```

`short_open_tag`指令允许开发人员使用短标签，简而言之，就是开发人员应该写`<?`而不是`<?php`。使用短标签的一个例子是:

```
<? echo "Hello World"; ?>
```

与使用完整标签相比:

```
<?php echo "Hello World"; ?>
```

启用`short_open_tag`后，您可以同时使用`<?`和`<?php`。然而，使用短标签有一个很大的缺点，特别是当你开发任何打算在各种 PHP 服务器上使用的东西时。默认情况下，短标签是启用的，但是会导致一些解析问题，所以有些人关闭了这个选项。如果你的代码依赖于短标签，那么它就不会在他们的服务器上运行。强烈建议您在开发可移植代码时关闭`php.ini`中的短标签，以防止自己使用它们。

接下来，我将强调一个选项:输出缓冲，任何开发能力水平的人都可能在不知不觉中遇到过这个选项。

## 输出缓冲

```
output_buffering = Off
```

您可能在一些场合看到过下面消息的派生:无法添加已经发送的标题信息标题。当脚本在已经开始将输出发送回用户的浏览器后，试图设置 HTTP 头(用户看不到但仍由 web 浏览器处理的元素)时，会出现此警告。启用`output_buffering`会导致 PHP 延迟发送头，而是在脚本完成处理后同时发送它们和脚本的输出。这允许您在脚本执行期间随时更改头值。

一般认为`output_buffering`是一个可以打开而不会导致任何大的复杂情况的指令，所以如果需要它的功能，让它打开是很有用的。就我个人而言，我更喜欢关闭它，因为如果你开发一个 WordPress 插件，例如，它将在许多不同的服务器上运行，你需要注意你的代码不依赖自动输出缓冲来打开。

接下来，让我们来看看两个选项，如果你正在创建一个可视化模板共享公共页眉和页脚文件的网站，这两个选项会有很大的好处:`auto_prepend_file`和`auto_append_file`。

## 自动页眉和页脚

```
auto_prepend_file = "header.php"
auto_append_file = "footer.php"
```

`auto_prepend_file`和`auto_append_file`指令让你告诉 PHP 在脚本的输出中添加一个文件，并在最后添加一个文件。这让人想起 WordPress 中的`get_header()`和`get_footer()`功能，如果你使用普通的页眉和页脚文件，这将非常有用。但是请注意，这些指令指定的文件将用于每个 PHP 文件，这可能不是您想要的。

`auto_prepend_file`和`auto_append_file`的另一个用途是设置一个简单的执行计时器，它可以用来测试生成一个页面所需的时间。例如，`auto_prepend_file`加载的文件可能包含:

```
<?php
$t1 = microtime(true);
```

……`auto_append_file`的文件将包含:

```
<?php
$t2 = microtime(true); 
$elapsed = $t2 - $t1;
$logFile = "/tmp/timing.txt";
file_put_contents($logFile, $elapsed . " " . $_SERVER["REQUEST_URI"] . "n", FILE_APPEND);
```

我们旅程的下一站是 PHP 的错误处理指令。

## 处理错误

```
error_reporting = E_ALL|E_STRICT
display_errors = Off
log_errors = On
error_log = "/var/log/php_errors.log" 
```

我上面展示的设置是生产环境中 PHP 错误报告行为的推荐配置。脚本中的错误可以是非致命性的(如通知或警告)，也可以是致命性的，即停止脚本的执行。不管错误是致命的还是非致命的，这个配置都将指示 PHP 不要在其输出中显示错误消息，而是将其保存到一个错误日志文件中。

打开`display_errors`会将错误的细节输出到浏览器中，这对于开发来说非常方便。但是，一旦您的站点被部署，错误消息可能会分散您的用户的注意力，甚至为恶意用户提供如何攻击您的站点的信息。最好将错误消息发送到只有您和其他管理员有权访问的日志文件中。这可以通过设置`error_log`指令来完成。通常显示在浏览器中的错误消息将被记录到指定的文件中。

关于错误处理的更多信息，请查阅斯内哈·何达的文章“PHP 中的错误处理”。

我们旅程的最后一站是快速浏览一下 PHP 中的时区。

## 时区

```
date.timezone = "US/Central"
```

默认情况下，在`php.ini`中没有设置这个设置，当`E_STRICT`报告被启用时，每当您在脚本中使用日期或时间函数时，PHP 都会发出警告。这可以通过在配置文件中设置`date.timezone`指令很容易地解决。

这个选项经常被开发人员忽略，但是如果配置正确，它可以减少 PHP 脚本中出现大量复杂情况的机会。在线文档中提供了受支持时区的完整列表[。](http://www.php.net/manual/en/timezones.php)

## 摘要

强烈建议所有 web 开发人员浏览一下他们服务器的`php.ini`文件，熟悉它的内容，并适当地个性化一些指令。本文中的配置指令应该为您提供了一个良好的起点。如果你使用共享主机，主机公司设置的配置可能不总是最好的，也可能不符合你的编码风格。请咨询您的提供商，了解您可以使用哪些选项来自定义您的环境。

图片来源于[摄影记者](http://www.shutterstock.com/gallery-293770p1.html) / [摄影记者](http://www.shutterstock.com/)

## 分享这篇文章