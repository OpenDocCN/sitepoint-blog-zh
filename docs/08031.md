# 使用隐藏的表单域轻松防止垃圾邮件

> 原文：<https://www.sitepoint.com/easy-spam-prevention-using-hidden-form-fields/>

也许我是一个老派或者纯粹主义者，但是有一个可用性的方面是许多网站严重缺乏的。我指的是围绕防止垃圾邮件的疯狂行为。

正如我在 2011 年 11 月的一篇个人博客中提到的，我遇到了一些垃圾邮件问题，并提出了一个解决方案，我发现这并不是什么新东西，但似乎很少有人使用或知道。这是一个非常简单而有效的方法来防止你的网站表单上的垃圾邮件，我想在这里与你分享。

## 问题是

显然，随着你的网站越来越受欢迎，垃圾邮件总是增加。有几种众所周知的防止垃圾邮件的方法，包括:

*   禁止 IP 地址
*   强迫用户在发帖前注册并验证他们的电子邮件
*   验证码图像或类似的图灵测试
*   使用不断增长的已知垃圾邮件发送者数据库进行比较的第三方解决方案
*   手动审核或批准帖子

大多数这些方法的问题是用户很痛苦。禁止 IP 地址很少工作，因为这些可以被欺骗或重新分配，你可能实际上最终阻止一个合法用户；垃圾邮件发送者倾向于使用动态 IP。

强迫用户注册或阅读复杂的验证码图片将负担从网站所有者转移到了用户身上，导致他们不得不跳过更多的关卡来投稿。验证码图片无论如何都是一个可怕的解决方案，因为它们不能很好地迎合残疾人，而且它们也越来越容易受到 OCR(光学字符识别)程序的攻击。

我不想依赖某些第三方解决方案，因为我的项目中的依赖性越少，我对它的感觉就越好。如果这让我连续几个小时手动整理垃圾邮件，那就这样吧，只要负担是我的。有些人会认为增加的复杂性是一种必然的罪恶，但我似乎无法让自己同意这种观点。

## 解决方案

因此，当我一个接一个地删除垃圾邮件，试图想出一个非侵入性的解决方案时，我开始注意到一个模式…垃圾邮件程序无法区分字段是可选的还是必需的，所以它只是将它们全部填充。仔细想想，每个网站在标注必填字段时都是不一样的；有些用星号，有些用红色文本，有些用仍然很少支持的 HTML5 属性“required”，还有一些根本懒得标记它们，而是在您碰巧错过一个时将您重定向回来。机器人会被这种事情绊倒，甚至不去尝试，这才说得通。

找到了。这就是我的应用程序一直内置的图灵测试！现在如何充分利用它。

spambots 不仅难以识别必填字段，还难以阅读 CSS 或 JavaScript，至少目前是这样。因此，最简单的解决方案是在每个表单中添加一个完全任意的字段，然后使用任意数量的此类方法隐藏它，例如:

```
<input type="text" name="foo" style="display: none;">
```

或者，您可以选择稍微复杂一点的东西，比如给字段一个 ID 或一个类，然后强制 bot 扫描您的 CSS 文件以确定元素的可见性。

您还可以使用 Javascript 在页面加载时从显示中删除任意字段，例如:

```
<div id="fooDiv">
<label for="foo">Leave this field blank</label>
<input type="text" name="foo" id="foo">
</div>
<script>
(function () {
    var e = document.getElementById("fooDiv");
    e.parentNode.removeChild(e);
})();
</script>
```

请注意，示例中的字段已经被赋予了一个标签，指示用户在禁用 JavaScript 的情况下将字段留空。

现在您可以放心，如果表单提交到达您的服务器时该字段有值，那么该事务可以作为垃圾被丢弃。无论您使用哪种方法，机器人现在都有一个额外的任务，即确定给定的字段是否可见和/或必需，您可能会认为这需要一些非常高级的人工智能或代表垃圾邮件发送者的更有针对性的方法。

这也可能有助于随机化任意字段的显示位置和命名方式，从而使其更难预测。

当然，没有一个解决方案是完全安全的，因为垃圾邮件有时仍然是由人手工提交的，所以有一个以上的防范程序也无妨。为了增加另一层保护，当检测到垃圾邮件时，您仍然应该继续重定向 bot，就像它是一个成功的表单提交一样；我不喜欢给他们任何探查的理由。

我喜欢好的、老式的、开箱即用的解决方案，尤其是当它们优雅而有效的时候。我希望你和我一样觉得这个技巧很有用，我希望你愿意分享任何改进或者你可能碰巧想到的一些其他解决方案。

对本文的评论已经关闭。对 HTML 有疑问？为什么不在我们的[论坛](https://www.sitepoint.com/forums/forumdisplay.php?52-(X)HTML?utm_source=sitepoint&utm_medium=link&utm_campaign=forumlink)上问呢？

## 分享这篇文章