# 提高 Vi 技能的途径

> 原文:[https://www.sitepoint.com/path-better-vi-skills/](https://www.sitepoint.com/path-better-vi-skills/)

![605px-Vimlogo.svg](../Images/014044838db5a82ccf2015f9041d311e.png)

在软件开发人员中，没有一个主题会比“最喜爱的代码编辑器”产生更多的意见、争议或讨论。似乎我们都有一个明确的偏好，并且会强烈赞成那个选择。

与此同时，现在没有不包含 Vi 版本的*nix 系统可供您连接。它是这个星球上最普遍的编辑器！

我们每个人都在不同程度上掌握了虚拟仪器。命令集似乎比任何其他单个应用程序都大。大多数命令非常神秘、奇特，因此很难记住。互联网上的各种备忘单作为参考很方便，但作为指导性的教程指南却严重缺乏。

为了提高我的*代码编辑技巧*，我花了几个星期的时间明确地定期使用 Vi。

正如你可能从我的其他文章中猜到的，我是 T2 一氧化二氮的忠实粉丝。IO 和从*任何电脑*和*任何地点*给我一个 linux 盒子对我的追求是一个很大的帮助。

我很高兴邀请你一起去，提供一个我的冒险的缩略(“加速”可能是更准确的描述)回放。

我想向世界介绍我自己的一套记忆术，它可以减少与 Vi 相关的陡峭的学习曲线(真实的或感知的)。

# 一点历史

VI(Visual 的意思)可以追溯到 Unix 的起源(美国电话电报公司)。作为与电传打字机一起使用的面向“屏幕”版本的编辑器，它代表着向现代计算迈进了一步。“vi”这个名称来源于将行编辑器“ex”(Bill Joy 的编辑器，在 1978 年 3 月作为第一个 BSD Unix 版本的一部分发布)切换到可视模式的命令。

布莱姆·米勒在 1991 年左右公开发布了 VIM，尽管他在 20 世纪 80 年代末就开始为他的 Amiga 写作了。它最初被称为 *VI 模仿*，后来， *VI 改进了*。

出于通用性的考虑，下面一组教程步骤将假设您对 Vi 的经验非常非常少。不过，我敢说，不管你的经验如何，在这个功能丰富的软件应用程序中总会有新的东西要学。

另外，这里的一切都是基于我的个人经历。术语和描述是我自己的，我对它们负全部责任。

## 操作模式

在使用 Vi 时，我观察到了几种明显不同的操作“模式”。

*   命令模式
*   编辑方式
*   窗口模式

在这些模式之间切换通常需要按下`ESC`。

> 一个替代`ESC`的方法是 Ctrl [。
> 我发现这变得更加容易和快捷，尽管我很难改变长期以来伸手去拿退出键的习惯。

### 命令模式

在这里，你可以向编辑器发出命令，去做*我认为*除了编辑之外的事情。

当处于**命令模式**时，冒号(:)用于接受与*无关的*编辑或导航命令的输入。

#### 关闭

> 当我还是遥控飞机的狂热爱好者时，我们当地的俱乐部里有一个非常流行的“迷因”:“起飞是可选的，着陆是强制性的”
> 
> 关于 Vi，我要解释一下，虽然编辑器的**打开**是可选的，但是**关闭**是强制性的。

正如 Vi 的“忠实于表单”一样，有许多方法可以关闭和退出编辑器。

`zz`是保存和退出的最快方式。我认为这是让 Vi 进入睡眠状态(类似于用一排 z 表示睡眠的漫画)

`:wq`最常见。这代表几个连接在一起的离散命令(这是命令模式的一个有用特性):

*   写入当前打开的文件
*   q 是 to (q)uit

> 我也喜欢将`:x`作为**保存并关闭** vi 的快捷方式

如果您希望退出并放弃您所做的任何更改，使用(q)uit 命令，然后使用 shebang `:q!`命令。这将忽略任何更改并关闭编辑器。

您可以选择在(w)rite 命令后提供一个文件名，就像这样`:w Gemfile`。这将 **w** 把输出写到那个文件(在大多数系统上，如果需要的话，创建它)。

#### 航行

在文档中导航是任何编辑器最重要的功能之一。我发现在 Vi 中，通过一些助记技巧，掌握跳转代码的基本命令比预期的要简单。

分别用`h`、`l`、`j`、`k`将光标向左、右、下、上移动一个字符/行。我发现这比试图用箭头键(顺便说一句，它也像预期的那样工作)快得多*、*

 **按下`b`，在编辑模式下，光标将跳转到当前单词的 **B** ack 到 **B** 开头。同样，`e`会将光标移动到当前单词的第 **E** nd。以类似的方式`w`跳到下一个 **W** ord

您可以将光标强制移动到当前行中的任意位置，列号后跟管道符号。我把`15|`想成“把工字梁光标推到位置 15”。
同样，管道符号将单独移动到该行的第一个字符/列。其实`|`和`0|`是等价的。“无”在这里解释为零。

在离开移动光标的命令之前，让我们添加这两个命令:

*   `+`将光标移动到下一行的开头。我认为这是 **Inc** 公司对生产线位置的重新定位
*   `-`将光标移动到上一行的开头，类似于 **Dec** 重新移动行的位置

用 Ctrl u(我想到的是**向上**和 Ctrl d(我记得的是**向下**)滚动屏幕。这些只能移动屏幕的一半宽度。一个完整的“下一步”屏幕是 Ctrl f ( **F** 前进)。你可能已经猜到了，Ctrl B(代表 **B** ack)会上移一个屏幕。

你可以用`32G`将 **G** o 到文件中的任何一行。代表 GO 的“G”前面是行号。

> 由于`8G`将 **G** o 到第 8 行，很明显`1G`将跳转到文件中的第一行。不明显但非常有用的是，只有`G`会跳到文件的最后一行**。*与将光标移动到行首的命令不同，在这种情况下，“无”表示结束***

*一个方便但有点晦涩的命令是`z`后跟 RETURN，它将编辑器设置为当前行是屏幕上的第一行。*

### 编辑命令

既然我们能够在屏幕上自由移动光标并滚动当前打开的文件，让我们看看如何对文本进行实际的更改。

我必须承认，这些的记忆方法不像其他的那么简单。但是把“X”当作划掉或删除是很常见的。所以，记住这一点，我们有

*   `x`删除下一个字符
*   `X`将删除前面的字符
*   `dd`删除整行

这些字符的前面可以有一个数字，以表示许多字符。例如，`7x`将删除光标后面的 7 个字符，`5X`将删除光标左边的 5 个字符。

结合我们从上面所看到的，关于在单词之间移动光标，如果你使用`db`或`dw`(前面有一个数字)，那么许多**单词**将被删除(分别在光标之前或之后)

有一种异常，一种我经常使用的“捷径”。因此，我不会抱怨我没有能力想出一个合适的记忆方法。它是`D`，删除光标右边的所有文本——直到行尾。{你可能会记得它是执行大删除的**大 D** ，或者想象形状*向右引导*；线的尽头}

你用`i`实例化 **I** nsert 模式。当然，你失去了用 h/j/k/l 移动光标的简单性——我有时会忘记这个事实。

我发现自己最常使用的另一个命令是`A`，它也实例化了插入模式，但是将您带到了行的最末端。*我认为它是“在本行的最后一个字符后插入**一个**”。*

##### 选择和文本块

Vi 中还有另一种“模式”(可以把它看作子模式)，它模拟选择大块文本的 GUI 操作。
**V**视觉模式通过`v`进入，允许你继续使用导航键(这就是为什么我认为它从属于导航)进行选择。

这对于一个

*   **D** 删除与`dd`
*   **Y** ank(复制的术语)与`y`
*   **P** 使用`P`粘贴到当前光标位置之后，使用`p`粘贴到光标之前

你可以用`>`缩进选定的代码块，用`<`突出它

结合这些有用的东西，去一个有很多文本(代码)的行，试试这个
`wwwhvbcREPLACED`

* * *

而且，每次你发现自己大喊“不对劲！”(或者类似但不太“家庭友好”)记得用`u`代表 **U** ndo。

> 当我做了一些我想恢复的改变时，我偶尔会对“u”有点过分热情。在这些情况下，我可以通过应用命令 **R** edo，Ctrl r 来撤销我的 **U** ndo

* * *

#### 打开多个文件

`:e <path and filename>`

如果您不确定确切的路径和/或文件名，请使用 filespec。

`:e .`显示当前目录中文件的菜单式列表(例如，如果您使用了“点”)。您可以浏览文件系统(使用标准的`j`、`k`并输入

###### 外壳命令

你可以跳出 Vi，用`:sh`跳到 shell

这对于在文件上快速执行`chmod`或者运行 irb 是很方便的。
当你`exit`从 shell 中出来的时候，你又回到了 Vi 中你离开的地方。

* * *

### 搜索和替换

每个编辑(任何类型)必须包括基本的能力**搜索**和**替换**文本。Vi 毫不犹豫地在这一领域表现强劲。
任何搜索都从*命令*模式开始。
最简单的就是斜线后面跟一个字。这个`/flower`会找到第一次出现的“花”字。使用`:n`可以转到下一次出现。

为了替换文本，有几个关键选项:

*   `:s/SearchFor/ReplaceWith/g`{ g 表示*全球*。如果没有它，搜索将限于当前行}
*   `?Find/Replace/gi`将反向执行相同的操作{ I’修饰符强制 case- **i** nsensitive}

奇怪的是，当你想搜索**和**替换时，会用到字母“s”。我使用的助记符**是为了记住**的**搜索并替换和 **F** ind，只用一个斜杠。**

> 如果你喜欢对每个替换动作进行确认，只需添加“c”修饰符，就像这样`:s/Find with Confirmation/Each one/gc`

您可能会注意到熟悉的正则表达式修饰符(g，I)。事实上，搜索和替换命令将接受[许多]正则表达式求值字符。
在 [Vim 正则表达式 101](http://vimregex.com) 中有所有参数的详细描述

我从来不知道 Vi 里有这个，直到偶然发现。
当光标在一个大括号上时，跳转到匹配的大括号(花括号、方括号或标准括号)就是简单的`%`。多节省时间啊！！

* * *

### 编辑器窗口

#### 缓冲

Vi 采用了*缓冲区*的概念，并将其应用于多个文件的管理。我目睹了一个 Vi 专家在众多屏幕和多个文件中跳跃，完全被吓到了。
通过使用这几个关键缓冲区命令，您可以成为 Vi 向导

每次你用`:e filename`打开一个新文件，它被载入一个新的(按顺序编号的)缓冲区。

在命令模式下，所有的 **b** 缓冲命令都以`b`开始

*   `:b#`下一个缓冲区
*   `:bf`第一缓冲区
*   `:bl`最后一次缓冲
*   `:b4`根据其编号切换到另一个缓冲区(见插图编号)

在你问“我怎么知道我想要的缓冲区的数量？”，列出所有正在使用的缓冲区是如此简单。是`:ls`。就像文件列表的*nix 命令一样。

* * *

#### 应对人格分裂

使用分割屏幕只是对使用缓冲区的一个小小的修改。这在 Rails 中非常方便，例如，可以同时处理控制器及其视图。

您可以打开另一个文件，用`:split filename`进入分屏

如果您正在打开编辑器，您可以使用`vi -o file1 file2...`指定多个文件，这些文件将被加载到分屏中

您可以重新排列窗口在屏幕上的位置；但是这超出了本文的范围。

切换窗口就是 Ctrl w 后跟 Ctrl w 从一个窗口跳到另一个窗口。如果您记得导航键(h、j、k、l ),请将它们与配合使用，根据其在屏幕上相对于当前窗口的位置跳转到特定窗口。

使用 Ctrl w，然后按`q`将关闭( **q** uit)当前窗口。
当前窗口可以用 Ctrl w 后跟`s`进行 **s** 拆分。

> 如果您丢失了当前正在编辑的文件，`Ctrl g`将显示该文件的详细信息，包括其名称。

## 结论

对于这个功能极其丰富的应用程序的介绍来说，这已经足够了。如果你被 Vi 吓倒了，我真的希望这有助于让它变得更加平易近人。如果你有一点 Vi 的经验，我希望这突出了一些新的领域，在这些领域你可以增长你的专业知识。这些指令很快就会变成“肌肉记忆”。

我希望你能在常规的基础上认真练习这几个命令，我希望你能看到代码开发的改进。

## R E V I E W

运用我在这里介绍的记忆术，练习每一个。

*   只需退出编辑器(并开始发出命令)，然后使用冒号(:)发出一个 **C** 命令
*   在一个页面上你可以跳转到 **H** igh、 **L** ow 和 **M** idway
*   要删除一个字符，只需划掉( **x** )

*   要打开一个(另一个)文件，你需要编辑它(:E)。如果我不知道确切的文件名，你可以使用一个*文件规范*

*   当我需要时，我会插入一些文本，除非我想在一行的最后一个字符后开始 T2。
*   如果我想删除下一个单词**w**or**d**删除前面的单词 **b**
*   您可以用`12dd`删除接下来的 12 行
*   任何选中的文本都可以用 **c** 与`c`挂起
*   在 **v** 视觉模式下，按`v`即可轻松选择文本
*   你必须 **Y** ank text ( `y`)以便稍后 **P** 粘贴它(`p`，或`P`

*   从 Vi 跳到 **Sh** ell 就像`:sh`一样简单

*   当你需要在窗口之间分割工作时，切换**w**windows 就是 w
*   **B** 盎司围绕着 **b** 带着`:b#`，:bf `,` :bl `or` :b3 `的缓冲器
*   用`:ls`获取所有当前缓冲区的 **L** 列表
*   完成后，记住 e **x** it (:x)。或者只是想到睡眠( **ZZ** 和按键`ZZ`

我鼓励你在评论中分享任何你认为有用的技巧或记忆术。

## 分享这篇文章**