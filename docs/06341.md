# zep hir——在不懂 C 的情况下构建 PHP 扩展

> 原文：<https://www.sitepoint.com/zephir-build-php-extensions-without-knowing-c/>

由于 PHP 是用 C 语言编写的，很长一段时间以来，扩展它的唯一方法是要么依赖当前这一代热情的老人，要么使用 C 语言，对于许多人来说，后者不是一个选项。我们，今天的高级开发人员，太懒了，以至于不能学习这样一种非常精确、要求高、低级、以 OCD 为中心的语言。我们中的大多数人都是从高级语言开始编程生涯的——老实说，尤其是像 Javascript 和 PHP 这样的高级语言——非常坦率地说，他们对学习 C 要求你做的所有神奇的事情完全不感兴趣。这并不是说我们比那些专门处理低级别的开发人员更糟糕——这只是两个不同的世界——我们只是喜欢 web 开发的即时满足感。我花在一个中级 C 程序上的时间和一个有经验的低级开发人员开发一个跨浏览器兼容的 JS 径向上下文菜单的时间一样长。那么，PHP 开发人员应该如何用急需的功能来丰富 PHP 本身呢？

### 法尔孔

前阵子，我在[的一篇文章](https://www.sitepoint.com/google-app-engine-and-a-plea-for-phalcon/)中提到了 [Phalcon](http://phalconphp.com) 框架。Phalcon 是一个框架，它提供了比当前大多数框架更多的功能，但是它被包装成一个 PHP 扩展，你可以像 IMAP、iconv、mcrypt 或其他任何东西一样安装它。我现在不会详细说明，上面的链接提供了大量的信息，但这里重要的是 Phalcon 团队实现的里程碑的大小。

> Phalcon 是由奇妙的混血儿创造的奇妙的混血儿

Phalcon 是由出色的混血儿创造的出色的混血儿——在 PHP 和 c 两方面都很优秀的人。Phalcon 是黄金中间地带，这是一个尽可能低级的 PHP 框架(当[与其他框架](http://www.techempower.com/benchmarks/#section=data-r6&hw=i7&test=db)相比时，性能提升不可估量),但它的 API 仍然足够高级，任何有经验的 PHP 开发人员都可以像在任何其他框架中一样使用。

那么 Zephir 是什么，它和 Phalcon 有什么关系？事实证明，Phalcon 的开发人员意识到，与 Phalcon 受欢迎程度的增长速度相比，像 Phalcon 这样的 C 项目的拉式请求来得太慢了——这在很大程度上是因为面向高质量开源 C 开发人员的稀缺。由于担心瓶颈，他们进行了另一次冒险，准备重新定义我们所知道的 PHP 开发世界。他们决定建造泽菲尔。

### 泽菲尔。

如果说 Phalcon 是 C 和 PHP 之间的黄金中间地带，那么 Zephir 就是白金。Zephir 将会是(注意我说的是*将会是*，因为它仍然处于非常早期的 alpha 阶段)唯一一种让高级开发者**开发低级 PHP 扩展**的语言。

> Zephir 让高级开发人员开发低级 PHP 扩展

Zephir 将是一种静态/动态类型语言，可以编译成 c。它将拥有自动内存管理，并将在灵活和隐式的行为上强制执行严格和显式的行为。其目的是向开发人员隐藏不必要的 C 复杂性，使代码更易于调试，并产生可以像任何其他可安装的扩展一样直接在 PHP 中使用的面向对象的库。Phalcon 团队目前正在 Zephir 中重写整个 Phalcon 框架，为 2.0 版本做准备，这将允许大量使用 Phalcon 的 PHP 开发人员在不了解 c 的情况下扩展它。

除了用于开发和维护 Phalcon，Zephir 已经在其他地方使用。Zend 团队的 Apigility 项目将集成 Zephir，以允许用户提高用 Apigility 构建的 API 的性能。更重要的是，知道 Zephir 将有额外的好处，允许你用它编写整个 web 应用程序，编译成 C，并安装到你的客户端服务器上，而不用向任何人公开你的代码。Zephir 将代码保护、PHP 应用程序性能和 PHP 扩展的开发提升到了全新的水平。

> Zephir 让您真正关闭 PHP 应用程序的源代码，保护您的知识产权

需要注意的是，Zephir 并不是任何当前网络语言的替代品。也不能代替 C。它是 C 和 PHP 之间的门户，允许你编写高性能的 PHP 扩展和闭源 PHP 应用程序，而没有 C 开发周期的麻烦和时间浪费。它既不会复制 PHP 的所有功能，也不会复制 C 的所有功能——它也不是这两者的替代品。事实上，并不是每个应用程序都应该用 Zephir 重写，因为这可能只是浪费时间——例如，应该重写的应用程序是那些你关心的近源应用程序，以及那些对 PHP 解释器来说计算量太大的应用程序。例如，在 Zephir 中重写 WordPress 之类的东西将是徒劳的，因为 WordPress 是一大堆低质量的意大利面条代码，将其重写为适当的、现代的面向对象 PHP5.5 将会获得更多。

### 有代码示例吗？费尔康的表现如何？

这里和[的文档](http://zephir-lang.com/)中有一些例子[。本质上，它与你已经知道的语言非常相似——Javascript、PHP，甚至可能是 C，这使得 Zephir 成为快速学习和试用的理想选择。](http://blog.phalconphp.com/post/57161129440/phalcon-2-0-the-future)

现在，许多人想知道对性能的影响。如果 Phalcon 由于是用 C 写的而如此之快，那么用更高级的语言重写它不会使它变慢吗？嗯，是也不是。虽然它不允许开发人员深入手动分配内存空间等细节，但它将允许他们更快地工作*，这反过来将让他们更快地迭代和改进设计，而不是仅仅改进现有的实现。自然地，一些部分仍然用 C 编写，因为没有办法重写它们并保持它们的质量。*

 *Phalcon 当前实现相对于其 Zephir 版本的一些初始基准可以在这里找到。

### 今天试试泽菲尔

如果你想亲自尝试 Zephir(或者，如果你是一名出色的 C 开发人员，并且你愿意提供帮助)，你可以查看一下 [Github 库](https://github.com/phalcon/zephir)。在那里，您还可以下载、构建和安装该语言——只需按照自述文件的说明进行操作。初步文档可以在泽菲尔项目[主页](http://zephir-lang.com/)上找到，他们的博客[也可以找到](http://blog.zephir-lang.com/)。对于那些使用 TextMate 或 Sublime Text 的用户，可以在这里找到语法高亮器。

试试 Phalcon 和 Zephir，在下面的评论中告诉我们你有多喜欢它们。如果你试用了 Zephir，并用它开发了一个扩展，请随时写信给我，告诉我如何把它变成一个教程。

### 结论

如果你一直想自己改进 PHP，但从未真正开始学习 C 语言，那么 Zephir 就是你的选择。如果你想保护你的代码免受窥探和盗版，只是提高你的应用程序的性能，或者用 PHP 本身不能有效复制的功能来扩展 PHP，Zephir 就是你的选择。

我希望您已经阅读了这个有前途的新项目的简要概述，并且您和我们一样对它可能带来的好处感到兴奋。* 

## *分享这篇文章*