# Node.js vs Deno:你需要知道的

> 原文:[https://www.sitepoint.com/node-vs-deno/](https://www.sitepoint.com/node-vs-deno/)

自从发布以来， [Deno](https://www.sitepoint.com/deno-guide/) 在 JavaScript 社区中产生了相当大的兴趣。作为一个由 Node 的创建者设计的 JavaScript 运行时，您可能会认为这两个项目之间有很多相似之处，事实也确实如此。然而，也有重要的区别，这意味着你不能用一个代替另一个。

本文将看看 Deno 和它的“表哥”之间的关系，以帮助理解它们之间的共同点和区别。(如果你想先了解 Deno 的内幕，请查看我们最近的介绍。)

## 语言支持

这两个项目都是 JavaScript 运行时，允许 JavaScript 代码在 web 浏览器之外的计算机上执行。让我们看看它们在语言支持方面的表现。

### 节点. js

Node 的当前 LTS 版本(撰写本文时为 v12.18.1)支持现代 JavaScript 语法和特性。它还支持大约 75%的 ES2020 规格。ECMAScript 模块也是受支持的，但是目前还只是实验性的:你需要使用`.mjs`文件扩展名，或者将属性`"type": "module"`添加到你的项目的`package.json`文件中。

为了在 Node 上运行 TypeScript(或任何其他语言)，需要将代码编译成 V8 引擎可以执行的 JavaScript。有几种不同的方法可以做到这一点，各有利弊，因此启动和运行意味着必须选择其中一种，并遵循必要的设置过程。

### 德诺

我找不到任何关于 Deno 支持的 JavaScript 规范的内容，但是由于它也使用 V8，我认为它的支持水平与 Node 相似。我自己的测试表明，Deno 支持 ES2020 特性，如`Promise.allSettled()`和`globalThis`关键字。ECMAScript 模块是默认的，不支持 CommonJS 模块，除非您使用节点兼容性库(稍后将详细介绍)。

TypeScript 在 Deno 中被支持为一级语言，这意味着它可以开箱即用:不需要安装额外的工具来首先将文件转换为 JavaScript。当然，V8 引擎本身不支持 TypeScript，所以 Deno 仍然在幕后传输代码，但这对于开发人员来说是无缝和透明的。

我也找不到提及 TypeScript Deno v1.0.1 使用哪个版本，但它支持可选的链接和 nullish 合并(但不是私有类字段)，这将使它成为 TS 3.7。

## 蜜蜂

Deno 和 Node 都向开发人员公开了它们自己的 API，允许我们编写程序，实际上可以做一些有用的事情，如读写文件，发送和接收网络请求。

### 节点. js

当 Node 第一次发布时，没有对承诺的内置支持。因此，大多数异步操作的 API 都采用错误优先回调:

```
const fs = require('fs');
fs.readFile('readme.txt', (err, data) => {
  if (err) {
    // Handle the error
  }
  // Otherwise handle the data
}); 
```

即使节点开发人员现在可以访问 Promises 和 async/await 语法，API 仍然希望回调，以便保持向后兼容性。

### 德诺

Deno 的 API 旨在利用现代 JavaScript 特性。所有异步方法都返回承诺。Deno 还支持顶级 await，这意味着您可以在主脚本中使用 await，而不必将其包装在异步函数中。

```
try {
  const data = await Deno.readFile('readme.txt');
  // Handle the data
} catch (e) {
  // Handle the error
} 
```

开发团队还决定尽可能使用 web 标准，这意味着他们已经在可行的地方实现了浏览器 API。Deno 提供了一个全局的`window`对象，以及像`addEventListener`和`fetch`这样的 API。能够访问`fetch`是非常好的，因为使用 Node 你必须填充这个或者使用第三方库。

### 兼容性模块

Deno 提供了一个[兼容层](https://deno.land/std/node/)，目的是允许您重用现有的节点包。它还没有完成，但是目前确实支持通过`require()`加载 CommonJS 模块，以及其他功能。

## 包装管理

在包管理领域，Deno 代表了与 Node 做事方式的彻底背离。由于对 Deno 来说仍处于早期，它的方法是否有优势还有待观察。

### 节点. js

您可能知道，Node 自带了一个名为 npm 的包管理器，用于安装和管理第三方包。npm 主要与在线的 [npm 注册表](https://www.npmjs.com/)一起使用，其中列出了大多数可用的第三方软件包。

当您使用 npm 将一个包安装到您的项目中时，会使用一个`package.json`文件来指定包名和可接受的版本范围。这个包本身(加上它依赖的*包)会被下载到你的项目中的一个`node_modules`文件夹中。*

### 德诺

Deno 完全不需要包管理器。相反，包通过 URL 直接链接到:

```
import { Response } from "https://deno.land/std@0.53.0/http/server.ts"; 
```

在第一次运行代码时，Deno 获取并编译所有的依赖项。然后，它们被缓存在文件系统中，与您的项目分开，因此后续的运行要快得多。

与 npm 的`package-lock.json`文件类似，Deno 允许您指定一个锁文件，用于确保只有与您最初导入的版本完全匹配的依赖项才会被使用

## 第三方软件包

一种语言可以因其生态系统的活力而繁荣或消亡，因为生产力依赖于不必重新发明轮子！在这里，似乎节点目前有优势。

### 节点. js

Node 有一个庞大而多样的库和包生态系统。自发布以来的 11 年中，[超过一百万个](https://snyk.io/blog/npm-passes-the-1-millionth-package-milestone-what-can-we-learn/)包在国家预防机制登记册上登记。当然，质量可能会有很大差异，并且许多已经不再被积极维护，但它仍然是节点开发人员的一大优势。

### 德诺

正如我们在上一节中看到的，Deno 通过允许脚本直接从任何公共 URL 导入模块，积极地试图避免对包管理器或注册表的需求。当然，如果你不知道那里有什么，就很难导入包，所以 Deno 网站维护了一个兼容第三方模块的[列表。截至发稿时，列表中有 707 个模块。](https://deno.land/x)

### 德诺标准图书馆

Deno 试图改善开发人员体验的一种方式是提供一个针对常见任务的助手和实用程序的标准库。所有模块都由核心开发人员审核，以确保高质量、可靠的代码。还有一些模块，比如处理命令行参数的和着色终端输出的——这两个模块只作为第三方包提供给 Node。

## 安全性

或许 Deno 对 Node 最受吹捧的改进之一是权限系统。我们来看看为什么。

### 节点. js

节点运行时非常宽松，允许代码完全访问计算机的网络和文件系统。如果不加检查，第三方代码有可能对您的系统造成严重破坏。

### 德诺

改进安全模型是 Ryan Dahl 在设计 Deno 时专门着手做的事情。默认情况下，所有代码都在安全的沙盒环境中执行。这将阻止代码访问文件系统、网络和环境变量等内容，除非使用命令行参数专门授予访问权限。

```
# Allow script to make network requests
deno run --allow-net server.ts 
```

更好的是，当允许对文件系统进行读写访问或者访问网络时，您可以提供一个白名单。这意味着您可以限制 Deno 程序对项目的`data`文件夹的读/写访问，例如，限制任何潜在的恶意破坏。

## Deno:含电池

在我们结束之前，我想再谈一件事。如果你浏览一下手册的[工具部分，你会注意到 Deno 为我们提供了一些不错的“额外功能”！下面是一些内置工具，可以让开发人员的体验更好一些:](https://deno.land/manual/tools)

*   **bundler** :将一个指定的脚本*及其依赖关系*捆绑成一个文件
*   **调试器**:允许用 Chrome Devtools、VS Code 和其他工具调试你的 Deno 程序(注意:Node 还附带了一个调试器)
*   依赖项检查器:在一个 ES 模块上运行它将会在一个树中列出所有的依赖项
*   **文档生成器**:解析给定文件中的 JSDoc 注释并输出文档
*   **格式化程序**:自动格式化 JavaScript 和类型脚本代码
*   测试运行器(test runner):您可以使用它来测试您的 JS 和 TS 代码，结合标准库中的断言模块
*   linter :一个代码 linter(目前不稳定),帮助捕捉程序中的潜在问题

## 裁决

本文的目的不是提倡 Node 或 Deno，而是比较和对比这两者。现在，您应该已经了解了这两个运行时之间的相似之处，或许更重要的是，它们之间的差异。

Deno 为开发人员提供了一些特殊的优势，包括强大的权限系统和一流的类型脚本支持。设计决策和额外的内置工具旨在提供高效的环境和良好的开发人员体验。

另一方面，Node 有一个庞大而完善的生态系统，这个系统已经建立了十多年。这一点，加上大量的文档和教程，可能会使 Node.js 在未来一段时间内成为一个安全的赌注。

## 德诺基金会

跟上德诺的步伐。我们的 Deno Foundations collection 帮助您迈出进入 Deno 世界以及更远的第一步，并且我们会不断增加它。我们将为您带来成为职业选手所需的教程。您可以随时参考我们的索引，因为它在我们对 Deno 的介绍结束时更新:

➤ [德诺基金会](https://www.sitepoint.com/deno-guide#foundations)

## 分享这篇文章