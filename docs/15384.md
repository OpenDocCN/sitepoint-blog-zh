# ASP 入门

> 原文:[https://www.sitepoint.com/getting-started-asp/](https://www.sitepoint.com/getting-started-asp/)

网络的发展已经超出了一个在线手册可以满足一个典型公司对其网络形象的需求的范围。如果你的目标是将自己推销为一名网站管理员，你需要掌握一些构建在线应用程序的技能——用户可以与之交互的网站，无论是完成某件事(例如发送电子邮件)，获取针对其特定需求的信息(例如实时股票报价)，还是与其他用户交互(例如在线社区)。

在这一系列文章中，我将指导您学习创建动态网站的最流行的框架之一——动态服务器页面(ASP)。如果你能掌握很强的 ASP 知识，以及一些用它建立网站的实践经验，你应该很容易找到一份 Web 开发人员的工作。用关键字“ASP”快速搜索你最喜欢的在线工作目录，应该足以让你相信这一点。

在这第一篇文章中，我将通过介绍 VBScript 编程语言，以及如何使用它用 ASP 编写动态网页来帮助您入门。在此之前，我将停下来解释一下服务器端脚本，尤其是 ASP，与您可能熟悉的其他 Web 脚本技术(如客户端 JavaScript)有何不同。这将使你掌握适当的词汇，并确保我们在一头扎进勇敢的 ASP 新世界之前达成一致。

##### 服务器端脚本

为了理解 ASP 在 Web 开发中的位置，您需要理解服务器端脚本语言的概念。如果您以前使用 Perl、PHP、JSP 或 Cold Fusion 编写过网页，您可以安全地跳过这一部分——所有这些都是服务器端脚本语言，ASP 的工作方式也大致相同。如果你只具备 HTML 的知识(也许还有一些 CSS 和/或 JavaScript 的经验)就开始学习 ASP，那么你会发现服务器端脚本有很大的不同。

![Figure 1: Simple HTTP request and response.](../Images/ffb771f05bde7b52f9b2ac7196529263.png)首先，让我快速回顾一下标准的非 ASP 网页是如何工作的。如图 1 所示，**客户端**电脑(属于用户的电脑)上的 Web 浏览器发出页面请求，比如说`file.html` **(1)** 。假设所请求的文件存在于 Web 服务器软件可以找到它的 Web 主机上，该软件通过将文件发送回浏览器来响应请求。显示页面所需的任何附加文件(例如图像)都是以同样的方式请求和接收的。用于这种交换的协议，实际上是用于网络浏览器和网络服务器之间的所有通信的协议被称为**超文本传输协议** (HTTP)。

如果您曾经在页面中使用过 JavaScript，您会知道所请求的网页(`file.html`)除了普通的 HTML 代码之外，还可以包含用 JavaScript 编写的小程序。当网页显示在浏览器中时，这些程序或脚本由 Web 浏览器读取和执行。因此，网络浏览器不仅要理解如何阅读 HTML 并显示文本和图像，还必须能够运行网页中的 JavaScript 程序。这种安排被称为**客户端脚本**，在这种安排下，Web 浏览器在从 Web 服务器接收到脚本后运行脚本。这个名字很有意义，所有脚本都在客户端运行，即图 1 的右侧。Web 服务器完全不知道它发送的文件是否包含脚本；这完全取决于浏览器(客户端**)来处理脚本的执行。**

 **![Figure 2: ASP request-response cycle](../Images/ed1cfb4b9675dd4ebaa4ec916ea64493.png) ASP 属于另一类技术，叫做**服务器端**脚本，不再是运行在客户端的浏览器负责运行脚本；相反，是 Web 服务器**运行脚本。这个过程如图 2 所示。和以前一样，网络浏览器请求一个文件 **(1)** 。然而，在这种情况下，文件名以`.asp`(例如`file.asp`)结尾，将其标记为包含需要由服务器处理的 ASP 脚本的文件。服务器认识到这一点，并不直接将请求的文件发送回浏览器，而是将文件发送到 ASP **脚本引擎** **(2)** 。该引擎是 Web 服务器软件的一个组件，可以解释 ASP 脚本并将结果输出为 HTML。这里的技巧是，任何给定的脚本在每次运行时都可以输出不同的 HTML，因此对于每个客户端(浏览器)请求，ASP 引擎输出的内容可能不同。然后，动态生成的页面被发送到浏览器，以响应其请求 **(3)** ，与前面示例中静态页面的发送方式完全相同。**

就像当页面包含客户端 JavaScript 而服务器完全不知道这个事实一样，当页面包含服务器端 ASP 脚本时，浏览器完全不知道这一点。在浏览器看到页面中包含的 ASP 代码之前，ASP 引擎会将其解释并转换为纯 HTML 因此，就浏览器而言，ASP 页面看起来就像任何普通的网页一样。所有的工作都在服务器端完成；因此得名，服务器端脚本！

##### 设置 ASP 服务器

正如我刚才所展示的，存放您的网站的 Web 服务器必须配备 ASP 脚本引擎，以便能够处理 ASP 页面。大多数免费的网络服务器(GeoCities，Xoom 等。)不要提供这种类型的服务，如果提供也要收费。如果你不准备花钱买一个能为你提供 ASP 支持的 Web 主机，或者如果你只是想暂时跟随学习 ASP 而不在因特网上发布一个实际的网站，那么还有另一个选择。

通过在你自己的计算机上安装网络服务器软件，你可以在你的浏览器中请求 ASP 网页，并让你自己的服务器软件解释 ASP 脚本。如图 3 所示，这种设置将 Web 客户机和服务器放在同一台计算机上。虽然互联网一般无法访问此服务器来请求网页(除非您的计算机配备了永久的互联网连接和固定的网址)，但这将允许您在自己的计算机上开发和测试 ASP 脚本，而无需花钱购买 Web 主机或维护互联网连接来查看您的页面。

如果您有一个提供 ASP 支持的 Web 主机，或者如果您已经能够在自己的计算机上设置一个支持 ASP 的 Web 服务器，请随意跳过本节的剩余部分。

当选择 Web 服务器软件时，即使您将搜索范围限制在免费程序上，可供您选择的软件也是令人困惑的。然而，我们对服务器包含 ASP 引擎的要求确实大大缩小了范围。ASP 开发的理想 Web 服务器是 Microsoft Internet Information Server(IIS)5.0。这台服务器随每份 Windows 2000 免费提供；这样，您就可以访问运行 Windows 2000 的计算机了。否则，你将不得不考虑我下面讨论的替代方案，或者咬紧牙关，注册一个提供 ASP 支持的 Web 主机。

在 Windows 2000 上安装 IIS 5.0 真的很容易。只需打开控制面板，运行添加/删除程序。单击添加/删除 Windows 组件，并等待 Windows 组件向导出现。在组件列表中，您应该会看到 Internet 信息服务(IIS)。确保选中此项，如果您希望配置要安装的单个组件，请单击 Details…按钮(例如，您肯定需要文档，但您不太可能需要 SMTP 服务)。完成后，按照说明完成安装。您可能需要准备好 Windows 2000 光盘。

如果您没有 Windows 2000，还有其他选择。对于 Windows 95/98/Me/NT 计算机，您可以安装 Windows NT 4.0 Option Pack(可以，即使您运行的是 Windows 9x)。这里有补丁包:[下载 Windows NT 4.0 补丁包](http://www.microsoft.com/ntserver/nts/downloads/recommended/NT4OptPk/default.asp)。在 Windows NT Server 下，Option Pack 将安装 Microsoft IIS 4.0，而在 Windows 95/98/Me 和 NT Workstation 下，它将安装 Microsoft Personal Web Server(PWS)4.0，这是 IIS 4.0 的缩小版。这两种服务器都具有内置的 ASP 引擎，但这些引擎只支持 ASP 2.0，而 IIS 5.0 支持较新的 ASP 3.0。我将在本系列中介绍的大多数技术在 ASP 的两个版本中都同样适用；然而，该语言的一些更高级的功能只在较新的版本中可用，当出现问题时，ASP 3.0 提供了更有用的错误消息。由于这些原因，如果可行的话，您应该尝试保护具有 ASP 3.0 功能的服务器。

如果您不能或不愿意在基于 Windows 的操作系统下运行您的 Web 服务器，一切都不会失去。为服务器添加 ASP 支持有几个商业选择，比如 Apache(比如 [ChiliSoft ASP](http://www.chilisoft.com/) )。然而，这样的设置对于学习 ASP 来说远非理想，因为微软最初的 ASP 框架的许多组件严重依赖于 Windows 的功能，这些组件将从 ASP 的平台无关版本中被改变或完全丢失。

当你的电脑上安装了 ASP 的网络服务器软件，或者你的网络主机提供了 ASP 的网络服务器软件，你的第一步应该是写一个简单的 ASP 脚本来检查一切是否正常。

##### 你的第一个剧本

首先，你应该建立一个简单的网页，并使用浏览器查看，以确保你的 Web 服务器运行正常。如果您将使用 Web 主机进行 ASP 开发，那么您可能对相关步骤很熟悉。通常情况下，你必须使用 FTP 程序将网页放在你的网络主机的服务器上，然后你可以通过键入地址(例如**http://www.mywebsite.com/testing.html**)用你的网络浏览器访问它。

如果您已经在自己的计算机上安装了 Web 服务器软件，则涉及到类似的过程。然而，不用通过 FTP 把文件发送到服务器，你只需要把你想要的文件放在你的 Web 服务器期望的目录中。微软 IIS 和 PWS 都默认使用`C:Inetpubwwwroot`。一旦一个文件被放入该目录，你就可以通过打开你的网络浏览器并输入地址`http://localhost/file.html`来查看它，其中`file.html`是你放入该目录的文件的名称。

请注意，将文件放在适当的目录中并使用上述地址与仅使用浏览器中的“文件|打开…”菜单命令直接从硬盘上查看文件是非常不同的。通过键入地址，您指示浏览器从运行在您计算机上的 Web 服务器请求文件。这使得服务器软件有机会处理网页可能包含的任何 ASP 脚本。如果您使用“文件|打开…”直接打开文件，或者通过在地址栏中键入路径和文件名(即`C:Inetpubwwwrootfile.html`)来打开文件，服务器不会首先破解文件，服务器端脚本也不会被处理。这就是为什么你总是使用`http://localhost/`地址在你的电脑上打开 ASP 页面是很重要的。

现在，假设您能够将一个基本的 HTML 网页放在您的服务器上并如上所述查看它，您现在应该准备好尝试编写和查看 ASP 脚本了。打开记事本，或您喜欢的任何文本编辑器(UltraEdit、HotDog Professional、HomeSite 和 Visual Studio 等程序都为突出显示 ASP 代码提供了方便的支持，以及其他功能)，然后键入以下代码:

```
<html>

<head>

<title> My First ASP Page </title>

</head>

<body>

<%

' Write out a simple HTML paragraph

Response.Write "<p>This is a test of ASP.</p>"

%>

</body>

</html>
```

如果您认为这段代码看起来非常像 HTML 文件，那么您的想法是正确的。将文件另存为`asptest.asp`。在记事本中，你需要在“保存类型”下拉菜单中选择“所有文件”，或者用双引号(`"asptest.asp"`)将文件名括起来，以避免文件被重命名为`asptest.asp.txt`。如果您使用的是 Web 主机，请使用 FTP 或主机提供的任何替代方法将文件上传到您的帐户。如果您使用的是在您自己的计算机上运行的服务器软件，请将文件复制到服务器的 Web 根文件夹中(对于 IIS 或 PWS，`C:Inetpubwwwroot`)。

现在，尝试通过键入地址在 Web 浏览器中查看 ASP 页面。如果你把文件放在网络主机上，这应该类似于**http://www.mywebsite.com/asptest.asp**或者**http://localhost/asptest . ASP**如果你使用的是运行在自己电脑上的服务器。

![asptest.asp](../Images/f4170bd3ac4211023b46ace7aeada977.png)

您应该会看到一个包含单词`"This is a test of ASP."`的网页，就像上面显示的那样。如果你得到的是一个空白页，很可能你的 Web 服务器没有处理 ASP 代码。试试你的网络浏览器的“查看源文件”功能。如果页面的代码与您在上面输入的完全一样，那么肯定有问题。请记住，Web 服务器中的 ASP 脚本引擎应该处理 ASP 代码，并在将其发送到 Web 浏览器之前将其转换为普通的 HTML。事实上，如果一切正常，当您使用“查看源代码”时，应该会看到下面的代码:

```
<html>

<head>

<title> My First ASP Page </title>

</head>

<body>

<p>This is a test of ASP.</p>

</body>

</html>
```

注意 ASP 代码，以`<%`开始，以`%>`结束，已经被一个简单的文本段落的 HTML 代码所取代。如果没有出现这种情况，那么要么是您没有通过 Web 服务器查看该页面(也就是说，您使用了“文件|打开…”在浏览器中打开该页面，我警告过您不要这样做)，要么是您的 Web 服务器的 ASP 支持不起作用(或者不存在)。如果在回顾了这些可能性之后，你仍然被一个不能正常工作的测试页面所困扰，在 [SitePoint 社区论坛](http://www.sitepointforums.com/)上发布你的问题，或者直接给我发邮件，我会在我的时间表允许的情况下帮助你(通常，你会从论坛社区得到更快的回复)。

##### 它是如何工作的

假设你已经让你的 ASP 测试页工作了，你可能很想知道它是如何工作的。毫无疑问，您已经猜到了，文件的前五行只是普通的 HTML。

```
<html>

<head>

<title> My First ASP Page </title>

</head>

<body>
```

ASP(事实上，也是目前使用的大多数服务器端脚本语言)最方便的一个方面是，它允许您用普通的 HTML 散布脚本代码。脚本代码得到处理，而普通的 HTML 按原样发送(有几个明显的例外，您稍后会看到)。

下一行标记了该页面中实际 ASP 代码的开始。

```
<%
```

每个 ASP 代码块都必须以一个开始标记(`<%`)开始。这让 ASP 脚本引擎知道它应该开始将 ASP 代码转换成 HTML。这个标记不一定要单独出现在一行中；正如我将在后面的例子中展示的，一个 ASP 代码块、标记等等，实际上可以出现在一行中的一个 HTML 标记的中间。在这种情况下，我将标记放在一个单独的行上，使它更加突出。

下一行实际上什么都不做:

```
' Write out a simple HTML paragraph
```

这一行就是程序员所说的**注释**。该行开头的撇号将该行的其余部分标记为 ASP 脚本引擎可以忽略的内容。对于脚本来说，这一行完全没有功能，如果您删除它或以任何方式更改它(除了撇号)，您根本不会影响脚本的工作方式。尽管如此，在您的代码中散布一些像这样的解释性注释是一个很好的编程实践，以便于任何需要阅读和理解您的代码的人(包括您自己！).

注释不需要单独出现在一行中。一旦看到撇号，ASP 引擎将忽略它出现的行的剩余部分，所以您也可以在行尾放置一个注释，跟在它所属的命令后面。

说到命令，下一行是脚本中第一个也是唯一一个 ASP 命令:

```
Response.Write "<p>This is a test of ASP.</p>"
```

简单来说，一个 ASP 命令，或者说**语句**，是一段告诉 ASP 脚本引擎做一些事情的代码。通过按照您希望的完成顺序一个接一个地列出一系列语句，您可以编写一个 ASP 脚本，它可以按照指定的顺序执行任意数量的操作。然而，在这种情况下，我只需要脚本做一件事:写出产生一段文本所必需的 HTML 代码，这段文本写道:“这是对 ASP 的测试。”

代码`Response.Write`是 ASP 的说法，“将以下内容写入网页。”接下来是要编写的 HTML 代码，用双引号括起来，标记要编写的文本的**字符串**的开始和结束(ASP 中文本的任何部分都称为文本字符串)。

告诉 ASP 要做什么之后，我用结束标记(`%>`)结束了 ASP 代码块。像上面的开始标记(`<%`)一样，结束标记用来指示普通 HTML 代码和 ASP 脚本命令之间的界限。当看到一个结束标记时，ASP 脚本引擎返回到只发送键入的 HTML 代码。

```
%>
```

为了结束这一页，我添加了熟悉的结束标记:

```
</body>

</html>
```

现在你知道了！有了这个简单 ASP 脚本的指导，您至少应该能够指出您的`asptest.asp`文件中的每一行并解释它做了什么(或者，在注释行的情况下，它没有做什么！).然而，你可能会问一个非常明智的问题:“这难道不是创建一个简单、陈旧的 HTML 页面的冗长方法吗？”

你说对了一部分。当然，每个浏览过`asptest.asp`的人只会看到这个简单的一行程序。但是神奇之处在于这个一句话是如何产生的。每次有人请求该页面时，都会动态地重新创建它。你提供给 ASP 的代码每次运行时都会产生完全相同的输出，这不是 ASP 的错。实际上是我的错。请允许我通过修改您的`asptest.asp`文件的代码来纠正这种情况，如下所示:

```
<html>

<head>

<title> Time Check </title>

</head>

<body>

<%

' Write out a the current server time

Response.Write "<p>The server time is now: "

Response.Write Time

Response.Write "</p>"

%>

</body>

</html>
```

保存更改，然后将更新的文件放在您的 Web 服务器上。当您现在在浏览器中查看该页面时，您应该会看到如下内容:

![Modified asptest.asp](../Images/d23a831ec2dd629d35a592c6f9afafa8.png)

请注意，当您刷新浏览器时，时间会根据运行 Web 服务器的计算机的时间进行更新。还要注意，当您在浏览器中使用“查看源代码”命令时，您看到的只是普通的 HTML 代码。ASP 在将时间发送到浏览器之前将时间写入页面。最终结果是:一个动态的网页，尽管非常简单。

这一页中唯一的新技巧是在第 9 行使用了特殊的单词`Time`。因为这个单词没有用双引号括起来，ASP 知道它不应该只是打印出单词“Time”相反，ASP 知道单词`Time`应该用一串表示当前时间的文本替换(例如“下午 5:32:45”)，这就是`Response.Write`命令输出的内容。在本系列的后面，你将学习其他特殊的 ASP 单词，如`Time`。

还要注意，这个新脚本包含三个 ASP 语句，每个都是一个`Response.Write`命令。这些代码按照它们出现的顺序，从上到下执行，产生所需的 HTML 代码。

##### 总结

通过这篇文章，你已经迈出了进入 ASP 世界的第一步。本系列的下一篇文章将涵盖您需要了解的关于 VBScript 语言的所有内容，VBScript 是用于编写 ASP 脚本的主要语言(您也可以使用 JavaScript)。之后，您将准备好处理构建 Web 应用程序的主题，该应用程序在 ASP 中访问数据库和其他服务器端资源，所有这些都将在本系列的后续文章中讨论。

然而，如果你急着继续前进，微软 IIS 和 PWS 附带的 ASP 文档，以及微软脚本技术网站上的 VBScript 文档都写得相当好，应该可以帮助你。如果文档对你来说太晦涩，你可能会发现 WROX 出版社的《ASP 3.0 入门》这本书很有帮助。

祝你好运，我希望在本系列的第二部分中尽快见到你！

## 分享这篇文章**