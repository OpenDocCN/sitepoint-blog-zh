# 在 PHP 中使用正则表达式

> 原文:[https://www.sitepoint.com/regular-expressions-php/](https://www.sitepoint.com/regular-expressions-php/)

当我刚开始用 PHP 编程时，我发现正则表达式非常难。它们很复杂，看起来很难看，很难弄清楚，而且似乎真的缺乏这方面的文档。本文将向您提供关于它们是什么、它们如何有用以及如何应用它们的见解。

##### 什么是正则表达式？

正则表达式最初是作为 Unix shell 的一个特性出现的。它们旨在使查找、替换和使用字符串变得更容易——自从它们被发明以来，它们已经在基于 Unix 的操作系统的许多不同部分得到广泛使用。它们通常在 Perl 中使用，并且从那时起已经被实现到 PHP 中。

##### 我能用它们做什么？

正则表达式有一些常见的用法。也许最有用的是表单验证。例如，您可以使用正则表达式来检查输入到表单中的电子邮件地址是否使用了正确的语法。我们将在本文的后面考虑这个具体的例子。

您还可以使用它们在给定的文本主体内完成复杂的搜索和替换操作，这是 PHP 的标准`str_replace` 函数所做不到的。是的，可能性是无穷的！

##### 我如何使用它们？

让我们看看如何使用正则表达式来检查输入到提交给 PHP 脚本的表单中的电子邮件地址的语法。

PHP 中包含两种类型的正则表达式函数:

*   `ereg`函数——PHP 的标准正则表达式语法*   the `preg` functions, which use a Perl-compatible regular expression syntax

    对于本文，我们将使用`eregi` 函数。`eregi` 函数用于将一个字符串匹配到一个特定的正则表达式。函数名中的“`i`”表示“不区分大小写”——如果你想区分大小写，也可以使用`ereg`。

    你可以在这里看到 eregi 函数的 PHP 手册页。

    如您所知，电子邮件地址总是采用特定格式:

    用户名@域。延长

    这使得它们成为用正则表达式测试的理想候选对象。所以让我们来看看我写的一个检查邮件地址有效性的表达式。我们将分别查看表达式的每一部分，然后我将在文章的结尾包含一个语法参考。但首先，这是表达式本身:

    ```
    eregi('^[a-zA-Z0-9._-]+@[a-zA-Z0-9-] 

    +.[a-zA-Z.]{2,5}$', $email)
    ```

    如果您和我第一次使用正则表达式时一样，那么这个例子可能看起来非常令人困惑！让我们把它分成几个部分，分别理解每一部分:

    ```
    ^[a-zA-Z0-9._-]+@
    ```

    表达式的这一部分验证电子邮件地址的“用户名”部分。表达式开头的帽子符号(`^`)表示字符串的开始。如果我们不包括这一点，那么有人可以在电子邮件地址前键入他们想要的任何内容，它仍然会有效。

    方括号中包含的是我们希望在地址的这一部分中允许的字符。在这里，我们允许字母 a-z、A-Z、数字 0-9 和符号下划线(`_`)、句号(`.`)和破折号(`-`)。你可能已经注意到了，我用大写字母和小写字母都写了。在本例中，这并不是绝对必要的，因为我们使用的是 eregi(不区分大小写)函数。但是为了完整起见，我将它们包含在这里，并向您展示这些函数是如何工作的。括号中字符对的顺序无关紧要。

    方括号后的加号(`+`)表示“前面括号中的一个或多个内容”。因此，在这种情况下，我们需要在地址中包含方括号中的一个或多个字符，以便进行验证。最后，有一个'`@`'符号，这意味着我们需要在用户名后面紧跟一个`@`符号。

    ```
    [a-zA-Z0-9._-]+.
    ```

    表达式的这一部分与我们所看的部分非常相似。它验证电子邮件地址中的域名。像以前一样，我们在方括号中有一系列字符，我们将允许在地址的这一部分使用这些字符，后跟一个加号(`+`)，需要一个或多个这样的字符。

    在这一部分的末尾，有一个反斜杠，然后是一个句点。这告诉表达式在表达式的这一点上需要一个句点(即。在域和扩展之间)。然而，反斜杠稍微复杂一些。在正则表达式中，句点实际上意味着“任何字符”。为了让这个表达式采用句点的文字值，而不是将其用作任何字符的通配符，我们需要“转义”它—这是通过在句点前面加一个反斜杠来完成的。如果您使用 MySQL 之类的数据库，可能会遇到这种情况，因为转义字符在那里也非常重要。

    ```
    [a-zA-Z]{2,4}$
    ```

    这是表达式的最后一部分。开头是另一组用方括号括起来的字符。这一次，我只允许字母 a-z 和 A-Z，因为数字和其他字符在域扩展中是无效的。

    我们没有使用之前使用的`+`符号，而是在方括号后面紧跟了`{2,4}`。这意味着我们要求电子邮件地址中包含方括号中的 2 到 4 个字符。So com，net，org，uk，au 等。都是有效的，但是任何超过这些长度的都是不被接受的。

    最后，表达式末尾的`$`符号表示字符串的结束。如果我们不包括这一点，那么用户可以在电子邮件地址的末尾键入任何内容，它仍然会验证。

    下面是一个脚本的源代码，您可以用它来测试这个正则表达式，以及您想使用的任何其他表达式:

    ```
    <?php  

    if (!$_REQUEST['action']) {  

    ?>  

    <form action='<?=$_SERVER['PHP_SELF']; ?>' method='POST'>  

    Email Address: <input type='text' name='email'>  

    <input type='hidden' name='action' value='validate'>  

    <p>  

    <input type='submit' value='Submit'>  

    </form>  

    <?php  

    }  

    if ($_REQUEST['action'] == 'validate') {  

    if (eregi('^[a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+.([a-zA-Z]{2,4})$',   

            $_REQUEST['email'])) {  

    echo 'Valid';  

    } else {  

    echo 'Invalid';  

    }  

    }  

    ?>
    ```

    请随意在您自己的站点上使用我们上面创建的正则表达式来验证电子邮件地址，或者根据您自己的目的修改它。

    ##### 语法参考

    这是一些基本语法的快速参考。我们在前面已经看到了很多，但是这里有一些新的东西可能对您有用。

    ```
    ^   start of string

    $   end of string

    [a-z]   letters a-z inclusive in lower case

    [A-Z]   letters A-Z inclusive in upper case

    [0-9]   numbers 0-9 inclusive

    [^0-9]   no occurrences of numbers 0-9 inclusive

    ?   zero or one of the preceding character(s)

    *   zero or more of preceding character(s)

    +   one or more of preceding character(s)

    {2}   2 of preceding character(s)

    {2,}   2 or more of preceding character(s)

    {2,4}   2 -- 4 of preceding character(s)

    .   any character

    (a|b)   a OR b

    s   empty space (known as whitespace)
    ```

## 分享这篇文章