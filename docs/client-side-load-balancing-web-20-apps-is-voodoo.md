# 客户端负载平衡 Web 2.0 应用程序是巫术

> 原文：<https://www.sitepoint.com/client-side-load-balancing-web-20-apps-is-voodoo/>

Digital Web 最近发表了一篇关于“[Web 2.0 应用的客户端负载平衡](http://www.digital-web.com/articles/client_side_load_balancing)”的文章。我想花点时间解释一下为什么我认为这种负载平衡技术是个坏主意。但首先，这里有一个简单的概念:

1.  您的网站以相同的方式部署在多个 web 服务器上。
2.  您客户的浏览器从您的服务器中检索 web 应用服务器列表，比如以 XML 格式。
3.  然后，浏览器“随机选择要呼叫的服务器，直到有一个响应为止”，并且“每个呼叫都有一个预设的超时”。如果呼叫时间超过预设时间，客户端会随机选择另一台服务器，直到找到响应的服务器为止”。

无论我花多长时间和精力思考这个概念，我都无法说服自己，它甚至在理论上听起来很好。原因如下:

1.  我们仍然有一个单点故障。如果我们的 web 应用程序无法检索到有效的服务器列表，会发生什么？
2.  正确地进行故障转移既困难又不优雅。在尝试另一台服务器之前，客户端应该允许多少“预设时间”？我们的客户能接受这个等待时间吗？应用程序能准确区分服务器离线和普通的网络拥塞吗？
3.  现在我们的客户端代码包含了这个负载平衡逻辑，我们有更多的测试要做，以确保它可以在每个平台的每个浏览器中工作。
4.  负载以完全随机的方式分布在服务器之间。浏览器无法知道它只是向一个已经很忙的服务器发送了一个请求。

服务器端硬件负载平衡提供了许多优于客户端方法的优势，这些优势不容忽视。您应该考虑的其他一些事情有:

1.  硬件负载平衡器能够将请求分配给负载最小的服务器。它们还可以快速检测到 web 集群中的中断，并根据需要引导流量。为什么要让我们的客户等待他们的浏览器为我们检测到这种中断——然后由*决定采取什么适当的行动？该检测应用的*质量*依赖于(开发者)且难以保证。*
2.  消除单点故障。冗余负载平衡器的设置大大降低了停机的可能性。有可靠的方法可以做到这一点，而且不会在你的口袋里留下一个洞。
3.  您可以以不会让客户感到困惑的方式将更新部署到您的站点；使用负载平衡器向客户隐藏服务器，直到您的站点更新得到部署和测试。
4.  负载平衡器还可以充当静态资源的缓存层。这降低了 web 服务器的负载，并更快地向客户提供内容！

最后，我认为，如果您不辞辛苦地构建您的应用程序，以便它可以跨多个节点运行，并且您已经签署了 3 或 4(或更多)台服务器的支票，那么在所有服务器前面放置至少一个负载平衡器(2 个，如果您能够负担得起并管理它的话)似乎并不困难。在您走到这一步之后实现客户端负载平衡似乎是您所有辛勤工作的一个污点。

我的下一篇文章将会更深入地探讨伸缩和负载平衡。在那之前…:)

## 分享这篇文章