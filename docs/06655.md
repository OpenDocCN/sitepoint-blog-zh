# 不要忘记你的重定向！

> 原文：<https://www.sitepoint.com/dont-forget-your-redirects/>

我今天访问了我的网上银行系统。这就是出现的情况:

```
	Not Found

```

这是一条纯文本消息——甚至不是 HTML。我已经使用同一个网址至少十年了，所以有点担心。幸运的是，我对这种网络胡扯有些了解，很快就找到了正确的页面。技术含量较低的用户如何应对？

我不会说出这家公司的名字，但它是英国最大的银行之一，在信贷危机期间遭受了损失*(诚然，这并没有减少多少选择)*。我怀疑他们的热线已经被困惑和恐慌的顾客淹没了，他们无力支付账单。事情本不应该是这样的，稍微提前计划一下就可以避免损失数百小时的支持时间。

## 变化是不可避免的

好的 URL 应该永远不会改变，但是…

…不管你在页面和 URL 结构上花了多少心思或计划，它们最终都会改变。技术进步会产生影响。将实施新功能。经理们会沉迷于轻率的权力斗争。SEO 顾问会痛斥你的关键词。新开发人员会认为你的想法有缺陷。你会想到更好的方法。

原因并不重要:*你的网址会改变*。

## 转换策略

一些客户认为用户只会收藏他们的主页。事实上，成千上万的用户可能已经将你的任何一个页面加入了书签。其中两个是 Google 和 Bing 机器人，它们试图索引一切。如果你没有预算来管理这个问题，你的网站升级是不完整的！好在过程并不难…

**1。检测你的 404 页面**
第一步:确定什么时候找不到页面——永远不要依赖你的网络服务器的标准 404 页面。

如果您通过单个控制器路由所有请求，这应该很容易。如果没有，您可以使用 Apache 重定向到错误处理页面。适用于您的服务器的 htaccess 文件或等效文件，例如

```
errordocument 404 /error.php
```

**2。如果可能的话重定向**
您现在需要提取用户试图访问的页面，并将其映射到一个新的 URL。如何实现这一点将取决于网站的复杂性和规模，例如

1.  在简单的情况下，可以使用字符串替换或正则表达式，例如/oldsite/*直接映射到/newsite/*。
2.  在 URL 变化剧烈的大型网站中，您可能需要一个数据库表来存储所有旧页面到新页面的一对一映射。

对于大多数网站，我会建议一个相当简单的折衷方案，使用 URL 中的关键字来检测最重要的重定向，例如在 PHP 中:

```
<?php
// requested URL
$addr=strtolower($_SERVER['REQUEST_URI']);

// redirects
$redir = array(
	'contact' => '/about/contact-us',
	'mail' => '/about/contact-us',
	'about' => '/about',
	'term', => '/terms-and-conditions',
	'service', => '/services'
);

// redirect if possible
foreach ($redir as $old => $new) {
	if (strpos($addr, $old) !== false) {
		header('HTTP/1.1 301 Moved Permanently');
		header('Location: ' . $new);
		exit;
	}
}
```

这也可以用来实现 URL 别名，例如，在上面的例子中，即使没有创建“电子邮件”页面，输入 http://site.com/email 的用户也会被定向到联系信息。

**3。日志重定向失败**
当新网站上线时，你很可能会错过一些旧的网址。404 错误通常会记录在您的服务器日志文件中，但我建议您将请求的 URL 记录到一个单独的文本文件或数据库中，以便于检查。如果你想惹恼某人，把所有的失败直接发邮件给他们——他们很快就会要求一个更好的重定向系统。

**4。改进你的错误页面**
如果其他都失败了，发送一个 404 标题，显示一个易于理解的错误页面。说明所请求的页面不可用，可能已移动到其他地方。提供帮助，展示网站地图和/或热门内容的链接。

我原本希望，到 2013 年，大多数网站会将这些简单的政策付诸实践。即使是一个指向主页的重定向也比看到“没有找到”要好。我猜我的银行从来没有收到备忘录？或者也许他们最终花光了钱？*抱歉，我要提取我一生的积蓄……*

## 分享这篇文章