# 实用代码重构，第 3 部分——可扩展性

> 原文:[https://www.sitepoint.com/practical-code-refactoring-3/](https://www.sitepoint.com/practical-code-refactoring-3/)

在本系列的第 2 部分中，我分享了一些关于代码可读性重构的问题。在这一部分中，我们将花一些时间讨论另一个方面，可扩展性。我们将采用与上一部分相同的实际问题/讨论方法，这样你就能尽快进入重构的新世界。

可扩展代码是一段遵循可重用的、逻辑的、众所周知的模式的代码，无论是标准设计模式还是正常的逻辑流程。模块化代码往往是高度可扩展的，而单体代码往往是不可扩展的，但单体代码可能更有效，因此为了解决这个难题，一些实践允许以模块化方式开发和以单体方式部署，这样我们可以两全其美。

我们要讨论的关于可扩展代码的主要方面是:逻辑可扩展性(正常的逻辑流程和设计模式)、模块化设计、解耦和封装。

## 逻辑扩展性

**1。大多数代码块遵循正常的逻辑流程吗？**

当你处理小的逻辑问题时，确保你使用了正确的结构(if，for，foreach，while，等等。).我所说的“正确的结构”是指你应该为这项工作使用最符合逻辑和最通用的语言特性。例如，简单数组的循环应该用 foreach 来完成；这是常见的正常流程，而在 PHP 这样的语言中，使用 for 循环进行如此简单的迭代不是正常流程。对于这样一个简单的任务，使用 while 就更奇怪了。您可能有自己的理由，在这种情况下，回想一下前一部分关于记录任何自定义实践的内容，您就可以了。

**2。复杂问题的解决方案遵循标准的设计模式吗？**

当我第一次开始使用 PHP 时，我对设计模式没有太多的了解。现在我发现使用设计模式对于大型项目来说是必须的，因为它们通常被理解并对未来的发展负责。

您应该使用定义良好的标准模式来解决的一个常见的复杂问题是创建某个类的各种实例。但是为什么以及何时使用工厂设计模式呢？这可能是有争议的，但是一个通用的指导原则是，如果你有同一个接口的不同实现，并且你需要实现动态创建的对象，那么这个模式可能是合适的。另一种情况可能是当生成相同类的多个动态对象时，但是该数目只有在运行时才知道。例如，现代的 GUI 密集型 web 应用程序可能需要为数据库记录动态创建表单输入行。设计模式有用的例子不胜枚举。

## 标准设计

**1。代码结构遵循模块化设计吗？**

模块化设计意味着您将应用程序划分为多个模块。由小应用组成的大应用更容易开发，也更容易扩展和维护。每个模块都应该收集一些相关的特性和功能，并将它们组合在一个实体中。

核心功能和应用程序入口点也可以被视为模块。然后，您可以在将来通过添加新模块来添加功能。一些人称以这种方式使用的模块为插件。无论你为你的应用程序选择什么样的设计和结构，你都需要确定模块/插件是如何加载和卸载的，它们的基本结构是什么，等等。并在开发核心模块之前考虑它。

每当你看到某个模块中的代码组作为它的一个子实体，被最顶层的模块用最少的参数消费，为什么不把它分割成一个新的模块呢？一般来说，当我有一个子实体，它分解了不止一个类来完成一些附带的任务时，我会毫不犹豫地把它转移到一个新的模块中。

对于设计良好的模块化应用程序中的孤立代码，实用程序模块是一个简洁的解决方案。每当我有一些孤立的代码时，我就把它转移到一个处理代码片段和小任务的实用模块中。该模块通常由孤立函数和小类组成。每当这些任务足够大时，我就开始在一个持续的重构过程中将它们转移到它自己的独立模块中。

**2。模块依赖性最小吗？**

模块应该尽可能的独立。软模块依赖是自然而好的，例如“库存”模块依赖于“会计”模块来获得同构电子商务系统，但是许多硬依赖是不好的。它们使得调试和部署更加困难。

为了确保更少的模块间依赖，您必须不时地迭代您的代码库，以查看模块之间是否有任何硬依赖。如果可以的话就清除它们，如果不行的话就应该把两个模块合并成一个具有更通用名称的模块。例如，在电子商务应用程序中，您可能有一个“项目”模块和一个“库存”管理模块，库存中的类大量使用项目中的类，反之亦然。我会将两者合并，并将模块重命名为“Inventory ”,它有一个处理项目的子模块。

## 去耦和封装

**1。函数、方法和类是公平解耦的吗？**

添加分页功能来显示来自数据库的结果是一项非常常见的任务。事实上，在我 PHP 开发生涯的早期，我编写了一些代码来进行结果分页；代码起初是程序性的，构成了处理数据库和结果的非常具体的函数。然后，我决定将分页算法从每个组件中分离出来，并在策略模式的变体中使用它。每当您发现自己复制逻辑或代码时，您可能需要进行一些自己的解耦，以增强代码的可重用性和可扩展性。

**2。模块和组件是公平解耦的吗？**

当将依赖性保持在最低限度时，您正在以正确的方式解耦。任何两个相关的事物之间都没有 100%的分离；耦合是很自然的，所以你应该总是去耦合，但不要太多，以免让你的代码变得更复杂。作为一个指导方针，解耦，直到你的模块和你的代码库的组件可以一起交流，而没有重复的共同点。

请记住，只要复杂性没有增加，降低依赖性就与可用性和可扩展性成正比。当复杂性开始增加时，这种关系开始变得不成正比。

## 摘要

在这一部分中，我们讨论了重构代码的可扩展性，集中讨论了三个主要方面:逻辑可扩展性、模块化设计、解耦和封装。希望现在您开始对如何开发和维护更好的应用程序有更好的了解。在最后一部分中，我们将讨论如何在不牺牲可读性和可扩展性的情况下进行重构以获得更高的效率。

<small>图片 via[Fotolia](http://us.fotolia.com/?utm_source=sitepoint&utm_medium=website_link&utm=campaign=sitepoint "Royalty Free Stock Photos at Fotolia.com")T3】</small>

## 分享这篇文章