# 谷歌应用引擎:数据库策略

> 原文:[https://www . site point . com/Google-app-engine-database-strategies/](https://www.sitepoint.com/google-app-engine-database-strategies/)

传统的企业系统已经围绕关系数据库开发了很好的设计和策略。不仅从数据一致性的角度(ACID)而且从数据库管理的角度来看，关系数据库产品都得到了很好的发展。数据库由内部维护或外包给有能力的供应商，他们拥有完善的备份、迁移和安全流程。

与此相反，新兴的云技术通常不使用 SQL 数据库结构。该数据库在云提供商的基础设施中维护。数据库管理，尤其是备份过程，是松散定义的&到目前为止还不成熟，并随着时间的推移而发展。如果一家企业正在从传统的关系数据库迁移到基于云的数据库，那么考虑到所有这些因素，这一迁移可能会势不可挡。

了解正确的工具和风险知识使得云数据库策略值得利用云的优势。让我们看看今天我们对 GAE 有什么选择。我们不会在这篇文章中讨论开发层面的细节，但是我会在一个高层次上理解这个场景。

## 实现策略:SQL &没有 SQL！

如果您计划将现有的应用程序迁移到 GAE，并且您的应用程序中有 JPA/JDO 层，这个任务相当简单。JPA/JDO 接口允许你将对象数据存储到数据库中，而不需要特定于数据库的代码。它适用于不同类型的数据库，因此可以很容易地将您的应用程序移植到不同类型的存储中。这种策略甚至对于新的应用程序开发也是很好的，特别是如果您想在以后保留回传统模型/数据库的选择。GAE 肯定有一些限制或“不支持的功能”，如“多对多关系”或“查询中的连接”，如果是从现有应用程序迁移，您必须考虑模型的变化。

对于完整的非 SQL 方法，您有更多的选择。虽然你可以通过 GAE 提供的 API 直接使用 Google datastore，但是你需要处理某些事情，这可能意味着额外的工作，例如，当你的应用程序使用 POJOs 时，Google datastore 处理实体。此外，使用 GAE 数据存储 API 进行事务管理有点复杂。你也将不得不处理无类型的键等。但是对我们来说，很少有像 Objectify、twig 和 slim 这样的框架可以帮助我们

尽管谷歌已经宣布了一个 SQL 版本的数据库来与谷歌应用引擎一起工作，但它仍然是一个“实验室”功能。如果您决定使用 SQL，那么基于现有的企业模型，您会有更简单的决策。您可以在数据库和应用程序之间使用 JDO/JPA 或类似的框架来适应 ORM 框架。

## 迁移和备份

到目前为止，Google App Engine 的迁移框架还没有达到预期的成熟水平。当然，一种可能是定制程序，它可以作为“任务队列”运行，并定期将数据导出到文件中，您可以将这些文件导入到您的数据库中。像 AppRocket 这样的框架在基于 Python 的应用程序中提供数据库备份，AppScale 实现了 GAE API，并作为虚拟机运行以提供各种任务。

但是一旦数据库变得非常大，以上所有方法听起来都不可靠！这是一个需要改进的空白领域。

## 可用性、一致性

App engine 在保证可用性和一致性的基础上，以两种形式提供存储。高复制存储提供了更高的读写可用性，但代价是更长的写入延迟和更高的成本。数据在多个数据中心之间复制，但最终大多数查询都是一致的。

主从数据存储选项使用一个主数据存储和一个从数据存储。数据是异步复制的，因此一致性得到了保证。但是由于只使用了一个数据存储，因此在数据存储出现问题或计划停机期间，可用性可能是“只读”的。在这种情况下，您还需要将应用程序设计为能够支持对数据存储的“只读-不写”操作。

## 最后一个词:性能

没有一个关于数据库的话题是不完整的，如果不讨论性能的话！虽然对性能的详细处理需要单独讨论。GAE 数据存储不是传统的关系数据库，需要不同设计的应用程序、不同的索引技术，最重要的是，需要很好地了解您选择哪种存储。

例如，在主-从存储中的单个事务中更新的所有实体应该属于同一实体组，而高复制数据存储不需要这样。应用程序的设计需要从不同的数据存储角度进行充分考虑，以利用规模和基础架构！

来自 Shutterstock 的鼬宇智波图片

## 分享这篇文章