# 国际化 99 设计

> 原文:[https://www.sitepoint.com/internationalizing-99designs/](https://www.sitepoint.com/internationalizing-99designs/)

99designs 的数据科学家 Lars Yencken 解释了他们如何通过六种语言向 18 个国家的客户提供本地化内容。这篇文章最初发表在 [99designs 科技博客](https://99designs.com/tech-blog/)上。

两年前， [99designs](https://99designs.com.au/) 为少数英语国家提供本地化网站，我们的开发团队在多语言网站开发方面没有什么经验。但我们认为翻译我们的网站是重要的一步，为全世界的设计师和客户一起工作扫除了又一个障碍。

今天，我们为 18 个国家的客户提供六种语言的本地化内容。这是我们如何到达那里的，以及我们遇到的一些路障。

## 开始本地

国际化最困难的方面是语言，所以我们从本地化开始:除了语言之外的一切。特别是，这意味着适合地区的内容和货币。经过六个月的开发工作，我们重构了我们的核心 PHP 代码库，以支持大量国家/地区的本地域(例如 [99designs.de](https://www.99designs.de) )，客户可以看到本地内容，用户可以用本地货币支付和接收款项。

在这个过程的最后，每次我们启动一个区域域，我们开始根据 GeoIP 查找将用户从我们的 Varnish 层重定向到那个域。从那以后，这一过程几乎没有什么变化，并且在我们最近在新加坡的发布中继续很好地为我们服务。

![A density map of 99designs activity](../Images/7b26786b2ba6e273b06798eec618a22f.png "A density map of 99designs activity")

## 语言和翻译

随着本地化的进行，是时候做出艰难的决定了，我们将如何为非英语使用者(即世界上的大多数人)消除语言障碍。有许多问题需要我们回答。

*   在给定的地区，我们将为用户提供什么语言？
*   用户将如何选择他们的语言？
*   我们将如何向用户呈现翻译后的字符串？
*   字符串将如何排队等待翻译？
*   谁来做翻译？

### 提供什么语言？

我们没有让区域、语言和货币都可供用户选择，而是选择将语言和货币的可用性限制在用户所在的区域。这是一种折衷，使处理本地内容更容易:如果我们的德国地区不支持西班牙语，我们就不必为它写西班牙语营销文案。

我们的一个警告是所有地区都支持英语作为一种有效的语言。作为一种国际贸易语言，这减少了地区牵制的负面影响。

### 翻译字符串

我们考虑了两种主要的翻译方法:使用传统的 [GNU gettext](https://www.gnu.org/software/gettext/) 方法并开始转义字符串，或者尝试一种翻译代理，如 [Smartling](https://www.smartling.com/) 。gettext 有几个优点:它历史悠久，并且受到 web 框架的良好支持；它很容易嵌入；而翻译只是成为额外的工件，可以很容易地进行版本控制。然而，这需要对我们现有的 PHP 代码库进行适当的重构，并留下如何翻译的未决问题。

在 Smartling 的方法中，用户的请求通过 Smartling 的服务器代理，依次请求我们网站的英语版本，并在用户收到响应之前对其进行翻译。当缺少翻译时，将提供英文版本，并将字符串添加到要翻译的队列中。实现这一点将意味着大大减少要修改的代码量，这是一个伟大的胜利。然而，这也给我们带来了依赖第三方来保证正常运行时间和性能的风险。

最后，出于几个原因，我们选择了 Smartling。他们提供了我们所缺乏的翻译资源和国际化专业知识。正常运行时间和性能风险通过两个因素得到了一定程度的缓解。首先，Smartling 的代理将在美国东部 AWS 地区提供服务，我们的整个堆栈也在该地区提供服务，这增加了他们的堆栈和我们的堆栈一起下沉或游动的可能性。其次，由于我们的英语域名将继续正常服务，我们的大部分流量仍将绕过代理，并在我们的直接控制之下。

## 准备我们的网站

我们确定了路线，开始工作。要做的事情比我们最初意识到的要多得多，主要分布在三个方面。

### 逸出用户生成的内容

我们网站上包含用户内容的字符串很快填满了我们的翻译队列(想想“格雷戈的标志设计”和“莎拉的标志设计”)。竞赛标题、描述、用户名、评论，凡是你能想到的，来自用户的任何东西都必须被找到并包装在一个`<span class="sl_notranslate">`标签中。这相当于对我们网站上的页面进行一次重要的持续审计，在我们进行的过程中修正它们。

### 准备 JavaScript 进行翻译

我们的 JavaScript 同样需要为翻译做准备，富客户端页面受到的打击最大。所有的字符串都需要被提升到 JS 文件的一个部分，这个部分可以被标记为翻译。字符串连接不再适用，因为它对其他语言的语法做出了错误的假设。通过 JSON API 提供的字符串同样隐藏在翻译中，这意味着我们必须找到其他方法来提供相同的数据。

### 让我们的设计更加灵活

在我们的设计和布局中，我们不再是完美的像素，因为通用导航元素的翻译字符串在目标语言中通常要长得多。相反，它迫使我们开发一个更强大的设计，可以适应字符串宽度的变化。我们停止使用 CSS 转换来改变文本的大小写，因为其他语言比英语对大小写更敏感。

## 胜利的雪球

经过 9 个月的努力，我们很自豪地推出了我们网站的德语版本，这对我们来说是一个巨大的里程碑。最艰难的工作已经完成，接下来的 9 个月我们推出了法语、意大利语、西班牙语和荷兰语网站。随着时间的推移，新的工程工作量随着每次发布而减少，因此，针对新地区的营销、支持和翻译的非技术方面现在占据了发布新语言的时间。

## 挑战

我们也遇到了一些意想不到的挑战。

### 客户端模板

我们之前提到过，客户端 JS 越丰富，确保顺利翻译所需的工作就越多。对我们来说，最大的障碍是我们使用的 [Mustache](https://mustache.github.io/) 模板，它最初是不可翻译的。值得称赞的是，Smartling 在我们的开发过程中极大地改善了他们对 Mustache 的支持，让我们扫清了这个障碍。

### 翻译非 web 工件

这并不奇怪:代理翻译对于网页来说是一种策略，但对于其他非 web 工件来说并不是一种强有力的策略。特别是，在很长一段时间里，翻译电子邮件是一件痛苦的事情，在最糟糕的情况下，工程师和国家经理基本上是通过电子邮件来回发送翻译模板。一段时间后，我们通过结合使用 Smartling 的 API 和用于电子邮件翻译的`gettext`来解决这个问题。

### 翻译字符串的指数增长

随着时间的推移，我们反复发现我们的翻译队列被大量等待翻译的字符串所堵塞。这些案例中有许多是我们没有适当标记用户生成内容的错误，但最顽固的是由于我们的长尾营销努力。为行业、产品类别和城市的每种组合创建一个页面会导致需要翻译的字符串激增。正确处理这些问题需要自然语言生成引擎对每种语言的语法有所了解。目前，我们只是将这些页面排除在我们的翻译工作之外。

## 今后

这是一个工程工作的概述，涉及到像我们这样的网站本地化和翻译成其他语言。最终，我们认为我们采用的翻译代理方法大大缩短了我们的上市时间；我们会把它推荐给其他同样在扩张的公司。现在已经有几个站点开始运行了，我们将继续混合使用代理和 gettext 方法，每种方法都是最合适的。

我们很自豪能够以多种语言发布我们的网站，并热衷于打破企业和设计师之间的障碍，无论他们在哪里，使他们能够以他们最舒适的语言一起工作。

*本文最初发表于 [99designs](https://99designs.com/tech-blog/) 。经许可转载。*

## 分享这篇文章