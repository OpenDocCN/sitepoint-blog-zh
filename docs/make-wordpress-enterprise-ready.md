# 让 WordPress 在 2021 年为企业做好准备的 5 个简单策略

> 原文：<https://www.sitepoint.com/make-wordpress-enterprise-ready/>

WordPress 是一个流行的、易于使用的、基于 PHP 的内容管理系统和博客平台。许多企业组织认为 WordPress 只是一个小公司、企业家、自由职业者和没有强大或复杂基础设施的公司使用的平台。但是如果事实并非如此呢？

本文将讨论五个策略，它们可以帮助你利用 WordPress 的易用功能。我们还将利用巨大的社区支持来开发一个企业就绪型网站。但是首先，我们将谈一谈为什么企业不愿意在他们的下一个企业项目中使用这个平台，以及为什么这些理由是没有根据的。

## 企业犹豫不决

WordPress 最初是一个博客平台，但很快适应了一般网站的使用。今天，据估计，WordPress 可能会为互联网上 35-40%的网站提供动力，并且所有电子商务的近 28%通过 WooCommerce(一个 WordPress 插件和系统)进行。然而，许多 IT 专业人员和有经验的开发人员仍然认为该平台仅用于博客，并认为它不适合处理企业的更大需求，这些企业可能需要与他们的服务集成。许多组织认为他们的系统对 WordPress 来说是“太独特”的专有系统，并认为它不适合他们的基础设施。

IT/开发人员对 WordPress 的另一个担心是，要建立并运行网站，并使用他们的系统，他们必须从头开始。事实根本不是这样。WordPress 在短短五分钟内就完成了主平台的安装，做得非常好。此外，通过使用复杂的插件，WordPress 可以接入标准化系统，使用云服务，提供 SAML 或 OAuth2 功能，等等。即使你找不到一个能满足你所有需求的插件，你也可以很容易地构建插件并扩展平台以连接到你自己的专有系统。我们将在本文中对此进行探讨。

最后，有人认为 WordPress 不够安全。他们为什么会这样想？嗯，可能是因为他们看到了很多安全更新。但是这难道不应该告诉你 WordPress 在安全方面是如此活跃，以至于它甚至在你的 it 部门早上醒来之前就发现并修复了问题吗？在网络世界中有如此大的足迹，有如此多的公司在使用它，有成千上万的开发者在关注每一寸核心。然后，对于插件(任何人都可以写，这是真的)，我们可以应用一些基本原则，只挑选最好的，审查我们允许什么插件。一切都是开源的，所以所有插件都是一本打开的书，你可以让你的开发人员浏览它们，寻找任何可能影响组织的东西。

## 策略

既然我们已经解决了在企业环境中隐藏的关于 WordPress 的一些犹豫和神话，我们可以谈论一些让 WordPress 成为任何规模的公司都可以工作的策略。虽然这些策略将涵盖许多主题，但您还可以做更多的事情。在探索这些策略时，一定要寻找更多关于[sitepoint.com](https://www.sitepoint.com/premium/library/)的信息。

### 策略 1:确定你需要什么，并锁定它

这是你的 WordPress 标准安全策略。

1.  首先确保你使用著名的 **[五分钟安装指南](https://wordpress.org/support/article/how-to-install-wordpress/)** 来设置平台。需要注意的一件事是生成安全盐。这是非常容易做到的，会给你额外的保护。
2.  **设置 SSL** 。真的很标准。
3.  **保护好你的`wp-config.php`文件**。这个文件是存放您的秘密、密码、API 密钥和平台链接以及您的企业服务的好地方。我建议不要将这个文件提交到您的存储库中，而是在某个地方保存一个备份。然后你可以把它给可能需要它的新开发者。您甚至可以将该文件移动到公众无法访问的不同位置，然后引用该文件。如果你搜索移动`wp-config.php`，你可以找到大量关于这个话题的信息。除了移动它之外，你还可以添加一个配置到你的 web 服务器配置或者`.htaccess`文件，简单地拒绝对文件的直接访问。
4.  **为你的管理面板移动登录页面**。通常，该页面位于`https://<yoursite.com>/wp-admin`。您也可以将此 URL 更改为其他位置。有插件可以帮助你做到这一点。
5.  将网站置于 CDN 或 CloudFlare 或 CloudFront 等服务之后，以获得更高的安全性。
6.  移除任何提及 WordPress 版本的标签。

为了完成上面的第 6 点，您可以使用下面提供的简单代码在两个地方完成，将它们放在您的`functions.php`文件中。

执行以下操作以删除标题和 RSS 中的版本号:

```
function remove_wp_head_version() {
  return '';
}
add_filter('the_generator', 'remove_wp_head_version'); 
```

要从脚本和 CSS 文件中删除版本详细信息，请执行以下操作:

```
function remove_wp_styles_scripts( $src ) {
  if ( strpos( $src, 'ver=' . get_bloginfo( 'version' ) ) ) {
    $src = remove_query_arg( 'ver', $src );
  }
  return $src;
}

add_filter( 'style_loader_src', 'remove_wp_styles_scripts');
add_filter( 'script_loader_src', 'remove_wp_styles_scripts'); 
```

如果你想更进一步，查看官方的 [WordPress 强化指南](https://wordpress.org/support/article/hardening-wordpress/)以获得更多提示！同样，WordPress 开发社区已经考虑了很多关于安全性的问题。因此，请务必按照您的组织希望的程度来遵循本指南。

### 策略 2:制定一个更新插件和主题的计划

现在基本的安全问题已经解决了，接下来要考虑的是如何创建一个计划来更新你的网站，你的专有代码，处理插件，并允许 WordPress 在需要时进行自我更新。

1.  首先确保你**限制了你使用的插件**的数量。添加更多插件很容易。你点击一个按钮，它就安装。然而，每一个插件都会增加你网站的代码，并使攻击面更大。一定要限制你使用的插件数量，并选择来自有名望的开发者的插件。一定要审查开发者。他们有反应吗？他们靠这个插件谋生吗？他们本身是一家公司吗？他们是不是回答了很多他们的支持票？插件更新频繁吗？如果任何一个问题的答案中出现了危险信号，继续前进，尝试另一个问题。几乎库中的每个插件都有另外三四个竞争对手。我通常发现已经安装的插件的神奇数量似乎在 10-15 之间。但是请记住，我们将在本文的后面讨论构建您的自定义代码。你不想为你已经有代码的东西安装插件。确保明智地选择！

2.  将 WordPress 置于**版本控制下**。在这里，你可以根据你的站点大小来设置你自己的版本控制策略。我通常将 WordPress 核心和插件置于版本控制之下。有时你的上传和静态资产可能太大太多，所以把它们备份在别处。这里的想法是，如果有问题，你希望能够回滚核心和任何插件的变化。但是同样，这可以设置您的组织如何管理他们的存储库。

3.  **别忘了你的数据库**！如果你更新 WordPress 或者它的插件，它也可能改变数据库。为您的数据库提供回滚策略，并确保您在那里也受到保护。我经常使用 Amazon Web Services 作为数据库，所以我会在任何重大更新之前拍摄快照。

### 策略 3:使用您自己的定制类来构建类库

到目前为止，我们已经讨论了大多数 WordPress 安装的一些最佳实践和安全策略。从现在开始，我们将讨论一些策略，你可以使用这些策略来编写你想在 WordPress 上使用的非常具体的专有代码。这将把 WordPress 扩展到企业领域，并真正推动价值。

#### 是时候收集您的代码了

企业通常有类库和函数来执行他们产品所独有的某种功能。如果你收集了这些代码，并把它放到你的 web 根目录之外的一个文件结构中，你就可以使用 WordPress 实际访问这个库并获取代码！一种方法是创建一个简单的“[必须使用插件](https://wordpress.org/support/article/must-use-plugins/)”，这是一个 WordPress 会首先加载的插件，在加载任何其他插件之前。这对于像[自动装载机](https://www.php.net/manual/en/language.oop5.autoload.php)这样的东西来说是理想的。你的插件将声明自动加载器，突然你的 WordPress 站点可以访问你的库，并且可以从任何地方获取类。构建您的库，加载它，然后您就可以开始比赛了！

好了，现在你已经通过自动加载器加载了你的类，接下来呢？嗯，WordPress 的一个强大功能是**钩子**(也称为**动作**)。当 WordPress 运行时，它会在生命周期的不同阶段寻找要调用的回调函数。从这些钩子中，你可以调用你的专有库代码，创建对象，调用自定义函数和方法，以及做其他各种事情。如果你从一开始就花时间正确地设计了这段代码，你甚至不需要重写任何东西。把它放进去，注入你的依赖项，你就可以开始了。

例如，让我们假设您有一个库类，它与您在 Amazon 的数据仓库帐户相关联。当有人登录到站点时，您希望它将该活动发送到仓库。WordPress 有一个名为`wp_login`的登录钩子。您可以使用这个钩子来执行代码，收集刚刚登录的用户的信息，并使用您的类将数据发送到仓库。

另一个例子是拦截登录请求，通过一个 [REST API](https://www.sitepoint.com/rest-api/) 调用调用第三方认证服务，获得响应，如果通过就让用户进入。突然，你的 WordPress 站点在后台使用你自己的代码检查 Okta(或类似的服务)的凭证。

### 策略 4:附加服务

基于策略 3，我们还可以在您的站点上创建一个特殊的地方，提供可以直接调用的 REST API 端点或脚本。我工作的一家公司使用一项服务，通过产品内呼叫来帮助安装试用软件。有人启动一些软件，点击一个按钮；该软件调用 WordPress 站点，该站点加载到 WordPress 中，并使用专有代码来提供试用许可证。然后，它将该许可证返回给用户，用户可以立即激活它。

这种策略可以用于各种 API、特殊门户、日志脚本等等。这个策略的美妙之处在于，这些服务位于 WordPress 旁边，可以使用你的定制专有类和 WordPress 功能来执行额外的任务、流程和集成。如果你愿意的话，这些服务甚至可以将 webhooks 发送给其他服务。

你可以这样设置:

```
/lib      <-- Custom library
/webroot
  |__ /wp-admin
  |__ /wp-content
  |__ /wp-includes
  |__ /services   <-- Services directory
      |__ /api    <-- Service that uses lib classes
      |__ /oauth
      |__ /trial-system 
```

正如你在上面看到的，我们在 WordPress 安装旁边有一个`services`目录。它可以加载像`wp-load.php`这样的文件来引入 WordPress 功能，或者通过`webroot`访问`lib`中的类来执行我们的服务。由于这些目录作为它们自己的独立服务，并不直接绑定到 WordPress，这就是我所说的“附加服务”。你可以删除`/api`,突然 API 就不存在了。WordPress 甚至没有意识到任何变化。

最后，通过拥有您自己的定制代码库，您可以为您自己的定制插件快速获取代码！WordPress 的插件很容易上手，而且你不必与公众分享。你可以为你的服务编写一个插件，从你的库中获取类和函数，并使用 WordPress 来提供新的特性。你可以做一些事情，比如锁定特定成员的部分页面，访问第三方服务以了解访问者是否可以访问他们的帐户，或者从云中提供资产。这只是一些想法，但还有很多。

### 策略 5:高级功能文件配置

大多数 WordPress 主题的一部分是`functions.php`文件。通常，在线文章谈论将一些代码放入 WordPress 是在谈论将代码放入那个文件。但是很多人没有意识到的是，这只是一个标准的 PHP 文件，和其他文件一样。您可以使用 PHP `include`和`require`语句引入其他文件。这些文件可以是你自己定制的 PHP 文件，里面充满了专有的函数代码。这些文件也可能来自你的图书馆。通过将这些文件分开并充满您自己的代码，以您认为合适的方式组织，您可以使用您的`functions.php`文件作为您自己的代码乐队的指挥。下面是一个例子，说明你可以如何布局:

```
include('lib/classes/oauth.php');
include('lib/functions/configuration.php');
include('lib/functions/utilities.php');
include('lib/functions/shortcodes.php');
include('lib/functions/actions.php');
include('lib/functions/filters.php');

// Here we do stuff with our code

add_action('wp_login', 'do_login_stuff');
function do_login_stuff() {
  // Use Oauth to contact a third-party service
} 
```

当您将这里的高级函数文件设置、我们的定制库和附加服务混合在一起时，您就创建了一个协同效应，允许企业以他们喜欢的方式扩展他们的代码。因为这些都不涉及实际的 WordPress 核心或第三方插件，你可以在不影响你的专有代码的情况下更新 WordPress 核心和插件。同样，这些代码也可以位于远离公众的独立位置，只在需要的时候才放入。

## 概括起来

在这篇文章中，我们讨论了五个简单的策略，让 WordPress 达到对企业真正有用的水平。

我们从一个基本策略开始，讨论了强化平台的过程，然后我们跳到了策略 2，即计划如何进行升级/更新。这两个主题非常普遍，因为每个公司都有自己的标准和系统来实现这些东西。

接下来，我们进入了发人深省的代码组织策略，以及如何用一些聪明的技巧，我们可以创建一个类库(策略 3)，bolt on services(策略 4)，以及我们与我们的`functions`文件的工作(策略 5)，以允许企业利用他们的代码和 WordPress 一起创建许多新功能。通过使用定制库、插件、动作、过滤器等等，企业开发人员获得了构建新服务所需的工具，这些新服务可以很好地与 WordPress 一起创建令人惊叹的新工具。利用 WordPress 的强大功能，让您的营销团队构建页面，同时利用您辛苦获得的 PHP 类库代码的力量。

我自己使用这些策略，构建了试验系统，REST APIs，集成了 Zendesk 等工具，啊哈！、Flexnet 操作，甚至专有物理软件等等。天空是无限的！我希望你已经发现这些策略是有趣和有用的！

## 分享这篇文章