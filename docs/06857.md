# 更好地理解随机

> 原文：<https://www.sitepoint.com/better-understanding-random/>

在计算机编程中，随机值对于开发不易受到恶意破坏的安全系统至关重要。例如，密码术依赖于随机值的生成及其不可预测输出的再现性。随机值在许多安全的 PHP 应用程序中也扮演着重要的角色，许多库和框架依赖它们来生成令牌、salts 以及作为其他函数的输入。

随机数生成器是一种算法，它生成一系列看似随机的数字。初始化这种算法的输入值被称为初始状态或种子。种子可以是随机数据值或已知值。

在这篇文章中，我将向您概述随机值的用途及其重要性，以及它们是如何产生的。

## 随机值的使用

PHP 中的随机值非常重要，因为它们有着广泛的用途。安全编码实践要求创建某些东西，如 CSRF 令牌、API 密钥、授权随机数、密码重置令牌和其他类似的东西时具有很大的不可预测性。它们应该以一种任何人都很难猜到的方式创建。

随机值的一些重要用途包括:

*   **生成用于加密的 salt**–salt 是一个随机值，用作加密函数的输入，通常是一个单向函数，用于散列密码。这个随机数据被称为加密的初始化向量。
*   **会话 id 等唯一标识符的生成**–PHP 被用于开发许多需要用户安全性和持久性的优秀 web 应用程序。PHP 通过其会话支持来构建定制的应用程序和更有吸引力的网站，通过使用会话 id，提供了一种在后续请求中保存某些数据的方法。
*   **为授权生成难以猜测的令牌/随机数**–许多 PHP 应用程序需要对其他应用程序和系统进行 API 调用。这种调用通常需要使用授权令牌，而不是通过网络发送用户凭证。因此，使用难以猜测的令牌非常重要，随机值在生成这些令牌的过程中扮演着重要角色，以确保安全性。

## 随机值生成

为了生成这种用途的随机值，PHP 使用伪随机数生成器。可用的算法有:

*   [线性同余发生器](http://en.wikipedia.org/wiki/Linear_congruential_generator "Linear congruential generator - Wikipedia, the free encyclopedia") (LCG)，调用`lcg_value()`函数时使用。
*   [Marsenne-Twister 算法](http://en.wikipedia.org/wiki/Mersenne_twister "Mersenne twister - Wikipedia, the free encyclopedia")，更常用，在调用`mt_rand()`函数时使用。
*   本地支持的 C 函数`rand()`函数。

这些算法并不产生实际的随机数，而是以近似于实际随机数的方式分布的数。该算法以随机值作为种子，用于产生伪随机序列。

## 给发电机播种

播种是使用称为种子的数字或向量来初始化随机数生成器。种子值的完整性对于伪随机发生器非常重要，因为当使用相同的种子运行多次时，将生成相同的一组伪随机值。如果攻击者得到种子，他可以预测未来的输出集。

在 PHP 中，可以通过两种方式获得用于生成随机数生成器的随机数据。一种方法是使用`mt_srand()`功能手动设置种子。这种方式主要用于遗留系统，或者看似随机的系列单元测试。获取种子的第二种方法是让 PHP 自动生成它。这是最受欢迎的方式，主要用于 PHP 的新版本(4.2 及更高版本)。一种算法重新初始化种子，使得相同的种子不会被重复使用。

PHP 使用其他方法获得高质量的种子来生成随机值，用于加密等重要任务。方法是通过 PHP 运行的操作系统平台提供的。因此，PHP 需要在提供初始种子的操作系统上运行。

在 Linux 平台上，使用`mcrypt_create_iv()`或`openssl_pseudo_random_bytes()`函数从/dev/urandom 访问种子。Windows 提供了一个加密安全的伪随机生成器，可以使用提供`openssl_pseudo_random_bytes()`和`mcrypt_create_iv()`功能的扩展来访问该生成器。

## 结论

因为随机值对于安全应用以及完成各种编程任务非常重要，所以使用高质量的种子作为生成器是程序员应该时刻牢记的一个因素。对于非普通任务(如密码哈希)使用任何种子都可能导致很高的安全风险。确保使用强大的随机生成器和高质量的种子。

<small>图片 via[Fotolia](http://us.fotolia.com/?utm_source=sitepoint&utm_medium=website_link&utm=campaign=sitepoint "Royalty Free Stock Photos at Fotolia.com")</small>

## 分享这篇文章