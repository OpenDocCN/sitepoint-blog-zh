# PHP 中的数组操作符:有趣但不常用

> 原文：<https://www.sitepoint.com/array-operators-in-php-interesting-but-less-spoken/>

PHP 中的操作符可以分为七类:算术、赋值、按位、比较、错误控制、执行、递增/递减、逻辑、字符串、数组和类型操作符。本文详细介绍了如何使用数组操作符，但也介绍了其他一些操作符在使用数组时是如何工作的。

## 数组运算符

官方文档只提供了对每个数组操作符的简要描述，这有时会使人们不清楚每个操作符的作用。让我们看看每个数组操作符，以便更清楚地理解它们的作用。所有这些操作符都是二进制的，也就是说，每个操作符只对两个数组进行操作。

### 数组并集

第一个是 union 操作符(`+`)，它基于数组的键给出两个数组的并集。它不进行松散的键匹配，如果第一个数组中已经存在第二个数组的所有键，则忽略它们。第二个数组的其余键(和相应的值)被追加到第一个数组中。

```
<?php
$array1 = array('a', 'b', 'c');
$array2 = array('d', 'e', 'f', 'g', 'h', 'i');
print_r($array1 + $array2);
print_r($array2 + $array1);
```

```
Array
(
    [0] => a
    [1] => b
    [2] => c
    [3] => g
    [4] => h
    [5] => i
)
Array
(
    [0] => d
    [1] => e
    [2] => f
    [3] => g
    [4] => h
    [5] => i
)
```

对于第一个`print_r()`，在`$array2`中的前三个元素有已经存在于`$array1`中的键，所以在结果数组中‘d’、‘e’和‘f’被忽略。在第二个`print_r()`中，$array1 的所有键都已经存在于数组`$array2`中，所以它的所有元素都被忽略。

松散匹配行为可能会给您带来完全意想不到的结果，但也为优化和松散编码带来了令人兴奋的机会。

```
<?php
$array1 = array('0' => 'a', '1' => 'b', '2' => 'c', '3' => 'd');
$array2 = array(false => 'e', 1 => 'f', 2 => 'g', 3 => 'h', 4 => 'i');
print_r($array1 + $array2);
```

```
Array
(
    [0] => a
    [1] => b
    [2] => c
    [3] => d
    [4] => i
)
```

人们常常误解为联合是基于数组值的，而实际上这个操作符实现了数组键的联合。对于基于值的联合，您可以使用`array_merge()`和`array_unique()`的组合:

```
<?php
$union = array_unique(array_merge($array1, $array2));
print_r($union);
```

```
Array
(
    [0] => a
    [1] => b
    [2] => c
    [3] => d
    [4] => e
    [5] => f
    [6] => g
    [7] => h
    [8] => i
)
```

### 数组相等

相等运算符(`==`)检查两个数组是否相似。如果第一个数组中的所有键值对在第二个数组中具有等效的键值对，则该运算符返回 true。它松散地匹配值和键，元素的顺序被忽略。

```
<?php
$array1 = array('1' => 1, '2' => 2, '3' => 3, '0' => 0);
$array2 = array(false => '0', 1 => '1', 2 => '2', 3 => '3');
var_dump($array1 == $array2);
```

```
bool(true)
```

两个数组中元素的顺序不同，但是相同的值被绑定到每个数组中相似的键上。但是，由于两个数组具有不同的键值对，因此以下内容并不等效:

```
<?php
$array1 = array(1, 2);
$array2 = array(2, 1);
var_dump($array1 == $array2);
```

```
bool(false)
```

不等式运算符(`!=`或`<>`)检查两个数组是否不相似，它是等式运算符的完美反义词。等式运算符返回 false 的任何内容，该运算符都返回 true，反之亦然。

```
<?php
$array1 = array('1' => 1, '2' => 2, '3' => 3, '0' => 0);
$array2 = array(false => '0', 1 => '1', 2 => '2', 3 => '3');
var_dump($array1 != $array2);
```

```
bool(false)
```

## 数组标识

同一性操作符(`===`)检查两个数组是否相同。如果两个阵列都满足以下条件，则它们是相同的:

*   具有相同数量的元素
*   具有相同的键值对
*   具有相同的元素序列
*   所有对应值的数据类型相同

但是，对于数组键，如果一个键是一个整数，并且该整数的一个类似的字符串符号作为一个键存在于另一个数组中，则 identity 运算符是松散匹配的。对于 float 和 string 键匹配，这个操作符非常严格。PHP 手册没有阐明这种区别。

```
<?php
// arrays are almost identical but keys have different types
$array1 = array('0' => '0', '1' => '1', '2' => '2', '3' => '3');
$array2 = array(0 => '0', 1 => '1', 2 => '2', 3 => '3');
var_dump($array1 === $array2);
```

```
bool(true)
```

```
<?php
// the sequence of elements in both arrays is not the same
$array1 = array('0' => '0', '1' => '1', '2' => '2', '3' => '3');
$array2 = array(1 => '1', 2 => '2', 3 => '3', 0 => '0');
var_dump($array1 === $array2);
```

```
bool(false)
```

```
<?php
// the key in the first array is a string and in the second is a float
$array1 = array('0.5' => '0');
$array2 = array(0.5 => '0');
var_dump($array1 === $array2);
```

```
bool(false)
```

非同一性运算符(`!==`)检查两个数组是否不相同。同样，该运算符与 identity 运算符完全相反，这意味着如果数组相同，则该运算符在比较数组时返回 false。

```
<?php
$array1 = array('0' => '0', '1' => '1', '2' => '2', '3' => '3');
$array2 = array(0 => '0', 1 => '1', 2 => '2', 3 => '3');
var_dump($array1 !== $array2);
```

```
bool(false)
```

## 将数组与其他运算符一起使用

当除了上面提到的操作符之外的操作符应用到数组时，PHP 的行为会有所不同。下面是这些操作符的列表，以及它们应用于数组时的行为。

### 致命错误:意外的操作数类型

当以下运算符应用于数组时，PHP 会发出致命错误:

*   按位非运算符(`~`)
*   算术否定运算符(`-`)
*   算术减法运算符(`-`)
*   算术乘法运算符(`*`)
*   算术除法运算符(`/`)

### 被视为整数的数组

与下列运算符一起使用时，数组被视为整数。空数组(没有元素)被认为是`int(0)`，非空数组被认为是`int(1)`。

*   逻辑非(`!`)为空数组返回 true，当操作数数组有一个或多个元素时返回 false。
*   如果两个操作数都不为空，按位“与”(`&`)将返回 1，如果一个或两个操作数都为空，将返回 0。
*   如果两个操作数都为空，按位“或”(`|`)返回 0，否则返回 1。
*   如果两个数组都为空或已填充，则按位异或(`^`)返回 0。如果其中一个数组为空，则返回 1。
*   用左移位运算符(`<<`)将数组左移 n 步，如果数组非空，则返回与`1 << n`等价的整数。否则返回 0(T2 的结果)。
*   右移运算符(`>>`)的行为与左移类似，只是它向右移动。
*   如果两个数组都不为空，则 module(`%`)返回 true。如果第二个数组为空，它会发出“被零除”错误。如果第一个数组为空，则返回 0(`0 % 1`的结果)。
*   如果任何数组为空，逻辑与(`&&`和`AND`)返回 false。如果两个数组都不为空，则返回 true。
*   如果任何操作数数组非空，则逻辑 or ( `||`和`OR`)返回 true。如果两个数组都为空，则返回 false。
*   如果两个数组都为空或非空，则逻辑异或(`XOR`)返回 false。否则，如果其中一个数组为空，则返回 true。
*   如果数组为空，将数组转换为`bool`会得出 false，否则为 true。

### 被视为字符串的数组

当连接两个数组时，字符串连接运算符(`.`)将每个数组作为字符串“array”并连接这些字符串。

```
<?php
$array1 = array(0, 1, 2, 3);
$array1 = array(0, 1, 2, 3);
var_dump($array1 . $array2);
```

```
string(10) "ArrayArray"
```

### 没有影响

运算符(`++`和`--`)的递增/递减类别对数组没有影响。

```
<?php
$array1 = $array2;
var_dump((++$array1) === $array2);
```

```
bool(true)
```

## 结论

关于 PHP 的操作符在使用数组时如何表现的实际文档很少，但是要了解更多信息，您可以查看用户在数组操作符页面中提交的注释。这里也欢迎你的问题和评论，我很乐意进一步解释。

图片 via[Fotolia](http://us.fotolia.com/?utm_source=sitepoint&utm_medium=website_link&utm=campaign=sitepoint "Royalty Free Stock Photos at Fotolia.com")

## 分享这篇文章