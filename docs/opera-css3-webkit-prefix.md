# 审判日到来:Opera 实现了 CSS3 Webkit 前缀

> 原文：<https://www.sitepoint.com/opera-css3-webkit-prefix/>

2012 年 2 月，我们报道了 W3C 会议的记录，会上 [Mozilla、Opera 和微软讨论了在非 webkit 浏览器中实现-webkit 前缀](https://www.sitepoint.com/w3c-css-webkit-prefix-crisis/)。原因是:一些开发人员只使用 webkit 前缀——他们的网站在一些浏览器中看起来不错，但在其他浏览器中却很糟糕，即使他们提供了相同级别的 CSS3 支持。这个问题在移动浏览器上尤其普遍，许多开发者未能超越他们的高端苹果或安卓设备。

Opera 现在宣布在他们的移动模拟器中支持 14 个 CSS3 webkit 属性。这一实现最终将覆盖他们桌面和移动浏览器的所有版本。如果你在想*“Opera 的市场份额很小”*，再想一想:[它是世界上使用最多的手机浏览器](https://www.sitepoint.com/browser-trends-may-2012/)。

也许我过于戏剧化了，但我想起了查尔登·海斯顿的那句名言:“他们最终真的做到了。你们这些疯子。你炸了它！”

## Opera -webkit 别名

Opera 分析了来自 10，000 个流行网站的样式表，以确定哪些 CSS 值/属性将被接收-webkit 别名:

| -o 前缀 | -webkit-别名 |
| -o-线性梯度 | -WebKit-线性-渐变 |
| 箱形阴影 | -WebKit-框-阴影 |
| -o-转换 | -WebKit-转换 |
| -o-转换-原点 | -WebKit-转换-来源 |
| 边框半径 | -WebKit-边框-半径 |
| 边框-左上半径 | -WebKit-边框-左上-半径 |
| 边框-右上-半径 | -WebKit-边框-右上-半径 |
| 边框-底部-左侧-半径 | -WebKit-边框-底部-左侧-半径 |
| 边框-底部-右侧-半径 | -WebKit-边框-底部-右侧-半径 |
| -o-转换 | -WebKit-过渡 |
| -o-转换延迟 | -WebKit-过渡-延迟 |
| -o-转换-持续时间 | -WebKit-过渡-持续时间 |
| -o-转换-属性 | -WebKit-过渡-属性 |
| -o-转换-定时-功能 | -WebKit-过渡-计时-功能 |

如果浏览器遇到像`-webkit-border-radius`这样的属性，它会应用那个效果。如果您已经定义了`-webkit-border-radius`、`-o-border-radius`和`border-radius`，则应用普通的 CSS 层叠规则，并将应用最后定义的规则或最合适的选择器，例如

```
 #myelement
{
	-o-border-radius: 3px;
	border-radius: 6px;
	-webkit-border-radius: 9px;
} 
```

所有属性都被认为具有相同的优先级，因此 Opera 应用 9px 的边界半径。

关于行为上的差异，Opera 声明:

> 据我们所知，在 WebKit 和 Opera 中，我们别名化的属性的行为是相同的，或者至少足够接近，以至于在实践中差异不会有影响。如果结果是差异大到足以导致崩溃，我们将考虑我们的选择，其中之一是将我们的-webkit 前缀变体的行为与 webkit 实际所做的保持一致。

Opera 提出了合理的理由来证明他们的决定是正确的。虽然他们理解这些抱怨，但他们的主要目标是为用户创造一个工作良好的浏览器——用户的数量是开发者的几千倍。

## 反弹

大多数开发人员理解问题，但不同意解决方案。它很粗糙，有可能破坏网络。从逻辑的极端来看，所有的供应商都会支持每一个前缀，但是任何实现上的差异都会使 CSS 属性变得无用。

该解决方案奖励糟糕的开发实践。尽管 Opera 建议您使用所有供应商前缀，但它们会加剧问题:

*   不太尽责的开发人员会认为这是只针对 webkit 浏览器的正当理由。
*   如果您的站点使用不同的-webkit 和-o 值，它现在将受到 CSS 级联规则的影响。是分析和重新测试代码更容易，还是简单地删除 Opera 属性更容易？
*   意外省略-o 前缀将变得更容易，因为站点将按预期工作。

已经报道了几个问题。例如，Modernizr 依次评估前缀，直到找到浏览器支持的前缀。因此:

```
 Modernizr.prefixed("transition"); 
```

现在在 Opera 中返回`WebkitTransition`。过渡是 Opera 的新功能，浏览器并不支持所有的 webkit CSS 和 JavaScript 属性。如果你想在 Opera 中调整或禁用效果，你不能依赖类似 Modernizr 的检测代码。你甚至可能需要实现[讨厌的浏览器嗅探](https://www.sitepoint.com/why-browser-sniffing-stinks/)。

然而，我最大的问题是:*这些问题网站都在哪里？*用户体验是否因为缺少圆角、渐变、阴影、过渡和变换效果而受到影响？这些网站是真的坏掉了，还是 Opera 抓住了(营销)机会让他们的浏览器看起来更好？

由于 Opera 已经分析了 10，000 个网站，他们可以直接联系所有者。至少，他们可以出版一个“耻辱堂”,提供例子并强调技术问题。许多开发者很乐意代表 Opera 联系公司。有些人会准备免费修复网站，因为这可能会导致未来的合同。

供应商前缀危机没有简单的解决方案。我理解 Opera 的理由，但是，不管这是如何实现的，不可避免的是，有些东西最终会坏掉。

一些好消息:微软已经宣布他们将不支持 ie 浏览器中的 webkit 前缀(尽管没有什么可以阻止他们改变这个决定)。Mozilla 尚未透露他们的意图——他们将密切关注 Opera 的情况。

## 分享这篇文章