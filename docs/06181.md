# MySQL 调整以简化 Magento

> 原文:[https://www.sitepoint.com/mysql-tweaks-streamline-magento/](https://www.sitepoint.com/mysql-tweaks-streamline-magento/)

Magento 是一个重型电子商务解决方案，承诺的性能和可扩展性。这对于寻求快速增长的零售商或那些已经在互联网上占有重要地位的人来说是完美的。该软件提供了一个完整的网站解决方案，连同插件和扩展，可以增长任何规模的库存您的电子商务网站。

然而，作为一个免费的开源内容管理系统，像 WordPress 一样，它也有同样的脚本冲突和数据库过载的问题。对于开发者来说，意识到这一点很重要，因为客户不仅希望网站能够正常运行，还希望网站运行良好。

由于 Magento 的复杂性，一篇文章无法描述您需要了解的所有方面，以确保您的站点能够提供即时结果。然而，正确配置 MySQL 数据库服务器是可以显著提高 Magento 速度的一个方面。

## 数据库查询

数据库是 Magento 的核心，就像任何零售业务一样。数据库存储你的库存，包括尺寸、颜色和库存的详细信息。它们还存储您的价格、成本和收入信息、客户详细信息等等。

所有这一切意味着，无论客户是在使用 web storefront，还是您在管理区工作，Magento 都将进行大量的数据库访问和读取操作，并且在许多情况下，每次查看页面时，它们都是相同的查询，随着时间的推移，查询几乎没有变化。

Magento 在数据库中要做的工作是从解析查询开始，然后从存储介质中检索数据。太多的查询会降低对服务器的访问速度。解决这个问题的一种方法是 MySQL 的内置配置参数“query_cache_size”。它允许数据库将查询结果存储在内存中，而不是存储在存储介质上——最终，这是一种更快的访问途径。

Magento 可以在这个缓存中存储多少查询取决于 MySQL 数据库服务器上的可用内存量。在大多数常见的托管环境中，这将是大约 64 MB 存储为 RAM。就数据库查询结果而言，这是一个非常大的数量。

我为 Nu Profile 创建的一个早期电子商务网站包含 70，000 多种产品和变体。当我们启用查询缓存时，性能提高了 10 倍以上。总的来说，在大多数使用数据库查询缓存的站点上，性能会提高 100-1000%。

Nu Profile 网站还显示，在超过 70，000 的产品数据库中，非缓存查询在 11 秒内返回。一旦被查询并存储在缓存中，它只需一秒钟就返回。

## 专用服务器

即使您启用了查询缓存，根据您的托管环境，它也会在每次 MySQL 服务器重启时被清除。这意味着在每台服务器重新启动后，必须从头开始逐个查询地重建。

你可以通过为你的电子商务网站建立一个专用的托管环境来避免这种情况。这提供了一个更加稳定的 MySQL 数据库服务，不会在每次重启后清空你的查询缓存。共享主机环境虽然不太贵，但提供的数据库服务器可以每天甚至每小时运行一次。这意味着您的缓存可能会不断被清除。

## 如何配置查询缓存

要配置 MySQL 数据库查询缓存，您需要在托管环境的控制面板区域访问 MySQL 命令提示符。进入命令提示符后，键入以下命令:

```
mysql> SHOW VARIABLES LIKE 'have_query_cache';
```

这将返回以下内容:

```
+------------------+----------+
| Variable_name    | Value    |
+------------------+----------+
| have_query_cache | YES      |
+------------------+----------+
```

你会注意到‘have _ query _ cache’将被设置为 YES。这并不一定意味着启用了查询缓存，因为在标准的 MySQL 二进制文件中，这个值总是 YES。要验证查询缓存是否实际运行，请在命令提示符下键入以下内容:

```
mysql> SHOW VARIABLES LIKE 'query_cache_size';
```

结果显示查询缓存有相当大的 64 MB 可用空间。

```
+------------------+----------+
| Variable_name    | Value    |
+------------------+----------+
| query_cache_size | 67108864 | 
+------------------+----------+
1 row in set (0.00 sec)
```

如果缓存被禁用，查询将返回以下内容:

```
+------------------+----------+
| Variable_name    | Value    |
+------------------+----------+
| query_cache_size | 0        | 
+------------------+----------+
1 row in set (0.00 sec)
```

只要您拥有 root 访问权限，就可以相对简单地进行必要的更改来启用查询缓存。在文本编辑器中打开 my.conf 文件，找到`[mysqld]`部分，并为查询缓存大小键入一个值。

```
query_cache_size=32M
```

设置 MySQL 查询缓存并确保它位于专用服务器上，这是提高基于 Magento 的电子商务网站速度的两个最重要的性能提升调整。实现起来也相对简单。

但是，在配置 MySQL 服务器时，还有其他一些参数需要考虑。其中包括“查询缓存类型”、“查询缓存最小资源单位”和“查询缓存限制”。在实现查询缓存配置之前，熟悉所有这些配置参数非常重要。

当你第一次使用 Magento 开始一个电子商务项目时，像这样的调整似乎不会对你的客户体验产生太大的影响。然而，随着您的网站的增长，数据库查询开始堵塞您的系统，您将需要查看这些方面来修复性能问题。

## 分享这篇文章