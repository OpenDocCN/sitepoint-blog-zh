# 为 iOS 8 构建自适应用户界面

> 原文:[https://www . site point . com/building-adaptive-user-interfaces-IOs-8/](https://www.sitepoint.com/building-adaptive-user-interfaces-ios-8/)

在今年的 WWDC 上，苹果推出了[自适应 UI](https://developer.apple.com/design/adaptivity/) ，这是一种构建应用程序的新方法，这些应用程序可以适应运行它们的容器的大小和特性，而不是针对特定的设备。这是苹果自 iOS 6 引入自动布局以来一直在推动的举措。然后，你可以忽略自动布局，仍然建立一个应用程序，按预期工作。随着市场上新设备的引入以及 Xcode 和 iOS SDK 的变化，开发人员将不得不掌握构建自适应布局的组件，包括大小类别、特征集合、自适应视图控制器等。

在本文中，我们将介绍使用界面构建器创建自适应用户界面。我们将研究如何使用大小分类来设计用户界面组件，这些组件将根据大小分类进行不同的渲染。你不仅可以使用大小分类来创建适应性布局，我们还将看看如何根据大小分类让字体、图像和视图呈现不同的外观。

## 大小级别入门

自适应 UI 的一个核心概念是大小类的使用。大小类定义布局中使用的画布大小。当创建一个应用程序的用户界面时，你可以根据大小类别指定布局规则，这些规则将决定当你的视图控制器的可用大小改变时，你的用户界面的外观和变化。

尺寸等级可以是*紧凑型*或*常规型*，它确定了高度(垂直)和宽度(水平)的相对显示空间量。例如，iPad 在纵向和横向上都具有标准的宽度和高度，而纵向的 iPhone 具有紧凑的宽度和标准的高度。下表显示了 Apple 设备及其相应的尺寸等级。

|   | 垂直尺寸等级 | 水平尺寸等级 |
| iPad 肖像 | 规则的 | 规则的 |
| iPad 风景 | 规则的 | 规则的 |
| 苹果手机 | 规则的 | 小型的，紧凑的 |
| iPhone 景观 | 小型的，紧凑的 | 小型的，紧凑的 |
| iPhone 6 Plus 风景 | 小型的，紧凑的 | 规则的 |

您应该注意，大小类别不一定映射到一个方向上的一个设备。例如，当在设备上的较小空间中呈现时，iPad 可以具有 iPhone 风格布局(即，紧凑水平和常规垂直尺寸等级)的视图，而当空间较大时，可以具有 iPad 风格布局(即，常规水平和常规垂直尺寸等级)。

这使得在构建通用应用程序时有一个统一的故事板成为可能，以前，您必须为 iPad 和 iPhone 设计两个单独的故事板。

你可以在 [GitHub](https://github.com/sitepoint-examples/Adaptive-UI) 上找到我们将完成的最终项目。

首先创建一个简单的视图应用程序。将其命名为`AdaptiveLayout`并使其通用。选择你喜欢的语言。

当你打开`Main.storyboard`时，你会看到一个几乎是正方形的画布，它与任何设备都不对应。画布底部是大小分类控制，可让您更改大小分类。Interface Builder 从“任意宽度和任意高度”大小类开始，在这里您可以为不同的屏幕大小和方向布置通用的 UI 组件和约束。然后，您可以通过修改不同大小类别中的 UI 来更新随着可用屏幕大小的变化而变化的组件。

将一个`View`和一个`Image View`从对象库中拖到视图控制器画布上。将视图放置在主视图的顶部，并调整其大小，使其占据视图的大约一半。将图像视图放置在此视图下方，并让它占据剩余的一半。您不必在这里精确，我们将使用自动布局来布局视图。你可以在这里下载一些图片资源[用于这个项目。您可以使用您自己的图像，但是下载的图像已经针对 iPhone (1x、2x、3x)和 iPad (1x、2x)进行了调整。](https://uploads.sitepoint.com/wp-content/uploads/2014/11/1415192093images.zip)

我们会将图像添加到资产目录中。在项目导航器中，打开`Images.xcassets`，点击左侧面板底部的+号，并从弹出菜单中选择新建图像集。双击图像集的名称，并将其重命名为`motobecane`。创建另一个图像集，命名为`focus`。你会注意到一个新的显示比例，这在以前的 iOS 版本中是没有的——3 倍。这种新的显示比例适用于 Retina HD，可在 iPhone 6 Plus 上找到。3x 图像的像素是 1x 图像的 9 倍，即在每个方向上，3 个像素组成一个点。

从你下载的文件中找到 *motobecane_small.png* 并将其拖到`motobecane`图像集中的 1x 框中。将*motobecane_small@2x.png*拖至 2x 框，将*motobecane_small@3x.png*拖至 3x 框。对 *focus_small.png* 图像做同样的操作，将它们拖到各自的 1x、2x 和 3x 框中。

在`Main.storyboard`中选择图像视图，在属性检查器中，将其*图像*设置为`motobecane`，在视图窗格中，将模式设置为纵横比。

选择视图，然后在身份检查器中找到文档窗格，将标签设置为`DescriptionView`。这是为了让我们能够识别文档大纲中的视图。从现在开始，我将把它称为`DescriptionView`以区别于主视图。将此视图的背景颜色设置为“深灰色”。通过在属性检查器的“背景”下拉菜单中选取预置颜色来完成此操作。

将两个标签拖到`DescriptionView`上，将它们的颜色设置为白色，字体设置为 Helvetica 新瘦。将一个字体大小设置为 50，另一个字体大小设置为 25。将字体较大的标签放在`DescriptionView`的顶部，另一个放在下方。将顶部标签的文本设置为“2010 Motobecane Grand Sprint”，将另一个标签的文本设置为“Lorem ipsum dolor sit er elit lamet，consectetaur cillium adipsicing pecu，sed do eiusmod tempor incididunt ut labore et dolore magna aliqua。”。对于此标签，在属性检查器中将它的线条设定为 0。然后在画布上调整其大小，以便显示所有文本。

你应该有大致如下图。

![Initial preview](../Images/312f6ca176111bf8da1341f625059194.png)

您可以使用预览助手编辑器，而不是在不同的设备上以不同的方向运行应用程序来查看视图。点击菜单栏中的助手编辑器。

![Assistant Editor](../Images/e741aa57ca2c9e06811e4140f27a31d3.png)

屏幕将分成两个窗格。在有代码的面板上，点击*自动*，从下拉菜单中选择*预览*，选择 *Main.storyboard* 。

你会在一台 4 英寸的 iPhone 上看到故事板的预览。在窗格的左下方，单击+图标并选择“iPhone 4.7 英寸”将其添加到窗格中。还要加上 iPhone 5.5 寸和 iPad。对于 4.7 英寸的 iPhone，将鼠标悬停在其标签上，然后单击出现的图标。这将把设备旋转到横向。如您所见，这些设备显示了您的布局在每个设备上呈现时的预览。当您对情节提要进行更改时，这些更改会立即反映在预览助手编辑器中。当在 UI 上工作时，这可以节省大量时间。如果不设置约束，UI 几乎可以在所有设备上关闭。

![Overview](../Images/ad8d1f106c3666f444e7637a10f946d0.png)

设置好之后，我们将开始向视图添加约束。

选择`DescriptionView`并选择画布下方的大头针菜单。将“左”、“上”和“右”的间距设置为 0，并确保取消选中“限制到边距”(这可以防止在视图周围添加填充)。单击“添加 3 个约束”按钮。

![Adding constraint](../Images/cca0185488d05da8edc207b9ecc1ce52.png)

选择图像视图，并将左、下、右间距设置为 0。同样，确保取消选中“约束到页边距”(对于本教程的其余部分，确保取消选中它。这个我就假设了，不会再提了)。

![Adding constraint](../Images/924703ab5630698cc539f75c683d8feb.png)

在文档轮廓中，按住 Control 键从`DescriptionView`拖到主视图。

![Ctrl-drag objects](../Images/266a2e9afcddbeb21d2c151f82326206.png)

从出现的菜单中选择*等高*。从添加的约束列表中选择该约束。

![Select constraint](../Images/3fac88b6212ab80b20a05bfc23ad19cc.png)

在属性检查器中，将乘数设定为 0.4。这样，`DescriptionView`将占据主视图的 40%。确保*第一项*是*描述视图。身高*。如果不是，从下拉菜单中选择*反转第一项*和*第二项*。

![Edit constraint](../Images/e83dff463c6f0601a631271fe4295986.png)

在文档轮廓窗格中，按住 Control 键从图像视图拖动到`DescriptionView`，并选择垂直间距。选择此约束，并在属性检查器中将常数设定为 0。这使得图像视图从 DescriptionView 结束的地方开始，两者之间没有空格。

如果您无法识别刚刚添加的约束，请选择添加了约束的视图，在大小检查器中，您可以看到所有添加的约束。你可以在这里编辑一个约束，或者你可以双击该约束并进入我们用来编辑它们的同一个面板，如上所示。但是约束命名应该足以让您识别一个添加的约束。(对于顶部和底部间距，您可能会看到它与顶部/底部版式参考线相关，而不是与超级视图相关。如果希望约束与超级视图相关，则在添加约束时，请确保在“锁定”菜单的“顶部/底部约束”下拉菜单中选择了“视图”)。

![Edit constraints](../Images/9e491e90fb3cefc9caa8c84ca5070eac.png)

选择顶部标签(带有“2010 Motobecane…”文本)并添加一个约束，其前导空格为 20，顶部空格为 40，尾部空格为 20。

![Add Constraint](../Images/1820f547c53397424c2f22a34185e418.png)

选择底部标签，并将带有前导空格、尾随空格和顶部空格的约束添加到 20。

![Add Constraint](../Images/5516d565a74b59b7f0b27aacfc97d9eb.png)

为了使画布与设置的约束相对应，从文档轮廓中选择`View`，然后*编辑器- >解决自动布局问题*，在*所有视图*下，选择*更新框架*。

当 iPhone 处于纵向时，最好呈现两个视图窗格，因为`DescriptionView`的 40%屏幕尺寸太小。

从*编辑器*菜单中，将画布的*尺寸等级*更改为*任意宽度，压缩高度*。请注意底部的栏，大小类控件变为蓝色。这表明您现在正在处理一个特定的大小类别，并且您设置的任何约束都只会影响该大小类别。

选择图像视图。在尺寸检查器中选择*顶部空间来描述查看*约束并按 Delete 键。

这不会删除约束。而不是那种大小的班级。如果您想通过从文档大纲中选择一个约束来卸载它，那么使用 Command-Delete 卸载它。如果只按 Delete 键，将会删除约束，这将是对所有尺寸等级的更改。

通过选择并按 Delete 键卸载*尾随空格以监督*约束。通过选择“约束”面板顶部的“全部”控件，可以看到已卸载的约束。它们在大小检查器和文档轮廓中都显示为灰色。

![List of Constraints](../Images/d57cb139369e29d41ec0794908c7512e.png)

如果您双击一个未安装的约束以在属性检查器中查看其属性，您将在底部看到一条附加线，表明该约束是为基本布局安装的，而不是为*任意宽度、紧凑高度*布局安装的。

![Edit Constraint](../Images/3ab56589fe154e998892fda6bb25ad4e.png)

在图像视图仍处于选中状态的情况下，为 0 的超级视图添加顶部空间。通过从约束的下拉菜单中选择视图，确保它与超级视图相关，而不是顶部布局指南(或描述视图)。

![Add Constraint](../Images/1f52a78fe0be74ae8c02d434ea552447.png)

在文档轮廓中，按住 Control 键从`ImageView`拖到`DescriptionView`并选择水平间距。选择该约束，并给它一个常量 0。确保*第一项*是*描述视图。第一项是*，第二项是*摩托车。拖尾*。使用下拉菜单进行设置。然后，按住 Control 键从图像视图拖移到主视图，并选择“等宽”。选择约束，并赋予其乘数 0.5。确保*第一项*是*摩托车。宽度*和*第二项*为*超视图。宽度*。此时，你会在画布上看到几条红线。这表明您有冲突的约束。我们将很快修复这些问题。

选择`DescriptionView`。卸载其前导空格以监督约束。卸载其比例高度超视图约束。从锁定菜单中，将其底部空间设置为 0。如果 XCode 改为在底部布局参考线中添加底部空格，您可以从约束的下拉菜单中更改这一点，从选项中选择 View。

您应该为 Image 视图和 DescriptionView 视图安装以下约束。

![List of uninstalled constraints](../Images/0cc2056a60d0408ebfe8a611af245de0.png)

从文档轮廓中选择视图更新画布，然后*编辑器- >解决自动布局问题*，在*所有视图*下，选择*更新框架*。

现在 iPhone 横向视图看起来更好。

![Preview](../Images/879e27aff4fb4bc26901662f477c4268.png)

## 大小类相关字体

当前的字体大小在 iPad 视图中看起来不错，但对于小型字体来说太大了。我们将看看如何在你的大小类中覆盖字体大小。

![Overview of sizes](../Images/b74a3199e93621503bdf6f471aec8c76.png)

为了做到这一点，我们不会改变特定大小类的字体配置。如果更改大小级别的字体配置，更改将影响基本布局。相反，请执行以下操作。

将尺寸等级更改为基数*任意宽度，任意高度*。选择“2010 Motobecane Grand Sprint”标签并打开属性检查器。单击字体左侧的+。

将弹出一个菜单，让您选择大小分类组合来覆盖字体大小。选择*紧凑宽度>任意高度*。将创建第二个字体选择器，其旁边有一个大小分类标签(在我的例子中是 wC hAny)。将这个新选择框中的字体大小改为 30。

对“Lorem Ipsum”标签重复上述操作，在添加的选择框中将字号设置为 15。

查看预览，我们的布局看起来更好，但第一个标签被剪辑。

![Overview](../Images/fb608495c06fa2f8f8facbedc8273d3a.png)

我们可以不断调整字体大小，直到它适合所有设备，但这不是一个可扩展的选项。如果这是一个真正的应用程序，那么标签中的文本很可能是动态的，因此使字体大小适合特定的字符串文字对另一个字符串文字不起作用，特别是对于更长的字符串。

若要确定文本始终适合标签，请选择标签并打开属性检查器。将*自动收缩*更改为*最小字体比例*并确保设置为 0.5。

文本现在将缩放以适合标签。

![Overview](../Images/403da27beed8e76bef2d6b1ccbd7d78d.png)

## 大小类相关图像

您可能希望为不同大小的类别提供不同的图像。为此，打开`Images.xcassets`并选择 *motobecane* 设置。打开属性检查器，将*设备*更改为*设备专用*，并确保 iPhone 和 iPad 被选中。这会将 iPad 群组添加到设备特定文件列表中。

从你之前下载的文件夹中，将 *motobecane_big.png* 拖到 iPad 1x 盒子中，将*motobecane@2x.png*拖到 2x 盒子中。您应该有如下所示的内容。(提供的 iPad 图片比 iPhone 图片大，在本教程中，我添加了文字以区别于 iPhone 图片)。

![Add images to a set](../Images/ef1024bdf2bd7e7e8901eea3227d1576.png)

查看预览，您可以看到 iPad 上有一个不同的图像(图像上有一个“iPad”标签)。

![Current overview of sizes](../Images/09f72a66c24061bfbd03e3370dcfbde3.png)

## 大小类相关视图

当创建通用的应用程序时，用我们到目前为止看到的技术提供不同的布局可能足以使 UI 在所有设备上都看起来很好。有时，你可能会发现较大设备的用户界面看起来有点空白和欠缺。有时候，更大的视图需要更多的内容才能看起来更好。

可以在故事板文件中包含一个只为特定大小的类渲染的视图。您可以设置您的用户界面，以便在较大的设备上，用户可以获得更多的内容，而在较小的设备上，相同的应用程序将只显示基本的、最相关的数据。

首先，在`DescriptionView`中添加一个`ImageView`(您可以对任何视图对象执行此操作)。从大头针菜单，设置它的尾部和底部空间为 0，并给它的高度 132 和宽度 150。

![Add a constraint](../Images/e674a5823a70fb191e984fb212412910.png)

在属性检查器中，将图像设置为`focus`。将模式设置为*纵横比适合*。

该视图出现在所有设备和方向上，但我们只希望它出现在 iPads 上。

![Overview with extra images](../Images/75cd84f65009e65364160c6957ddf058.png)

我们需要卸载与 iPhone 设备对应的大小类别中的视图。选择*任意宽度，紧凑高度*尺寸等级。在文档轮廓中选择图像视图(如果您使用了下载的图像，它现在标记为`focus`)并点击 Command-Delete。这将从该尺寸等级中卸载视图(注意不要单独点击删除，您将从所有尺寸等级中删除视图)。

将尺寸等级更改为*紧凑宽度，常规高度*，并卸载该尺寸等级的视图。现在如果你看预览，你只会看到 iPad 上的图像。

![Overview of devices](../Images/eb385f2202e524189e5f3aed7ee29650.png)

## 结论

自适应布局是 iOS 8 的基础部分。应用程序设计的未来是自适应的，如果开发者打算开发在苹果设备上运行良好的应用程序，他们需要掌握这个概念。

我们已经了解了如何使用界面构建器来构建适应性布局。这是制作自适应应用的良好开端，但在这个话题上还有很多要说的。在未来，我们将会有一篇关于创建适应性应用的文章。我们将使用 trait collection 和`UISplitViewController`来查看自适应视图控制器层次结构，以前只有 iPad 支持这个层次结构，但现在也可以在 iPhones 上使用。

## 分享这篇文章