# MySQL 简介:初学者指南

> 原文:[https://www . site point . com/introducing-MySQL-a-初学者指南/](https://www.sitepoint.com/introducing-mysql-a-beginners-guide/)

**以下文章摘自 *[PHP & MySQL:新手到忍者，第 7 版](https://www.sitepoint.com/premium/books/php-mysql-novice-to-ninja-7th-edition)* ，这是一本学习构建专业 web 应用程序所需的所有工具、原则和技术的实用指南。在本系列的第三篇教程中，您将学习什么是数据库，以及如何使用结构化查询语言(SQL)处理您自己的数据库。**

* * *

*   [用 Docker 建立你的 PHP 开发环境](https://www.sitepoint.com/php-development-environment)
*   PHP 初学者指南
*   【MySQL 入门指南
*   [在 Web 上显示来自 MySQL 的数据:简介](https://www.sitepoint.com/mysql-data-web)

* * *

正如我在上一章中解释的，PHP 是一种服务器端脚本语言，它允许你在网页中插入指令，在将网页发送给请求它们的浏览器之前，你的 web 服务器软件将执行这些指令。我们已经看了一些基本的例子，包括生成随机数和使用表单捕捉用户输入。

现在，这一切都很好，但当一个数据库被添加到组合中时，它真的变得有趣了。在本章中，我们将学习什么是数据库，以及如何使用结构化查询语言(SQL)处理您自己的数据库。

## 数据库介绍

**数据库服务器**是一个程序，它可以以一种有组织的格式存储大量信息，这种格式可以通过 PHP 等编程语言轻松访问。例如，您可以告诉 PHP 在数据库中查找您希望出现在网站上的笑话列表。

在本例中，笑话将全部存储在数据库中。这种方法有两个优点。首先，不用为每个笑话编写一个 HTML 页面，您可以编写一个 PHP 脚本，从数据库中获取任何笑话，并通过动态生成一个 HTML 页面来显示它。第二，在你的网站上添加一个笑话只是简单的将笑话插入到数据库中。PHP 代码会处理剩下的事情，当它从数据库中获取列表时，会自动显示这个新笑话和其他笑话。

让我们运行这个例子，看看数据是如何存储在数据库中的。一个数据库由一个或多个**表**组成，每个表包含一个**项**或*事物*的列表。对于我们的笑话数据库，我们可能会从一个名为`joke`的表开始，该表包含笑话列表。数据库中的每个表都有一个或多个**列**，或**字段**。每一列都包含表中每一项的特定信息。在我们的例子中，我们的`joke`表可能有一列用于笑话的文本，另一列用于笑话被添加到数据库的日期。以这种方式存储的每个笑话可以说是表中的一个**行**或**条目**。这些行和列构成了一个表格，如下图所示。

![A typical database table containing a list of jokes](../Images/eca2cff76893d1d0e9740bd7ce972751.png)

如果您曾经创建过电子表格，这看起来会很熟悉。数据库表也是类似的，因为数据存储在行和列中。唯一的区别是，与 Excel 不同——在 Excel 中，列被命名为`A`、`B`、`C`等等——当您创建一个数据库表时，您可以为每一列选择一个名称。

注意，除了笑话文本(`joketext`)和笑话日期(`jokedate`)列之外，还有一个名为`id`的列。作为一个好的设计，数据库表应该总是提供一种方法来唯一地标识每一行。由于两个相同的笑话可能在同一天出现，我们不能依靠`joketext`和`jokedate`栏来区分所有的笑话。因此，`id`栏的功能是给每个笑话分配一个唯一的编号，这样我们就可以轻松地引用它们，并跟踪哪个笑话是哪个笑话。我们将在第 5 章中更仔细地研究类似这样的数据库设计问题。

*注意:也可以使用列的组合作为唯一标识符——比如同时使用制造商名称和产品名称。一个制造商可能有不止一种产品，两个制造商可能有相同名称的产品。通过组合这两个名称，可以唯一地识别每个产品。*

回顾一下，上图中的表格是一个有两行(或条目)的三列表格。表格中的每一行包含三个字段，表格中的每一列对应一个字段:笑话的 ID、笑话的文本和笑话的日期。掌握了这些基本术语后，您就可以开始自己创建数据库了。

## 关系型数据库

这本书的标题是 *PHP 和 MySQL:新手到忍者*——其中 *MySQL* 指的是我们正在使用的数据库。然而，如果您仔细阅读作为设置 Docker 环境的一部分而下载的`docker-compose.yml`文件，您会注意到它实际上安装了一个名为 *MariaDB* 的数据库。

2009 年，MySQL 被大型软件公司甲骨文收购。由于对 MySQL 的未来不确定，最初的 MySQL 数据库的创始人之一 Michael Widenius 决定脱离 MySQL，创建一个名为 MariaDB 的新数据库。( **Forking** 是指从现有项目创建一个新项目，使用原来项目的源代码作为基础。除了不受 Oracle 控制之外，MariaDB 比 MySQL 有一些性能优势，这使它成为一个很好的选择。

MariaDB 是 MySQL 的替代产品，任何教你如何使用 MySQL 的教程都可以使用 MariaDB。作为一名 PHP 开发人员，您不会注意到两者之间的任何区别，并且可以将一个替换为另一个。

*注意:随着时间的推移，MySQL 和 MariaDB 之间的差异略有增加，但是您将使用的基本命令、工具和技术将是相同的。当谈到这两个数据库支持的一些更高级的特性时，有一些细微的差别。*

尽管这发生在十多年前，但大多数开发人员和包管理系统都交替使用这两者。比如在 Arch Linux 上，如果你安装了`mysql`包，它实际上安装的是 MariaDB，而我在第一章讨论的 XAMPP 包安装的是 MariaDB 而不是 MySQL。

尽管如此，如果您开始使用 MariaDB 开发 PHP 代码，您将看到对 MySQL 的不断引用，而不是 MariaDB。这是因为客户端软件(任何连接到服务器与数据库交互的东西)不知道它是连接到 MySQL 还是 MariaDB。对于这个客户端软件来说，MySQL 就是一个*协议*。就像您可以通过电脑上的 USB 端口插入键盘或鼠标一样，您可以通过 MySQL 协议连接到 MySQL 服务器或 MariaDB 服务器。

因此，当您听到开发人员谈论“向 MySQL 数据库添加记录”时，他们通常指的是使用 *MySQL 协议*来管理数据库，而不管所使用的具体实现。

您会发现开发人员经常使用术语“MySQL ”,即使他们实际上使用的是 MariaDB。出于一致性的考虑，我将在本书中做同样的事情。在讨论从 PHP 连接时，我不会将服务器称为 MariaDB，也不会使用术语 MySQL，而是通篇使用 MySQL。

## 使用 MySQL Workbench 运行 SQL 查询

正如网络服务器被设计为响应来自**客户端**(网络浏览器)的请求一样，数据库服务器响应来自**客户端程序**的请求。在本书的后面，我们将以 PHP 脚本的形式编写我们自己的 MySQL 客户端程序，但是现在我们可以使用由编写 MySQL 的同一批人编写的客户端程序:MySQL Workbench。你可以从 mysql.com/products/workbench/的[免费下载 MySQL Workbench。](https://www.mysql.com/products/workbench/)

有许多不同的 MySQL 客户端可供使用，本书的早期版本使用 phpMyAdmin，这是一个基于 web 的 MySQL 客户端，具有许多相同的特性。然而，它不像 MySQL Workbench 那样容易使用，而且通常会非常慢。

一旦您下载并安装了 MySQL Workbench，打开它，您应该会看到如下所示的屏幕。

![If you can see this, you have MySQL Workbench running](../Images/0284cd1fd7fafbb20f254b1d00f51365.png)

在向数据库添加任何数据之前，您需要连接到数据库。MariaDB 服务器运行在您在第 1 章下载的 Docker 环境中，您可以使用 MySQL 客户端(如 MySQL Workbench)连接到它。

连接到数据库需要三条信息:

*   服务器地址
*   用户名
*   一个密码

对于我们使用的 Docker 环境，信息是:

*   **服务器** : `v.je`
*   **用户名** : `v.je`
*   **密码** : `v.je`

您会注意到服务器名称与您在 web 浏览器中查看 PHP 脚本时连接到的 URL 相同。Docker 环境同时运行 web 服务器和数据库服务器，因此您只需要记住一个地址。

要连接到 MySQL Workbench 中的数据库，请按窗口中间“MySQL 连接”标签旁边的 **+** 按钮。(诚然，它的标签不是很清楚，它的目的也不是很明确，但没关系！)

![Add a connection](../Images/b09bdefeaf512bddd1feb2813438b6b2.png)

当您按下 **+** 按钮时，您会看到一个新窗口。

![Add a connection](../Images/d9b534a22ff5e339275c911d2b37f55b.png)

输入服务器地址和用户名。您还需要为您的连接命名。我把它叫做`v.je`，但是你可以随便叫它什么。这只是一个名字，它被列在 MySQL Workbench 中以供将来参考。

一旦您输入了用户名和服务器，您可以通过按窗口底部的**测试连接**按钮来尝试连接到数据库。

您应该会看到一个密码提示框。

![Password prompt](../Images/82a92f386014bcf256a9e59c32bbcd59.png)

如果没有，请遵循以下步骤:

1.  仔细检查您的环境是否正在运行。(如果你在设置后重启了你的电脑，你可能需要在项目的文件夹中再次运行`docker-compose up`来让它运行！)
2.  确保用户名、密码和服务器地址正确无误。

*提示:您可以在这里使用命令`docker-compose start`。`start`将启动任何现有的容器，而`up`将创建它们，如果它们不存在，然后启动它们。根据您在本书各章之间在计算机上所做的工作，Docker 创建的容器(和其他类似网络连接的东西)将在需要时被重新创建。如果您在计算机之间移动，执行系统恢复或某些软件更新，可能需要重新创建容器。*

*因此，`up`将会工作，而`start`可能工作，也可能不工作，这取决于自上次运行以来发生了什么。*

*注意:用户名和密码是区分大小写的，所以一定要用小写字母输入！*

在框中输入密码`v.je`，并勾选“保存密码”框。通过选中该框，您不必在每次连接时都输入密码。然后按下**确定**。

如果密码输入正确，您将看到一条消息，告诉您连接成功。在“建立新连接”窗口中按下 **OK** ，你会看到 MySQL 主窗口中出现一个框，里面有你输入的一些信息。

![The main MySQL window showing information that was entered](../Images/97808515eef87850cd7193834dd240c0.png)

既然连接已经建立，那么每次打开 MySQL workbench 时，它都会存在。您不需要每次都添加连接。

您终于准备好真正连接到数据库了。为此，只需双击新创建的代表您的连接的框，您将看到一个不同的屏幕。

![Initial screen](../Images/fbd5b285054168dcd8655b5364d5fd8f.png)

这看起来有点令人生畏，因为有许多不同的按钮和面板都代表不同的东西。左手边是一个菜单，有很多不同的选项。您唯一需要担心的是标题为“模式”的底部部分。

**Schema** 只是“数据库”的一个花哨词。MySQL 是一个 T2 数据库服务器 T3。实际上，这意味着它可以托管许多不同的数据库，类似于 web 服务器可以托管许多不同的网站。

## 创建数据库

在向数据库添加任何信息之前，您需要创建一个数据库。要创建一个数据库，右键单击 SCHEMAS 面板并选择 **Create schema** 。这为您提供了一个包含几个选项的窗口，但是您只需要输入一个选项:模式名。

![Creating a schema](../Images/38adc49c125a34851dfd63e9c546b380.png)

我选择将数据库命名为`ijdb`，互联网笑话数据库(向[互联网电影数据库](http://www.imdb.com)致敬)，因为这符合我在本章开始给出的例子:一个显示笑话数据库的网站。不过，您可以随意给数据库取任何您喜欢的名称。(在你阅读这本书的过程中，你需要经常打字，所以不要选择太复杂的东西！)

一旦你输入了一个名字，你可以安全地保留其他选项的默认值，并按下**应用**。当您这样做时，MySQL Workbench 将要求您确认您的操作。(习惯这些对话。MySQL Workbench 坚持对您所做的几乎所有事情进行确认！)在如下所示的屏幕上再次按下**应用**。

![Confirming the schema creation](../Images/9880add00fa945057a40686f5dd595bb.png)

一旦你按下**应用**，你需要在下一个屏幕上按下**完成**。这是 MySQL Workbench 令人烦恼的事情之一:它强迫你确认然后**完成**每一个动作。然而，正如我们很快会看到的那样，它比另一种选择要好！

在上面的截图中，你会看到一个白色的面板，上面写着`CREATE SCHEMA `ijdb``。这是一个 SQL 查询，在本书中你会看到更多这样的例子。您可以自己输入这个命令并运行它，避免使用 GUI，省去了 MySQL Workbench 的确认对话框。对于像`CREATE SCHEMA `ijdb``这样简单的命令来说，GUI 可能是多余的。然而，您很快就会看到，并不是所有的命令都这么简单，使用 MySQL Workbench 的 GUI 进行一些更复杂的查询要容易得多。

如果您希望能够删除数据库(考虑到我在本书中鼓励您做的大量实验，这可能是一个很好的能力)，MySQL Workbench 使这变得很容易。在主窗口的模式面板中，右键单击要删除的模式并选择**删除模式**。MySQL 使用单词`DROP`来删除东西。(有些不一致的是，**删除**也是用于某些东西！)

## 结构化查询语言

就像我们刚刚看到的`CREATE SCHEMA`命令一样，我们将在本书的其余部分用来指导 MySQL 的命令是一个标准的一部分，该标准被称为**结构化查询语言**，或 **SQL** (发音为“sequel”或“ess-cue-ell”，所以你可以选择)。SQL 中的命令也被称为**查询**，我将互换使用这两个术语。

SQL 是与大多数数据库交互的标准语言，因此，即使将来您从 MySQL 迁移到像 Microsoft SQL Server 这样的数据库，您也会发现大多数命令都是相同的。理解 SQL 和 MySQL 之间的区别很重要。MySQL 是您正在使用的数据库服务器软件，而您正在使用的 MariaDB 也遵循相同的标准。SQL 是您用来与数据库交互的语言。

这些命令中的大部分可以由 MySQL Workbench 生成，这就是我们将用来创建数据库结构的内容。但是，您需要学习一些命令，因为您将从 PHP 脚本而不是 MySQL Workbench 执行它们！

提示:在这本书里，我将教你每个 PHP 开发人员都需要知道的 SQL 的基本知识。如果您决定以构建数据库驱动的网站为职业，了解 SQL 的一些更高级的细节是有好处的，尤其是在让您的网站尽可能快速流畅地运行时。为了更深入地研究 SQL，我强烈推荐鲁迪·利姆贝克的《SQL 或蒂莫西·博伦奇克的《跳转起点 MySQL 》这本书。

*注意:大多数 MySQL 命令是不区分大小写的，这意味着你可以键入`CREATE DATABASE`、`create database`，甚至`CrEaTe DaTaBaSe`，它会知道你的意思。然而，当 MySQL 服务器运行在具有区分大小写的文件系统的操作系统上时(例如 Linux、macOS 或在 Docker 中运行时)，数据库名和表名是区分大小写的。*

此外，当表、列和其他名称在同一个查询中被多次使用时，它们的拼写必须完全相同。

为了保持一致，本书将遵循数据库命令全部大写，数据库实体(数据库、表格、列等)全部小写的公认惯例。

*这也让人们(比如你！)来阅读查询。MySQL 不在乎，但是你将能够快速而容易地识别命令，因为它是大写的，并且识别对表、列或数据库的引用，因为它是小写的。*

创建数据库后，它将出现在左侧的模式列表中。

![The Internet Joke Database schema](../Images/93bddacc1eb693b9e9504d5250e5ab3d.png)

现在您有了一个数据库，您需要告诉 MySQL Workbench 您想要使用它。为此，只需双击新创建的模式，它的名称就会变成粗体。您一次只能选择一个模式，并且您需要告诉 MySQL Workbench 您想要使用哪个模式。

![The ijdb schema selected](../Images/793d5fd57eacdf7346c255b572e2eba7.png)

您现在可以使用数据库了。因为数据库在添加表之前是空的，所以我们的首要任务是创建一个表来保存您的笑话。(现在可能是想一些的好时机！)

## 创建表格

如果您通过按名称旁边的箭头来展开新创建的`ijdb`模式，您将看到几个条目。

![The ijdb schema expanded](../Images/31b289aee787014447b7e42ee2f272cd.png)

就本书而言，我们唯一关心的是表格条目。因为您的模式是刚刚创建的，所以它没有任何表。

表格描述了数据的格式。你需要知道你想要存储的数据的结构。在创建一个表之前，您需要考虑您到底想要存储什么。对于笑话示例，我们希望存储这些信息:

*   笑话的正文
*   添加它的日期

除了文本和日期，我们还需要一些方法来识别每个笑话。为此，我们将给每个笑话一个唯一的 ID。

每条信息都放在表中的一个字段中，每个字段都有一个“类型”。**类型**可用于存储不同格式的数据，如数字、文本和日期。

你会遇到三种主要的类型:

*   数字，用于存储数值
*   文本，用于存储字符串
*   日期/时间，用于存储时间戳

MySQL 中有许多列类型，但是对于大多数用途来说，您只需要理解其中的三种就可以了！

要使用 MySQL Workbench 创建一个表，请在 SCHEMAS 列表中展开数据库，然后右键单击 Tables 条目并选择 **Create Table** 。

窗口的中间面板会发生变化，显示如下图所示的内容。

![MySQL Workbench New Table window](../Images/7ebf5d930c2dd4d6cd33120b1ea478a3.png)

每个表都有一个名称来标识它和一系列列。首先，输入表名“joke ”,并在列列表中添加以下各列:

*   这将作为每个笑话的唯一标识符，以便我们稍后可以检索它
*   `joketext`，它将存储笑话的文本
*   `jokedate`，它将存储添加笑话的日期

![Creating the joke table](../Images/27edd8373edc5bf99b202830d1df4c69.png)

您会注意到还有第二个名为 Datatype 的列。必须为数据库表中的每一列指定一种类型。我们需要的三种类型是:

*   `INT`，对数值`jokeid`表示“整数”
*   `TEXT`，为笑话存储一些文本
*   `DATE`，存储笑话发表的日期

这有助于组织您的数据，并允许您以强大的方式比较一列中的值，我们将在后面看到这一点。

如果我们在这一点上停止设置表，您可以开始向表中添加记录(我将很快向您展示如何做到这一点！).然而，您必须提供所有三条信息:笑话 ID、笑话文本和笑话日期。这意味着，要添加下一个笑话，您需要记录有多少个笑话，以便分配下一个 ID。

这听起来像是额外的工作，但幸运的是 MySQL Workbench 提供了一种方便的方法来避免它。除了列名和它存储的数据类型，您会注意到表中的每个字段都有一系列复选框。

在我们的 ID 字段中，我们感兴趣的有三个:

*   `PK`。这意味着“主键”。选中此框指定该列作为表中条目的唯一标识符，因此该列中的所有值都必须是唯一的，以确保没有两个笑话会共享同一个 ID。
*   `NN`。这代表“非空”，意味着当添加记录时，必须在字段中放置一个值。对于我们的 ID 栏，勾选这个框告诉 MySQL 不要接受没有 ID 的笑话。
*   `AI`。这是节省我们工作的巧妙之处。不，“人工智能”不是“人工智能”，是某种为我们工作的计算机大脑。在这种情况下，它代表“自动递增”，通过选中此框(并且只允许在`INT`字段上使用！)，每当一个记录(在我们的例子中，一个笑话)被添加到表中时，它将被自动分配下一个可用的 ID。这是一个真正的节省时间和值得记住的功能。

您的表现在应该看起来如下图所示。

![The joke table complete](../Images/331a346779fbcc9ef2f66669c0ef8fe8.png)

按下**应用**按钮，笑话表将被创建。您将在窗口中看到以下查询:

```
CREATE TABLE `ijdb`.`joke` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `joketext` TEXT NULL,
  `jokedate` DATE NULL,
  PRIMARY KEY (`id`)); 
```

您会注意到，我们在 GUI 中输入的很多信息都是重复的。GUI 只是为我们生成这些代码，这是一种比记住自己编写查询所需的所有语法和词汇更快、更容易的创建表格的方式。

作为开发人员，您不需要经常创建表。但是您*将*需要与它们交互——添加和删除记录并从数据库中检索它们——所以花时间学习如何编写查询来完成这项工作是值得的。然而，对于创建表，使用 MySQL Workbench GUI 通常要快得多，也容易得多，因为一旦创建了表，就不需要再编写另一个 create table 语句。

我们只需要再看一个任务:删除一个表。这项任务非常简单，所以要小心！如果删除了一个表，就无法恢复。

在模式列表中，右键单击要删除的表，并选择 **Drop Table** 。*不要用你的笑话表运行这个命令，除非你真的想摆脱它。如果你真的想试试，准备好从头开始重新创建你的笑话桌。当您删除一个表时，该表连同存储在其中的所有数据都将被永久删除。*桌子被丢弃后数据无法恢复*，所以使用该命令时要非常小心！*

## 添加数据

现在表已经创建好了，是时候向其中添加一些数据了。虽然这可以使用 MySQL Workbench 的 GUI 来完成，但这次我们将自己编写查询。最终，我们将需要能够直接从 PHP 编写我们自己的数据库查询，所以进行一些编写它们的练习是很好的。

要运行查询，您需要打开一个查询窗口。最简单的方法是在模式列表中展开数据库。展开 Tables 条目，您将看到刚刚创建的`joke`表。右键单击表格，然后单击最上面的选项“选择行-限制 1000”。

这将给你一个稍微不同的屏幕，它被水平分成两个面板。

![A new query panel](../Images/923bbac2913a41aa8066a83e146259a8.png)

上半部分是一个文本框，您可以在其中键入命令，向数据库服务器提问或让它执行任务。下半部分是查询的结果。您会看到顶部面板中已经有一个查询:

```
SELECT * FROM `ijdb`.`joke`; 
```

我们很快会回到这意味着什么。除了顶部面板中的这个查询，底部面板中还有一个行列表——或者更确切地说，如果表中有任何内容的话，就会有一个行列表！因为表是刚刚创建的，所以它目前是空的。在查看表的内容之前，您需要添加一些记录。

剩下的就是把一些笑话放入数据库。将数据插入数据库的命令被恰当地称为`INSERT`。该命令有两种基本形式:

```
INSERT INTO tableName SET
  column1Name = column1Value,
  column2Name = column2Value,
  … 
```

```
INSERT INTO tableName
  (column1Name, column2Name, …)
  VALUES (column1Value, column2Value, …) 
```

因此，要向我们的表中添加一个笑话，我们可以使用以下命令之一:

```
INSERT INTO joke SET
joketext = "A programmer was found dead in the shower. The instructions read: lather, rinse, repeat.",
jokedate = "2021-10-29" 
```

```
INSERT INTO joke
(joketext, jokedate) VALUES (
"A programmer was found dead in the shower. The instructions read: lather, rinse, repeat.",
"2021-10-29") 
```

注意，列/值对的顺序并不重要，但是按照位置将正确的值与正确的列配对才重要。如果第一组括号中提到的第一列是`joketext`，那么`VALUES`列表中的第一个条目必须是要放在`joketext`列中的文本。第一个括号中的第二个列名从`VALUES`列表中的相同位置获取值。否则，列的顺序并不重要。继续交换列和值对的顺序，并尝试查询。

当您键入查询时，您会注意到我们使用双引号(`"`)来标记笑话文本的开始和结束位置。以这种方式用引号括起来的一段文本被称为**文本字符串**，这就是在 SQL 中表示大多数数据值的方式。例如，日期也以文本字符串的形式输入，格式为`"YYYY-MM-DD"`。

如果您愿意，可以键入用单引号(`'`)括起来的文本字符串，而不是双引号:

```
INSERT INTO joke SET
joketext = '',
jokedate = '2021-10-29' 
```

你可能想知道当笑话文本中有引用时会发生什么。好吧，如果文本包含单引号，用双引号把它括起来。相反，如果文本包含双引号，请用单引号将其括起来。

如果您希望包含在查询中的文本同时包含单引号*和双引号*，那么您必须对文本字符串中的冲突字符进行转义。在 SQL 中，通过在字符前添加一个反斜杠(`\`)来对字符进行转义(方便起见，这与 PHP 中的相同)。这告诉 MySQL 忽略这个字符可能具有的任何“特殊含义”。在单引号或双引号的情况下，它告诉 MySQL 不要将字符解释为文本字符串的结尾。

为了尽可能清楚地说明这一点，下面是一个包含单引号的笑话的`INSERT`命令示例，尽管单引号已被用来标记字符串:

```
INSERT INTO joke
(joketext, jokedate) VALUES (
'!false - it\'s funny because it\'s true',
"2021-10-29") 
```

如您所见，我使用单引号标记了笑话文本的文本字符串的开始和结束。因此，我不得不在字符串中的两个单引号(撇号)前面加上反斜杠来进行转义。MySQL 会看到这些反斜杠，并知道将单引号视为字符串中的字符，而不是字符串结束标记。

如果您特别聪明，您现在可能想知道如何在 SQL 文本字符串中包含实际的反斜杠。答案是键入一个双反斜杠(`\\`)，MySQL 会将其视为文本字符串中的一个单反斜杠。

在 MySQL Workbench 的顶部文本框中编写插入查询，然后点击它上面的黄色闪电图标来执行查询。

![Executing an INSERT query using MySQL Workbench](../Images/eaa8dc02059599ddd9137444b04f6694.png)

当查询执行时，屏幕底部会出现一个面板，告诉您查询是否成功执行。

![Checking a query has executed successfully](../Images/e48a1ae92e1df85fbeb5957d184757ee.png)

如果出现错误，并且查询不成功，请查看错误消息。它应该给你一个提示去哪里找。仔细检查你的语法，并检查你的引号和括号是否在正确的位置。

提示:如果你的屏幕分辨率低于预期，MySQL Workbench 会隐藏底部面板。要显示它，将鼠标悬停在窗口底部滚动条的正下方，您会看到一个调整大小的光标。然后，您可以将面板拖到视图中。

添加两个笑话(以及你能想到的任何其他笑话！)到数据库中。现在您已经知道了如何向表中添加条目，让我们看看如何查看这些条目。

## 一句警告

您会注意到 MySQL Workbench 生成的查询有一点特殊。我们没有得到类似这样的查询:

```
SELECT * FROM joke 
```

相反，这是生成的查询:

```
SELECT * FROM `joke` 
```

``joke``周围有奇怪的引号。这些实际上不是引号，甚至不是我们用来表示字符串的撇号。他们是**反斜杠**。

这是一项安全预防措施。SQL 中有许多对语言有意义的词。你已经看过几部了:`SELECT`、`FROM`和`INSERT`。但是还有数百种其他的，被称为**的保留字**。想象一下，如果您将您的表称为`SELECT`。您需要运行的查询如下所示:

```
SELECT * FROM SELECT 
```

不幸的是，这会导致 MySQL 有点混乱。它可能将`SELECT`视为一个命令，而不是一个表名。更糟糕的是，`date`是这些单词中的一个，您可能会想到在您的一个表中创建一个名为`date`的列。当以下查询运行时，您预计会发生什么情况？

```
INSERT INTO joke
(joketext, date) VALUES (
'!false - it\'s funny because it\'s true',
"2021-04-01") 
```

因为单词`date`在 SQL 中已经有了含义，所以它可能不会被视为列名，而是查询的一部分，就像`VALUES`或`INTO`。

MySQL*通常*擅长猜测你指的是表/列名还是它需要遵循的命令，但有时它无法做出区分。为了避免这种混淆，最好用反斜杠将所有表名和列名括起来。反勾号告诉 MySQL 将字符串视为一个*名*，而不是一个*指令*。从一开始就养成这样做的习惯是很好的，因为它避免了后来经常不明显的问题。

从现在开始，我将把所有的表、模式和列名用反斜线括起来。这也将帮助您——作为一名程序员——区分命令和列名。例如，上面的`INSERT`查询可以写成这样:

```
INSERT INTO `joke`
(`joketext`, `date`) VALUES (
'!false - it\'s funny because it\'s true',
"2021-04-01") 
```

*提示:在许多英语键盘布局中，反勾键是紧挨着数字键`1`左边和`Esc`下面的一个键。在非英语键盘和/或笔记本电脑和平板电脑等各种设备上，其位置可能会有所不同。*

## 查看存储的数据

我们用来查看数据库表中存储的数据的命令是`SELECT`。您已经看到了 MySQL Workbench 为您生成的示例`SELECT`查询。`SELECT`查询是 SQL 中最复杂的命令。这种复杂性的原因是数据库的主要优势在于它在数据检索方面的灵活性。在我们使用数据库的早期阶段，我们只需要关注相当简单的结果列表，所以让我们在这里考虑一下更简单形式的`SELECT`命令。

该命令将列出存储在`joke`表中的所有内容:

```
SELECT * FROM `joke` 
```

该命令表示“选择笑话中的所有内容”，其中的`*`表示“所有列”。默认情况下，`SELECT`查询将返回表中的每条记录。如果您尝试此命令，您的结果将类似于下图。

![MySQL Workbench results](../Images/6b0d984f946f15d2fa356d052802adc1.png)

注意，`id`列中有一些值，即使您没有在之前运行的`INSERT`查询中指定它们。MySQL 已经自动为这个笑话分配了一个 ID。这是因为您在创建表格时选中了“AI”(自动递增)复选框。如果您没有选中这个框，您将需要为您插入的每个笑话指定 ID。

如果您正在这样一个数据库上进行严肃的工作，您可能会忍不住停下来阅读数据库中所有令人捧腹的笑话。为了避免分心，您可能想告诉 MySQL 省略`joketext`列。执行此操作的命令如下:

```
SELECT `id`, `jokedate` FROM joke 
```

这一次，我们没有告诉它“选择所有内容”，而是精确地告诉它我们想要看到哪些列。结果应该如下图所示。

![You can select only what you need](../Images/ea8d2392349da6be1c55f7902e61a404.png)

如果我们想看笑话文本的*部分*呢？除了能够命名我们希望`SELECT`命令显示的特定列之外，我们还可以使用函数来修改每一列的显示。一个名为`LEFT`的函数使我们能够告诉 MySQL 显示一列的内容，最多显示指定数量的字符。例如，假设我们只想看到`joketext`列的前 20 个字符。下面是我们将使用的命令:

```
SELECT `id`, LEFT(`joketext`, 20), `jokedate` FROM `joke` 
```

![The LEFT function trims the text to a specified length](../Images/461dee85f352c5680fa7b3ae1bf56476.png)

明白这是怎么回事了吗？另一个有用的函数是`COUNT`，它让我们统计返回结果的数量。例如，如果您想知道表中存储了多少个笑话，可以使用以下命令:

```
SELECT COUNT(`id`) FROM `joke` 
```

如下图所示，你的桌子上只有两个笑话。

![The COUNT function counts the rows](../Images/e0267fc15802e714e6b03054e96db44c.png)

*注意:您可以使用`COUNT(*)`获得相同的结果，但是这样会慢一些，因为所有的列都将从表中选择。通过使用主键，只需要检索一列。*

到目前为止，我们看到的例子已经获取了表中的所有条目。但是，您可以将结果限制为只包含那些具有所需特定属性的数据库条目。您可以通过在`SELECT`命令中添加一个所谓的`WHERE`子句来设置这些限制。考虑这个例子:

```
SELECT COUNT(*) FROM `joke` WHERE `jokedate` >= "2021-01-01" 
```

该查询将计算日期大于或等于 2021 年 1 月 1 日的笑话的数量。在日期的情况下，“大于或等于”表示“当天或之后”。这个主题的另一个变体允许您搜索包含某段文本的条目。查看以下查询:

```
SELECT `joketext` FROM `joke` WHERE `joketext` LIKE "%programmer%" 
```

该查询显示所有在`joketext`列中包含文本“programmer”的笑话的完整文本。`LIKE`关键字告诉 MySQL 指定的列必须匹配给定的模式。在这种情况下，我们使用的模式是`"%programer%"`。`%`符号(称为**通配符**)表示文本“programmer”之前和/或之后可以是任何文本字符串。(有趣的是，`LIKE`是不区分大小写的，所以这个模式也将匹配一个包含“程序员”，甚至“FuNkYProGRammeR”的笑话。)

还可以在`WHERE`子句中组合条件，以进一步限制结果。例如，要仅显示 2021 年 4 月的敲门笑话，可以使用以下查询:

```
SELECT `joketext` FROM `joke` WHERE
`joketext` LIKE "%knock%" AND
`jokedate` >= "2021-04-01" AND
`jokedate` < "2021-05-01" 
```

在桌子上再加几个笑话。(比如“程序员为什么要辞职？他没有得到数组。”)然后尝试使用`SELECT`查询。

您可以使用`SELECT`命令做很多事情，所以我鼓励您熟悉它。稍后，当我们需要时，我们将会看到它的一些更高级的特性。

## 修改存储的数据

将数据输入数据库表后，您可能会发现想要更改它。无论您是在纠正拼写错误，还是在更改笑话的日期，都可以使用`UPDATE`命令进行更改。该命令包含了`SELECT`和`INSERT`命令的元素，因为该命令既挑选出要修改的条目，又设置列值。`UPDATE`命令的一般形式如下:

```
UPDATE `tableName` SET
  `colName` = newValue, …
WHERE conditions 
```

因此，举例来说，如果我们想要更改我们之前输入的笑话的日期，我们可以使用以下命令:

```
UPDATE `joke` SET `jokedate` = "2021-04-01" WHERE id = "1" 
```

这就是那个`id`专栏派上用场的地方，它让你可以轻松地挑出一个笑话进行修改。这里使用的`WHERE`子句就像在`SELECT`命令中一样工作。例如，下一个命令更改包含单词“programmer”的所有条目的日期:

```
UPDATE `joke` SET `jokedate` = "2021-04-01"
WHERE `joketext` LIKE "%programmer%" 
```

*注意:信不信由你，`UPDATE`命令中的`WHERE`子句是可选的。因此，您在键入这个命令时应该非常小心！如果不考虑`WHERE`子句，那么`UPDATE`命令将应用于**表**中的所有条目。*

下面的命令将为表中的所有记录设置日期！

```
UPDATE `joke` SET `jokedate` = "2021-04-01"
```

## 删除存储的数据

在 SQL 中删除条目非常容易，你可能已经注意到这是一个重复出现的主题。以下是命令语法:

```
DELETE FROM `tableName` WHERE conditions 
```

要从表中删除所有程序员的笑话，可以使用以下查询:

```
DELETE FROM `joke` WHERE `joketext` LIKE "%programmer%" 
```

*注意:和`UPDATE`一样，`DELETE`命令中的`WHERE`子句是可选的。因此，你应该非常小心地使用它。如果不考虑`WHERE`子句，那么`DELETE`命令将应用于表中的所有条目**。***

*下面的命令将一举清空笑话表:<，em >*

```
DELETE FROM `joke`
```

很可怕，是吧？

## 让 PHP 来打字

MySQL 数据库服务器软件和 SQL 的内容远不止我在这里介绍的几个基本命令，但是这些命令是迄今为止最常用和最有用的！

在这个阶段，您可能会认为数据库似乎有点麻烦。SQL 可能很难输入，因为与其他计算机语言相比，它的命令往往又长又冗长。你可能害怕以`INSERT`命令的形式输入一个完整的笑话库。

别担心！随着我们继续阅读这本书，您会惊讶地发现实际上您手动输入的 SQL 查询是如此之少。通常，您将编写 PHP 脚本来为您输入 SQL。例如，如果您希望能够将一堆笑话插入到数据库中，您通常会创建一个 PHP 脚本来添加笑话，该脚本包括必要的`INSERT`查询，并带有笑话文本的占位符。然后，只要有笑话要添加，就可以运行这个 PHP 脚本。PHP 脚本提示您输入笑话，然后向 MySQL 服务器发出适当的`INSERT`查询。

然而，现在重要的是培养手工输入 SQL 的良好感觉。它会让你对 MySQL 数据库的内部工作方式有一个强烈的感觉，并且会让你更加感激 PHP 将为你省去的工作！

到目前为止，我们只使用了一个表，但是要实现关系数据库的真正功能，您需要学习如何一起使用多个表来表示数据库中存储的项目之间潜在的复杂关系。我将在第 5 章中讨论所有这些以及更多内容，在那一章中，我将讨论数据库设计原则并展示一些更高级的例子。

同时，我们已经完成了我们的目标，您可以使用 MySQL Workbench 查询窗口轻松地与 MySQL 进行交互。在第 4 章中，我们继续深入研究 PHP 语言，并用它来创建几个动态生成的网页。

如果您愿意，您可以在继续之前用 MySQL 做一点练习，创建一个适当大小的笑话表(对于我们的目的，五个应该足够了)。当你读到第五章时，这个笑话库会派上用场。

## 分享这篇文章