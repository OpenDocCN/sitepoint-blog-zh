# 解决 CSS3 厂商前缀危机的两个新方案

> 原文:[https://www . site point . com/css3-vendor-prefix-crisis-solutions-2/](https://www.sitepoint.com/css3-vendor-prefix-crisis-solutions-2/)

自 2012 年 2 月以来，网络开发人员一直在担心供应商前缀危机。总结一下，这是理想世界中应该发生的事情:

1.  供应商使用他们自己的前缀实现实验性的 CSS3 属性，例如-webkit-transform，-moz-transform，-ms-transform，-o-transform。
2.  开发人员可以在不破坏跨浏览器兼容性的情况下使用这些技术。属性可以用带前缀和不带前缀的名称列出，以确保它们在任何地方都能工作。
3.  一旦某个属性成为 W3C 推荐标准，所有浏览器供应商都可以提供一个稳定的无前缀属性，例如 transform。
4.  开发人员可以选择从他们的样式表中删除前缀属性。然而，如果非前缀属性是最后定义的，并且 CSS 级联规则适用，那么这并不是绝对必要的。

这是现实世界中发生的事情:

1.  供应商使用他们自己的前缀实现实验性的 CSS3 属性。在某些情况下，供应商将它们宣传为 HTML5 *“标准”*，即使它们是特定于设备的或者从未提交给 W3C。
2.  一些开发人员使用来自单一供应商的专有属性，例如 only -webkit-transform。这可能是由于无知、懒惰或者因为他们测试的设备数量有限。
3.  一旦某个属性成为 W3C 推荐标准，所有浏览器供应商都可以提供一个稳定的无前缀属性，例如 transform…
4.  但是开发人员忽略了改变他们的样式表。该网站在一些浏览器上看起来不错，但在其他浏览器上却很差，即使它们支持标准的 W3C 规范。
5.  供应商开始关注并在他们的浏览器中添加对其他前缀的支持，例如 [Opera 为某些属性实现了-webkit 前缀](https://www.sitepoint.com/opera-css3-webkit-prefix/)。前缀流程被破坏了，虽然现在预测结果还为时过早，但大多数开发人员认为这是一个糟糕的举动。

我们已经在 SitePoint 上详细讨论了这些问题；没有简单的解决方法。然而，在过去的一周里，W3C 成员提出了两个有趣的提议。

## 选项 1:从一开始就支持无前缀的属性

第一个提议来自 Opera 的 W3C 代表 Florian Rivoal:

> 当一个浏览器供应商实现一个新的 CSS 特性时，它应该从第一天起就支持它，包括前缀和非前缀，两者是有别名的。如果一个样式表同时包含前缀和非前缀，根据级联，最后一个胜出。
> 
> 作者应该使用不带前缀的属性编写他们的样式表，并且如果他们发现需要在特定浏览器中解决的错误或不一致，则只添加该属性的前缀版本(在不带前缀的版本之下)。
> 
> 如果使用特定供应商前缀积累了大量内容，以解决该浏览器中早期实现的问题，供应商可以决定冻结前缀属性的行为，同时继续改进无前缀属性。

例如，您可以在 CSS 中使用以下转换代码:

```
 transform: rotate(30deg); 
```

所有未实现转换的浏览器都将忽略该属性。如果两个或多个实现之间存在差异，例如 webkit 浏览器默认逆时针旋转，您可以相应地重写该属性，例如

```
 transform: rotate(30deg);
-webkit-transform: rotate(-30deg); 
```

这是一个简单的解决方案，易于实施。大多数现有的样式表将继续工作，前缀属性将很少是必要的。在大多数情况下，您将不再需要更新您的 CSS。

但是，如果 webkit 将 rotation 改为 W3C 认可的顺时针方向会发生什么？开发人员需要通过移除或重新排列`-webkit-transform: rotate(-30deg);`属性来修复他们的样式表。不幸的是，并不是每个人都同时使用相同版本的 webkit 引擎。你可能会遇到这样的情况，你的网站在 Chrome 上可以运行，但在 Safari 上却无法运行几个月。

## 选项 2:新的供应商草案修改量

第二个建议来自弗朗索瓦·雷米:

> 让我们来介绍一下！供应商草案”值修饰符。我建议我们从一开始就使用不带前缀的属性，但是使用一个标记来解释我们为哪个版本的属性构建 CSS:
> `border-radius: 3px !webkit-draft;`
> 
> 任何不是 webkit 但以与“webkit 草案”兼容的方式实现了 border-radius 的浏览器都可以支持该声明。这与供应商前缀不同:其他浏览器不模仿 webkit，它们只是承认它们支持 webkit 草案定义的特定属性。与该草案不兼容的浏览器将忽略该声明。鼓励更改属性实现的浏览器迭代它们的“！供应商草稿”标志(如果合适，使用版本号)。

这通过改变属性值而不是其名称来解决问题(以类似于`!important`修饰符的方式)。同样，可以使用下面的变换代码:

```
 transform: rotate(30deg); 
```

但是默认的逆时针旋转可以在任何遵循 webkit 规范的浏览器中被修复:

```
 transform: rotate(30deg);
transform: rotate(-30deg) !webkit-draft; 
```

如果浏览器随后支持 W3C 规范，第二个属性将被忽略。

也有可能实现草案版本控制，例如

```
 transform: rotate(30deg);
transform: rotate(-30degrees) !webkit-draft;
transform: rotate(-30deg) !webkit-draft-2; 
```

这是一个灵活的解决方案，最终解决了属性随时间演变的问题。

不幸的是，它更难实现，即使所有供应商今天都同意，也可能需要几个月才能出现在浏览器中。这可能在技术上更好，但这是一种根本不同的方法，可能会破坏现有的样式表。从短期来看，供应商可能会同时支持前缀和值修饰符——这将导致混乱。

两种解决方案我都喜欢。从编码的角度来看，供应商草案修改似乎是最合理的选择，但我怀疑在供应商*“完成”【CSS3 并开始 CSS4 的工作之前，它是否可以被考虑。*

 *支持无前缀的属性更实际，但肯定会导致版本问题，这不能单独在 CSS 中解决。但也许这就是你使用实验技术的代价？

这两个选项你都喜欢吗？或者，阻止供应商前缀灾难是否为时已晚？* 

## *分享这篇文章*