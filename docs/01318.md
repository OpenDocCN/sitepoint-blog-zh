# 规划平均堆栈应用的实用指南

> 原文:[https://www.sitepoint.com/planning-mean-stack-application/](https://www.sitepoint.com/planning-mean-stack-application/)

规划均值堆栈应用的实用指南摘自 Manning 的 [Getting MEAN with Mongo，Express，Angular，and Node，第二版](http://bit.ly/2sWafwu)。Getting MEAN，第二版全面改版更新，涵盖 Angular 2、Node 6 以及最新的主流版本 JavaScript ES2015 (ES6)。第二版将带你了解如何使用这个更新的 MEAN stack 开发 web 应用程序。

## 规划真正的应用

出于本文的目的，让我们假设我们正在 MEAN stack 上构建一个名为 Loc8r 的工作应用程序。Loc8r 将列出附近有 WiFi 的地方，人们可以去那里完成一些工作。它还将显示每个地方的设施、开放时间、评级和位置图。

## 从高层次规划平均堆栈应用

第一步是考虑我们的应用程序需要什么样的屏幕。我们将关注单独的页面视图和用户旅程。我们可以在高层次上做到这一点，而不用关心每页上的细节。在一张纸上或白板上勾勒出这个阶段是一个好主意，因为它有助于将应用程序整体可视化。它还有助于将屏幕组织成集合和流，在我们构建它时充当一个很好的参考点。由于没有数据附加到页面或页面背后的应用程序逻辑，所以很容易添加和删除部分，改变显示的内容和位置，甚至改变我们想要的页面数量。很有可能我们第一次不会做对；关键是开始、迭代和改进，直到我们对单独的页面和整体用户流满意为止。

## 规划屏幕

我们来想想 Loc8r。如上所述，我们的目标如下:

> Loc8r 将列出附近有 WiFi 的地方，人们可以去那里完成一些工作。它显示每个地方的设施、开放时间、等级和位置图。访问者可以提交评分和评论。

由此我们可以了解到我们需要的一些屏幕:

1.  列出附近地点的屏幕
2.  显示某个地方的详细信息的屏幕
3.  用于添加关于一个地方的评论的屏幕

我们可能还想告诉访问者 Loc8r 的用途以及它存在的原因，我们应该在列表中添加另一个屏幕:

1.  “关于我们”信息的屏幕

## 将屏幕划分为集合

接下来，我们要获取屏幕列表，并将它们整理到逻辑上属于它们的位置。例如，列表中的前三个都是处理位置的。关于的*页面不属于任何地方，它可以放在一个杂七杂八的*其他*集合中。画出草图后，我们会看到类似于图 1 的东西。*

![Planning a MEAN stack application: collections](../Images/37e251d333db0a77fc97b28ee0595657.png)

图 1:将我们应用程序的独立屏幕整理成逻辑集合。

有一个像这样的快速草图是规划的第一阶段，我们需要经历这个阶段才能开始思考架构。这个阶段给了我们一个机会来看看基本的页面，也思考一下流程。例如，图 1 显示了在*位置*集合中的基本用户旅程，从*列表*页面到*细节*页面，然后到表单上添加评论。

## 构建应用程序

从表面上看，Loc8r 是一个简单的应用程序，只有几个屏幕。但我们仍然需要考虑如何设计它，因为我们将把数据从数据库传输到浏览器，让用户与数据交互，并允许数据发送回数据库。

### 从 API 开始

因为应用程序将使用数据库并传递数据，所以我们将开始用我们肯定需要的部分构建架构。图 2 显示了起点，一个用 Express 和 Node.js 构建的 REST API，支持与 MongoDB 数据库的交互。

![Planning a MEAN stack application: API](../Images/6a0edeefcf95d77fbd1283c89b6a7076.png)

*图 2 从标准的 MEAN REST API 开始，使用 MongoDB、Express 和 Node.js*

构建一个 API 来与我们的数据交互是该架构的基点。更有趣也更困难的问题是:我们如何设计应用程序？

### 应用程序架构选项

在这一点上，我们需要考虑我们的应用程序的具体需求，以及我们如何将这些部分组合起来以构建最佳解决方案。我们是否需要 MongoDB、Express、Angular 或 Node.js 的一些特别的东西来以某种方式改变决策？我们希望 HTML 直接从服务器上提供，还是 SPA 是更好的选择？

对于 Loc8r 没有不寻常的或特定的要求，它是否应该很容易被搜索引擎抓取取决于业务增长计划。如果目标是从搜索引擎中引入有机流量，那么是的，它需要是可抓取的。如果目标是将应用程序作为应用程序进行推广，并以这种方式推动使用，那么搜索引擎的可见性就不是那么重要了。

我们可以立即设想三种可能的应用程序架构，如图 3 所示:

1.  Node.js 和 Express 应用程序
2.  一个 Node.js 和 Express 应用程序，增加了交互角度
3.  棱角分明的温泉浴场

考虑到这三个选项，Loc8r 选哪个最好？

![Planning a MEAN stack application: architecture](../Images/9fcd9d7708f5ff5558d7d0a58697badc.png)

*图 3 构建 Loc8r 应用程序的三个选项，从服务器端的 Express 和 Node.js 应用程序到完整的客户端 Angular SPA。*

### 选择应用程序架构

没有特定的业务需求促使我们选择一种架构而不是另一种。构建所有这三种体系结构使我们能够探索每种方法是如何工作的，并使我们能够依次研究每种技术，逐层构建应用程序。

我们将按照图 3 所示的顺序构建架构，从 Node.js 和 Express 应用程序开始，然后在重构 Angular SPA 之前添加一些 Angular。虽然这并不一定是你通常建立一个站点的方式，但是它给了你一个很好的机会去学习 MEAN stack 的方方面面。

## 将所有东西包装在一个 Express 项目中

我们一直在看的架构图意味着我们将为 API 和应用程序逻辑提供单独的 Express 应用程序。这是完全可能的，也是一个大项目的好方法。如果我们期待大量的流量，我们甚至可能希望我们的主应用程序和 API 在不同的服务器上。这样做的另一个好处是，我们可以针对每个服务器和应用程序进行更具体的设置，以最大限度地满足个人需求。

另一种方法是保持事物的简单性和包容性，将所有东西放在一个 Express 项目中。使用这种方法，我们只需要担心一个应用程序的托管和部署，以及一组源代码的管理。这就是我们将用 Loc8r 做的事情，给我们一个包含几个子应用程序的 Express 项目。图 4 展示了这种方法。

![Planning a MEAN stack application: Express](../Images/59879a92f243fc02aec30c1c678b831c.png)

*图 4 应用程序的架构，API 和应用程序逻辑包装在同一个 Express 项目中。*

当以这种方式组装应用程序时，很重要的一点是组织好我们的代码，使应用程序的不同部分保持分离。除了使我们的代码更容易维护之外，如果我们认为这是正确的路线，那么将它分解成单独的项目也更容易。这是一个关键的主题，我们会在整本书中反复提到。

## 最终产品

如你所见，我们将使用 MEAN stack 的所有层来创建 Loc8r。我们还将包括 Twitter Bootstrap 来帮助我们创建一个响应性布局。图 5 显示了可以构建的一些截图。

![Planning a MEAN stack application: the end product](../Images/186e0eb3d3d25b21eee22589cbf222f5.png)

图 5 Loc8r 是一个示例应用程序。它在不同的设备上以不同的方式显示，显示一个地点列表和每个地点的详细信息，并允许游客登录和留下评论。

## 结论

本文到此为止。如果你想开始将这些步骤付诸实践，那么请前往曼宁的网站，在那里你可以免费下载《Mongo、Express、Angular 和 Node》第一章第二版，或者购买这本书。否则，如果你对我在这篇文章中提到的内容有任何疑问，请在下面的评论中发表。

## 分享这篇文章